# دليل إعدادات النظام

## نظرة عامة

تم إنشاء نظام إعدادات شامل ومتكامل لإدارة جميع إعدادات الموقع من خلال لوحة الإدارة. النظام مرتبط بقاعدة البيانات MySQL ويوفر واجهة سهلة الاستخدام لإدارة جميع جوانب الموقع.

## الميزات الرئيسية

### 1. إعدادات الموقع العامة
- اسم الموقع (عربي/إنجليزي)
- شعار الموقع (عربي/إنجليزي)
- وصف الموقع (عربي/إنجليزي)
- رابط شعار الموقع

### 2. إعدادات التواصل
- البريد الإلكتروني
- رقم الهاتف
- رقم الواتساب
- العنوان
- الموقع الإلكتروني

### 3. وسائل التواصل الاجتماعي
- فيسبوك
- تويتر
- إنستغرام
- يوتيوب
- لينكد إن
- سناب شات

### 4. إعدادات SEO
- الكلمات المفتاحية الافتراضية
- الوصف الافتراضي للصفحات
- كود Google Analytics
- كود Google Tag Manager
- كود Facebook Pixel

### 5. إعدادات النظام
- اللغة الافتراضية
- المنطقة الزمنية
- العملة الافتراضية
- عدد العناصر في الصفحة
- وضع الصيانة
- السماح بالتسجيل
- تفعيل الإشعارات
- تفعيل التحليلات

### 6. إعدادات الأمان
- مدة انتهاء الجلسة
- عدد محاولات تسجيل الدخول
- تفعيل المصادقة الثنائية
- تفعيل CAPTCHA
- تسجيل الأنشطة
- فرض استخدام HTTPS

## الملفات المطلوبة

### 1. صفحة الإعدادات
- `pages/admin/settings/index.vue` - الصفحة الرئيسية للإعدادات

### 2. API Endpoints
- `server/api/cms/site-settings.get.ts` - جلب الإعدادات
- `server/api/cms/site-settings.put.ts` - تحديث الإعدادات
- `server/api/public/site-settings.get.ts` - جلب الإعدادات العامة

### 3. Composable
- `composables/useSettings.ts` - إدارة الإعدادات في التطبيق

### 4. Plugins
- `plugins/settings.client.ts` - تحميل الإعدادات تلقائياً

### 5. Middleware
- `middleware/maintenance.ts` - التحقق من وضع الصيانة

### 6. صفحات إضافية
- `pages/maintenance.vue` - صفحة الصيانة

## قاعدة البيانات

### جدول cms_site_settings
```sql
CREATE TABLE cms_site_settings (
  id INT AUTO_INCREMENT PRIMARY KEY,
  setting_key VARCHAR(100) UNIQUE NOT NULL,
  setting_value LONGTEXT,
  setting_type ENUM('text', 'textarea', 'number', 'boolean', 'json', 'image') DEFAULT 'text',
  category VARCHAR(100),
  description TEXT,
  is_public BOOLEAN DEFAULT FALSE,
  updated_by INT,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

## كيفية الاستخدام

### 1. الوصول إلى الإعدادات
- انتقل إلى `/admin/settings`
- يجب أن تكون مسجل دخول كمدير

### 2. تعديل الإعدادات
- اختر التبويب المناسب
- عدّل القيم المطلوبة
- اضغط "حفظ الإعدادات"

### 3. استخدام الإعدادات في الكود
```javascript
// في أي مكون Vue
const { siteSettings, contactSettings } = useSettings()

// الحصول على إعداد محدد
const { getSetting } = useSettings()
const siteName = getSetting('site_name_ar', 'Wonder Land')
```

## الإعدادات الافتراضية

تم إدراج 37 إعداد افتراضي في قاعدة البيانات تشمل:
- إعدادات الموقع الأساسية
- معلومات التواصل
- إعدادات SEO
- إعدادات النظام والأمان

## وضع الصيانة

عند تفعيل وضع الصيانة:
- يتم إعادة توجيه الزوار إلى صفحة الصيانة
- المديرون يمكنهم الوصول للوحة الإدارة
- يمكن إدارة وضع الصيانة من تبويب "النظام"

## الأمان

- الإعدادات الحساسة محمية (is_public = false)
- تسجيل جميع التغييرات
- التحقق من صلاحيات المدير
- تشفير البيانات الحساسة

## التطوير المستقبلي

### ميزات مقترحة:
1. نسخ احتياطي للإعدادات
2. استيراد/تصدير الإعدادات
3. إعدادات متقدمة للتحليلات
4. إعدادات التخزين المؤقت
5. إعدادات البريد الإلكتروني
6. إعدادات الدفع

## استكشاف الأخطاء

### مشاكل شائعة:
1. **لا تظهر الإعدادات**: تأكد من وجود جدول cms_site_settings
2. **خطأ في الحفظ**: تحقق من صلاحيات قاعدة البيانات
3. **وضع الصيانة لا يعمل**: تأكد من تفعيل middleware

### حلول:
1. تشغيل `node scripts/insert-default-settings.js`
2. التحقق من اتصال قاعدة البيانات
3. مراجعة ملف .env

## الدعم

للحصول على المساعدة:
- راجع هذا الدليل
- تحقق من ملفات السجل
- تواصل مع فريق التطوير

---

**ملاحظة**: هذا النظام مصمم ليكون مرناً وقابلاً للتوسع. يمكن إضافة إعدادات جديدة بسهولة من خلال تحديث قاعدة البيانات والواجهة.
