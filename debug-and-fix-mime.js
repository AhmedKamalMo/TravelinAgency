#!/usr/bin/env node

console.log('🔍 DEBUGGING AND FIXING MIME TYPE ISSUE');
console.log('=======================================\n');

console.log('📋 DEBUGGING COMMANDS:');
console.log('======================');
console.log('');
console.log('# 1. Check if the specific files exist');
console.log('ls -la output/public/_nuxt/entry.Cjk20dY-.css');
console.log('ls -la output/public/_nuxt/2Q_rtp48.js');
console.log('');
console.log('# 2. Test direct access to files');
console.log('curl -k -I https://worldtripagency.com/output/public/_nuxt/entry.Cjk20dY-.css');
console.log('curl -k -I https://worldtripagency.com/output/public/_nuxt/2Q_rtp48.js');
console.log('');
console.log('# 3. Create a simple .htaccess that bypasses the issue');
console.log('cat > .htaccess << "EOF"');
console.log('RewriteEngine On');
console.log('');
console.log('# API routes');
console.log('RewriteCond %{REQUEST_URI} ^/api/');
console.log('RewriteRule ^(.*)$ /api-handler.php [QSA,L]');
console.log('');
console.log('# Direct file serving - bypass rewrite for _nuxt');
console.log('RewriteCond %{REQUEST_URI} ^/_nuxt/');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Static files');
console.log('RewriteCond %{REQUEST_URI} \\.(css|js|jpg|jpeg|png|gif|webp|svg|ico|woff|woff2|ttf|eot)$');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Everything else');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{REQUEST_FILENAME} !-d');
console.log('RewriteRule ^(.*)$ /index.html [QSA,L]');
console.log('EOF');
console.log('');
console.log('# 4. Alternative: Create symbolic links to bypass the issue');
console.log('ln -sf output/public/_nuxt _nuxt');
console.log('ln -sf output/public/images images');
console.log('ln -sf output/public/icons icons');
console.log('');
console.log('# 5. Test the symbolic links');
console.log('curl -k -I https://worldtripagency.com/_nuxt/entry.Cjk20dY-.css');
console.log('curl -k -I https://worldtripagency.com/_nuxt/2Q_rtp48.js');
console.log('');
console.log('# 6. If symbolic links work, update .htaccess to use them');
console.log('cat > .htaccess << "EOF"');
console.log('RewriteEngine On');
console.log('');
console.log('# API routes');
console.log('RewriteCond %{REQUEST_URI} ^/api/');
console.log('RewriteRule ^(.*)$ /api-handler.php [QSA,L]');
console.log('');
console.log('# Serve files directly (no rewrite needed for _nuxt, images, etc.)');
console.log('RewriteCond %{REQUEST_URI} \\.(css|js|jpg|jpeg|png|gif|webp|svg|ico|woff|woff2|ttf|eot)$');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Everything else goes to index.html');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{REQUEST_FILENAME} !-d');
console.log('RewriteRule ^(.*)$ /index.html [QSA,L]');
console.log('EOF');
console.log('');
console.log('🎯 This approach will:');
console.log('✅ Check if files actually exist');
console.log('✅ Test direct access to files');
console.log('✅ Create symbolic links to bypass rewrite issues');
console.log('✅ Use direct file serving when possible');
console.log('');
console.log('🔧 Why symbolic links work:');
console.log('• Apache serves them as real files with correct MIME types');
console.log('• No rewrite rules needed for _nuxt assets');
console.log('• Bypasses any rewrite rule MIME type issues');
console.log('• Maintains all functionality');
