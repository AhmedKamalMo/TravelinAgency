import A from"./jn7r9_3C.js";import{_ as B}from"./DyW0L63n.js";import{h as x,C as E,S as k,p as P,u as R,c as f,o as m,b as t,a as c,l as V,m as p,j as a,v as d,i as o,e as w,U as y,F as T,r as C,t as u,H as I,k as F,w as M,K as O}from"./Btm4-m5n.js";const L={class:"space-y-6"},$={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},H={class:"mt-4 sm:mt-0"},K={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},W={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},z={class:"lg:col-span-2 space-y-6"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},J={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q=["value"],X={key:0},Y=["value"],Z={key:0,class:"mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200"},h={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},te={class:"space-y-4"},le={class:"space-y-6"},oe={class:"bg-gray-50 rounded-lg p-4"},se={class:"space-y-4"},re={class:"bg-blue-50 rounded-lg border border-blue-200 p-4"},ne={class:"space-y-2 text-sm text-blue-800"},ae={class:"flex justify-between"},ue={class:"flex justify-between"},de={class:"flex justify-between"},ie={class:"flex justify-between"},pe={class:"flex justify-between"},me={class:"flex justify-between"},be={class:"flex justify-between"},ge={class:"flex justify-between"},fe={class:"bg-gray-50 rounded-lg p-4"},ye={class:"space-y-3"},ve={class:"flex justify-end space-x-3 space-x-reverse pt-6 border-t border-gray-200"},xe=["disabled"],Ve={__name:"create",setup(ce){const b=x(!1),v=x([]),n=x(null),l=x({customer_name:"",customer_email:"",customer_phone:"",package_id:"",guests_count:1,departure_date:"",return_date:"",total_amount:0,paid_amount:0,currency:"SAR",payment_method:"",payment_reference:"",booking_status:"pending",payment_status:"pending",special_requests:"",notes:"",booking_number:"",confirmed_at:""}),U=E(()=>l.value.customer_name&&l.value.customer_email&&l.value.customer_phone&&l.value.package_id&&l.value.departure_date&&l.value.total_amount>0),D=async()=>{try{const r=await $fetch("/api/packages");v.value=(r==null?void 0:r.data)||r||[]}catch(r){console.error("خطأ في تحميل الباقات:",r),v.value=[]}},S=()=>{if(n.value=v.value.find(r=>r.id==l.value.package_id),n.value&&(l.value.total_amount=n.value.price*l.value.guests_count,l.value.departure_date&&n.value.duration_days)){const r=new Date(l.value.departure_date),e=new Date(r);e.setDate(e.getDate()+n.value.duration_days),l.value.return_date=e.toISOString().split("T")[0]}},j=async()=>{try{b.value=!0;const r={...l.value,departure_date:l.value.departure_date,return_date:l.value.return_date||null,confirmed_at:l.value.confirmed_at||null,booking_number:l.value.booking_number||`BK${Date.now()}`,package_id:parseInt(l.value.package_id)};Object.keys(r).forEach(i=>{(r[i]===""||r[i]===null)&&delete r[i]});const e=await $fetch("/api/bookings",{method:"POST",body:r});console.log("تم إنشاء الحجز بنجاح:",e),await O("/admin/bookings")}catch(r){console.error("خطأ في إنشاء الحجز:",r)}finally{b.value=!1}},g=r=>r?new Intl.NumberFormat("ar-SA",{style:"currency",currency:"SAR"}).format(r):"0.00 ر.س",q=r=>({confirmed:"مؤكدة",pending:"في الانتظار",cancelled:"ملغية",completed:"مكتملة"})[r]||r,N=r=>({paid:"مدفوع",partial:"مدفوع جزئياً",pending:"في الانتظار",refunded:"مسترد"})[r]||r;return k(()=>l.value.guests_count,()=>{n.value&&(l.value.total_amount=n.value.price*l.value.guests_count)}),k(()=>l.value.departure_date,()=>{var r;if(l.value.departure_date&&((r=n.value)!=null&&r.duration_days)){const e=new Date(l.value.departure_date),i=new Date(e);i.setDate(i.getDate()+n.value.duration_days),l.value.return_date=i.toISOString().split("T")[0]}}),P(()=>{D()}),R({title:"إضافة حجز جديد - Wonder Land Admin",meta:[{name:"description",content:"إنشاء حجز جديد للعميل"},{name:"robots",content:"noindex, nofollow"}]}),(r,e)=>{const i=A,_=B;return m(),f("div",L,[e[66]||(e[66]=t("div",{class:"h-16"},null,-1)),t("div",$,[e[19]||(e[19]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"إضافة حجز جديد"),t("p",{class:"mt-1 text-sm text-gray-600"},"إنشاء حجز جديد للعميل")],-1)),t("div",H,[c(_,{to:"/admin/bookings",class:"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},{default:V(()=>[c(i,{name:"material-symbols:arrow-back",class:"h-5 w-5 ml-2"}),e[18]||(e[18]=p(" العودة "))]),_:1})])]),t("form",{onSubmit:M(j,["prevent"]),class:"space-y-6"},[t("div",K,[t("div",W,[t("div",z,[t("div",null,[e[24]||(e[24]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"معلومات العميل",-1)),t("div",G,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"اسم العميل *",-1)),a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o(l).customer_name=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسم العميل"},null,512),[[d,o(l).customer_name]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"البريد الإلكتروني *",-1)),a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o(l).customer_email=s),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل البريد الإلكتروني"},null,512),[[d,o(l).customer_email]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"رقم الهاتف *",-1)),a(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o(l).customer_phone=s),type:"tel",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+966501234567"},null,512),[[d,o(l).customer_phone]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"عدد الضيوف *",-1)),a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o(l).guests_count=s),type:"number",min:"1",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[d,o(l).guests_count,void 0,{number:!0}]])])])]),t("div",null,[e[35]||(e[35]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"تفاصيل الباقة",-1)),t("div",J,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"اختيار الباقة *",-1)),a(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o(l).package_id=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onChange:S},[e[25]||(e[25]=t("option",{value:""},"اختر الباقة",-1)),(m(!0),f(T,null,C(o(v),s=>(m(),f("option",{key:s.id,value:s.id},u(s.title_ar||s.title_en||s.title)+" - "+u(g(s.price)),9,Q))),128))],544),[[y,o(l).package_id]])]),o(n)?(m(),f("div",X,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"مدة الرحلة",-1)),t("input",{value:o(n).duration_days+" أيام",type:"text",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"},null,8,Y)])):w("",!0),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"تاريخ المغادرة *",-1)),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o(l).departure_date=s),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[d,o(l).departure_date]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"تاريخ العودة",-1)),a(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o(l).return_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[d,o(l).return_date]])])]),o(n)?(m(),f("div",Z,[e[34]||(e[34]=t("h3",{class:"text-sm font-medium text-blue-900 mb-2"},"تفاصيل الباقة المختارة",-1)),t("div",h,[t("div",null,[e[30]||(e[30]=t("span",{class:"font-medium"},"العنوان:",-1)),p(" "+u(o(n).title_ar||o(n).title_en||o(n).title),1)]),t("div",null,[e[31]||(e[31]=t("span",{class:"font-medium"},"السعر:",-1)),p(" "+u(g(o(n).price)),1)]),t("div",null,[e[32]||(e[32]=t("span",{class:"font-medium"},"المدة:",-1)),p(" "+u(o(n).duration_days)+" أيام ",1)]),t("div",null,[e[33]||(e[33]=t("span",{class:"font-medium"},"الوجهة:",-1)),p(" "+u(o(n).location||o(n).travel_period),1)])])])):w("",!0)]),t("div",null,[e[43]||(e[43]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"تفاصيل الدفع",-1)),t("div",ee,[t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"المبلغ الإجمالي *",-1)),a(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o(l).total_amount=s),type:"number",min:"0",step:"0.01",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"},null,512),[[d,o(l).total_amount,void 0,{number:!0}]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"المبلغ المدفوع",-1)),a(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o(l).paid_amount=s),type:"number",min:"0",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"},null,512),[[d,o(l).paid_amount,void 0,{number:!0}]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"العملة",-1)),a(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>o(l).currency=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[38]||(e[38]=[t("option",{value:"SAR"},"ريال سعودي (SAR)",-1),t("option",{value:"USD"},"دولار أمريكي (USD)",-1),t("option",{value:"EUR"},"يورو (EUR)",-1),t("option",{value:"AED"},"درهم إماراتي (AED)",-1)]),512),[[y,o(l).currency]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"طريقة الدفع",-1)),a(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>o(l).payment_method=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[40]||(e[40]=[I('<option value="">اختر طريقة الدفع</option><option value="cash">نقداً</option><option value="bank_transfer">تحويل بنكي</option><option value="credit_card">بطاقة ائتمان</option><option value="online">دفع إلكتروني</option>',5)]),512),[[y,o(l).payment_method]])]),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"مرجع الدفع",-1)),a(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o(l).payment_reference=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"رقم المرجع أو المعاملة"},null,512),[[d,o(l).payment_reference]])])])]),t("div",null,[e[46]||(e[46]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"طلبات خاصة وملاحظات",-1)),t("div",te,[t("div",null,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"طلبات خاصة",-1)),a(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>o(l).special_requests=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أي طلبات خاصة من العميل"},null,512),[[d,o(l).special_requests]])]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ملاحظات إدارية",-1)),a(t("textarea",{"onUpdate:modelValue":e[13]||(e[13]=s=>o(l).notes=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ملاحظات إدارية أو تفاصيل إضافية"},null,512),[[d,o(l).notes]])])])])]),t("div",le,[t("div",oe,[e[51]||(e[51]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"حالة الحجز",-1)),t("div",se,[t("div",null,[e[48]||(e[48]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"حالة الحجز *",-1)),a(t("select",{"onUpdate:modelValue":e[14]||(e[14]=s=>o(l).booking_status=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[47]||(e[47]=[t("option",{value:"pending"},"في الانتظار",-1),t("option",{value:"confirmed"},"مؤكدة",-1),t("option",{value:"cancelled"},"ملغية",-1),t("option",{value:"completed"},"مكتملة",-1)]),512),[[y,o(l).booking_status]])]),t("div",null,[e[50]||(e[50]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"حالة الدفع *",-1)),a(t("select",{"onUpdate:modelValue":e[15]||(e[15]=s=>o(l).payment_status=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[49]||(e[49]=[t("option",{value:"pending"},"في الانتظار",-1),t("option",{value:"partial"},"مدفوع جزئياً",-1),t("option",{value:"paid"},"مدفوع بالكامل",-1),t("option",{value:"refunded"},"مسترد",-1)]),512),[[y,o(l).payment_status]])])])]),t("div",re,[e[60]||(e[60]=t("h3",{class:"text-lg font-semibold text-blue-900 mb-3"},"ملخص الحجز",-1)),t("div",ne,[t("div",ae,[e[52]||(e[52]=t("span",null,"العميل:",-1)),t("span",null,u(o(l).customer_name||"غير محدد"),1)]),t("div",ue,[e[53]||(e[53]=t("span",null,"عدد الضيوف:",-1)),t("span",null,u(o(l).guests_count||0),1)]),t("div",de,[e[54]||(e[54]=t("span",null,"تاريخ المغادرة:",-1)),t("span",null,u(o(l).departure_date||"غير محدد"),1)]),t("div",ie,[e[55]||(e[55]=t("span",null,"المبلغ الإجمالي:",-1)),t("span",null,u(g(o(l).total_amount)),1)]),t("div",pe,[e[56]||(e[56]=t("span",null,"المبلغ المدفوع:",-1)),t("span",null,u(g(o(l).paid_amount)),1)]),t("div",me,[e[57]||(e[57]=t("span",null,"المتبقي:",-1)),t("span",null,u(g(o(l).total_amount-o(l).paid_amount)),1)]),t("div",be,[e[58]||(e[58]=t("span",null,"حالة الحجز:",-1)),t("span",null,u(q(o(l).booking_status)),1)]),t("div",ge,[e[59]||(e[59]=t("span",null,"حالة الدفع:",-1)),t("span",null,u(N(o(l).payment_status)),1)])])]),t("div",fe,[e[64]||(e[64]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"معلومات إضافية",-1)),t("div",ye,[t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"رقم الحجز",-1)),a(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>o(l).booking_number=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"سيتم إنشاؤه تلقائياً"},null,512),[[d,o(l).booking_number]]),e[62]||(e[62]=t("p",{class:"text-xs text-gray-500 mt-1"},"اتركه فارغاً لإنشاء رقم تلقائي",-1))]),t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"تاريخ التأكيد",-1)),a(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>o(l).confirmed_at=s),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[d,o(l).confirmed_at]])])])])])]),t("div",ve,[c(_,{to:"/admin/bookings",class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"},{default:V(()=>e[65]||(e[65]=[p(" إلغاء ")])),_:1}),t("button",{type:"submit",disabled:o(b)||!o(U),class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"},[o(b)?(m(),F(i,{key:0,name:"material-symbols:progress-activity",class:"animate-spin h-4 w-4 ml-2 inline"})):w("",!0),p(" "+u(o(b)?"جاري الإنشاء...":"إنشاء الحجز"),1)],8,xe)])])],32)])}}};export{Ve as default};
