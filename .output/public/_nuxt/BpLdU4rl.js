import E from"./jn7r9_3C.js";import{h as b,C as q,p as A,u as M,c,o as l,b as t,i as r,k as v,m as f,t as p,a as m,j as S,v as V,$ as R,F as _,r as x,B as k,K as w}from"./Btm4-m5n.js";const U={class:"min-h-screen bg-gray-50"},W={class:"bg-white shadow-sm border-b"},F={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},O={class:"flex justify-between items-center py-4"},H={class:"flex items-center space-x-4 space-x-reverse"},K=["disabled"],z=["disabled"],G={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},J={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},Q={class:"lg:col-span-1"},X={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Y={class:"mb-4"},Z={class:"space-y-4"},ee={class:"text-sm font-medium text-gray-700"},te={class:"space-y-1"},se=["onClick"],oe={class:"lg:col-span-3"},ae={class:"bg-white rounded-lg shadow-sm border border-gray-200 min-h-96"},ne={key:0,class:"p-6"},le={class:"prose max-w-none"},ie={class:"text-center py-8 border border-gray-200 rounded-lg"},re={class:"text-lg font-medium"},ce={key:1,class:"p-6"},de={key:0,class:"text-center py-12"},pe={key:1,class:"space-y-4"},me={class:"flex justify-between items-center mb-2"},ue={class:"font-medium text-gray-900"},ge={class:"flex space-x-2 space-x-reverse"},be=["onClick","disabled"],ye=["onClick","disabled"],he=["onClick"],ve=["onClick"],fe={class:"text-center py-4 bg-gray-50 rounded"},_e={class:"text-sm text-gray-600"},Ce={__name:"editor",setup(xe){const a=b([]),y=b(!1),d=b(!1),u=b(""),C=b([{name:"العناصر الأساسية",components:[{type:"hero",name:"قسم البطل",icon:"material-symbols:image",props:{title:"مرحباً بك في Wonder Land",subtitle:"اكتشف أجمل الوجهات السياحية",backgroundImage:"/images/hero-bg.jpg",buttonText:"اكتشف الآن",buttonLink:"/packages"}},{type:"about",name:"من نحن",icon:"material-symbols:info",props:{title:"من نحن",content:"نحن وكالة سفر رائدة في المملكة العربية السعودية...",image:"/images/about.jpg"}},{type:"services",name:"الخدمات",icon:"material-symbols:room-service",props:{title:"خدماتنا",services:`حج وعمرة
رحلات سياحية
تذاكر طيران
حجز فنادق`}},{type:"contact",name:"التواصل",icon:"material-symbols:contact-mail",props:{title:"تواصل معنا",phone:"+966 50 123 4567",email:"info@wonderland.com",address:"الرياض، المملكة العربية السعودية"}}]}]),I=q(()=>u.value?C.value.map(o=>({...o,components:o.components.filter(e=>e.name.includes(u.value)||e.type.includes(u.value))})).filter(o=>o.components.length>0):C.value),$=o=>{const e={id:Date.now(),type:o.type,props:{...o.props},classes:"mb-6"};a.value.push(e)},g=()=>{[{type:"hero",props:{title:"مرحباً بك في Wonder Land",subtitle:"اكتشف أجمل الوجهات السياحية",backgroundImage:"/images/hero-bg.jpg",buttonText:"اكتشف الآن",buttonLink:"/packages"}},{type:"about",props:{title:"من نحن",content:"نحن وكالة سفر رائدة في المملكة العربية السعودية...",image:"/images/about.jpg"}}].forEach(e=>{$(e)})},P=(o,e)=>{if(e==="up"&&o>0){const s=a.value[o];a.value[o]=a.value[o-1],a.value[o-1]=s}else if(e==="down"&&o<a.value.length-1){const s=a.value[o];a.value[o]=a.value[o+1],a.value[o+1]=s}},L=o=>{a.value.splice(o,1)},j=()=>{y.value=!y.value},D=async()=>{try{d.value=!0;const e=k().query.page,s={title_ar:"صفحة جديدة",title_en:"New Page",content_ar:"",content_en:"",components:a.value,status:"draft",template:"default"};if(e)(await $fetch(`/api/cms/editor/${e}`,{method:"PUT",body:s})).success&&(console.log("Page saved successfully"),await w(`/admin/content/editor?page=${e}`));else{const n=await $fetch("/api/cms/editor",{method:"POST",body:s});n.success&&(console.log("Page created successfully"),await w(`/admin/content/editor?page=${n.id}`))}}catch(o){console.error("Error saving page:",o)}finally{d.value=!1}},T=async()=>{try{d.value=!0;const e=k().query.page,s={title_ar:"صفحة جديدة",title_en:"New Page",content_ar:"",content_en:"",components:a.value,status:"published",template:"default"};if(e)(await $fetch(`/api/cms/editor/${e}`,{method:"PUT",body:s})).success&&(console.log("Page published successfully"),await w(`/admin/content/editor?page=${e}`));else{const n=await $fetch("/api/cms/editor",{method:"POST",body:s});n.success&&(console.log("Page created and published successfully"),await w(`/admin/content/editor?page=${n.id}`))}}catch(o){console.error("Error publishing page:",o)}finally{d.value=!1}},N=async()=>{const o=k(),e=o.query.page;if(e)try{console.log("Loading page with ID:",e);const s=await $fetch(`/api/cms/editor/${e}`);console.log("API Response:",s),s.success&&s.page?s.page.components&&Array.isArray(s.page.components)&&s.page.components.length>0?(console.log("Loading existing components:",s.page.components),a.value=s.page.components):(console.log("No components found, adding default components"),g()):(console.log("No page data found, adding default components"),g())}catch(s){console.error("Error loading page:",s),g()}else{const s=o.query.template;s&&(console.log("Loading template:",s),g())}},B=o=>{if(o>=0&&o<a.value.length){const s={...a.value[o],id:Date.now()+Math.random()};a.value.splice(o+1,0,s)}};return A(()=>{N()}),M({title:"محرر المحتوى - Wonder Land Admin",meta:[{name:"description",content:"محرر محتوى متقدم لإنشاء وتعديل الصفحات"},{name:"robots",content:"noindex, nofollow"}]}),(o,e)=>{const s=E;return l(),c("div",U,[t("div",W,[t("div",F,[t("div",O,[e[1]||(e[1]=t("div",{class:"flex items-center"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"محرر المحتوى")],-1)),t("div",H,[t("button",{onClick:D,disabled:r(d),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center"},[r(d)?(l(),v(s,{key:0,name:"material-symbols:progress-activity",class:"animate-spin h-4 w-4 ml-2"})):(l(),v(s,{key:1,name:"material-symbols:save",class:"h-4 w-4 ml-2"})),f(" "+p(r(d)?"جاري الحفظ...":"حفظ"),1)],8,K),t("button",{onClick:T,disabled:r(d),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center"},[r(d)?(l(),v(s,{key:0,name:"material-symbols:progress-activity",class:"animate-spin h-4 w-4 ml-2"})):(l(),v(s,{key:1,name:"material-symbols:publish",class:"h-4 w-4 ml-2"})),f(" "+p(r(d)?"جاري النشر...":"نشر"),1)],8,z),t("button",{onClick:j,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center"},[m(s,{name:"material-symbols:visibility",class:"h-4 w-4 ml-2"}),f(" "+p(r(y)?"تحرير":"معاينة"),1)])])])])]),t("div",G,[t("div",J,[t("div",Q,[t("div",X,[e[2]||(e[2]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"المكونات",-1)),t("div",Y,[S(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>R(u)?u.value=n:null),type:"text",placeholder:"البحث في المكونات...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[V,r(u)]])]),t("div",Z,[(l(!0),c(_,null,x(r(I),n=>(l(),c("div",{key:n.name,class:"space-y-2"},[t("h3",ee,p(n.name),1),t("div",te,[(l(!0),c(_,null,x(n.components,i=>(l(),c("button",{key:i.type,onClick:h=>$(i),class:"w-full text-right px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors flex items-center justify-between"},[m(s,{name:i.icon,class:"h-4 w-4"},null,8,["name"]),f(" "+p(i.name),1)],8,se))),128))])]))),128))])])]),t("div",oe,[t("div",ae,[r(y)?(l(),c("div",ne,[e[4]||(e[4]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"معاينة الصفحة",-1)),t("div",le,[(l(!0),c(_,null,x(r(a),(n,i)=>(l(),c("div",{key:i,class:"mb-6"},[t("div",ie,[t("p",re,p(n.type),1),e[3]||(e[3]=t("p",{class:"text-sm text-gray-500"},"مكون محمل من قاعدة البيانات",-1))])]))),128))])])):(l(),c("div",ce,[e[7]||(e[7]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"تحرير الصفحة",-1)),r(a).length===0?(l(),c("div",de,[m(s,{name:"material-symbols:add-box",class:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e[5]||(e[5]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"ابدأ بإنشاء صفحتك",-1)),e[6]||(e[6]=t("p",{class:"text-gray-500 mb-6"},"اسحب المكونات من الشريط الجانبي لبدء التصميم",-1)),t("button",{onClick:g,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," إضافة مكونات افتراضية ")])):(l(),c("div",pe,[(l(!0),c(_,null,x(r(a),(n,i)=>(l(),c("div",{key:i,class:"border border-gray-200 rounded-lg p-4"},[t("div",me,[t("h4",ue,p(n.type),1),t("div",ge,[t("button",{onClick:h=>P(i,"up"),disabled:i===0,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",title:"نقل لأعلى"},[m(s,{name:"material-symbols:keyboard-arrow-up",class:"h-4 w-4"})],8,be),t("button",{onClick:h=>P(i,"down"),disabled:i===r(a).length-1,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",title:"نقل لأسفل"},[m(s,{name:"material-symbols:keyboard-arrow-down",class:"h-4 w-4"})],8,ye),t("button",{onClick:h=>B(i),class:"p-1 text-blue-400 hover:text-blue-600",title:"نسخ"},[m(s,{name:"material-symbols:content-copy",class:"h-4 w-4"})],8,he),t("button",{onClick:h=>L(i),class:"p-1 text-red-400 hover:text-red-600",title:"حذف"},[m(s,{name:"material-symbols:delete",class:"h-4 w-4"})],8,ve)])]),t("div",fe,[t("p",_e,p(n.type)+" - مكون محمل من قاعدة البيانات",1)])]))),128))]))]))])])])])])}}};export{Ce as default};
