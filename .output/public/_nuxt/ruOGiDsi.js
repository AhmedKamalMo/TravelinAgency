import M from"./CTyvNebC.js";import{d as F,z as N,g as w,S as V,R as L,m as A,E as D,c as d,e as m,o as i,b as e,t as n,h as r,a as $,l as P,w as C,i as g,v as _,H as v,T as R,F as Z,r as O,j as H}from"./Bf4XLz-f.js";import{u as G}from"./D6hYrwdZ.js";const J={class:"sticky top-0 bg-white border-b border-gray-100 px-6 py-4 rounded-t-2xl"},K={class:"flex justify-between items-center"},Q={class:"text-xl font-bold text-gray-900"},W={class:"text-sm text-gray-600 mt-1"},Y={class:"text-primary font-medium"},ee={class:"px-6 py-4"},te={for:"fullName",class:"block text-sm font-medium text-gray-700 mb-1"},oe=["placeholder"],ae={for:"email",class:"block text-sm font-medium text-gray-700 mb-1"},se=["placeholder"],re={key:0,class:"mt-1 text-red-500 text-xs"},le={for:"phone",class:"block text-sm font-medium text-gray-700 mb-1"},ne={class:"flex gap-2"},ce=["value"],ie=["placeholder"],de={key:0,class:"mt-1 text-red-500 text-xs"},me={for:"message",class:"block text-sm font-medium text-gray-700 mb-1"},ue=["placeholder"],pe={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},fe={class:"flex items-center gap-3"},ge={class:"text-green-800 font-medium text-sm"},ye={class:"text-green-700 text-xs mt-1"},he={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},xe={class:"flex items-center gap-3"},be={class:"text-red-800 font-medium text-sm"},_e={class:"text-red-700 text-xs mt-1"},ve={class:"pt-2"},Xe=["disabled"],Ne=F({__name:"ContactForm",props:{modelValue:{type:Boolean},package_:{}},emits:["update:modelValue"],setup(S,{emit:E}){const{t:s}=N(),{playSuccessSound:z,playErrorSound:T}=G(),y=S,U=E,u=w(!1),h=w(!1),x=w(!1),c=V({email:"",phone:""}),j=o=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o),q=(o,a)=>{var f;return((f={"+20":/^1[0-9]\d{8}$/,"+966":/^5\d{8}$/,"+971":/^5\d{8}$/,"+974":/^[3-7]\d{7}$/,"+973":/^[3-7]\d{7}$/,"+965":/^[5-9]\d{7}$/,"+968":/^[7-9]\d{7}$/}[a])==null?void 0:f.test(o))||!1},X=[{code:"+966",flag:"",example:"5X XXX XXXX",key:"sa"},{code:"+20",flag:"",example:"1X XXXX XXXX",key:"eg"},{code:"+971",flag:"",example:"5X XXX XXXX",key:"ae"},{code:"+974",flag:"",example:"3XXX XXXX",key:"qa"},{code:"+973",flag:"",example:"3XXX XXXX",key:"bh"},{code:"+965",flag:"",example:"5XXX XXXX",key:"kw"},{code:"+968",flag:"",example:"9XXX XXXX",key:"om"}],t=V({fullName:"",email:"",countryCode:X[0].code,phone:"",message:""}),{locale:k}=N();L(()=>y.package_,o=>{if(o){const a=k.value.slice(0,2);t.message=`أنا مهتم بالباقة: ${o[`title_${a}`]}`}},{immediate:!0});const b=()=>{U("update:modelValue",!1)},B=o=>{const a=o.target;t.phone=a.value.replace(/\D/g,"")},I=async()=>{if(c.email="",c.phone="",!j(t.email)){c.email=s("contact.form.email.error");return}if(!q(t.phone,t.countryCode)){c.phone=s("contact.form.phone.error");return}try{u.value=!0,x.value=!1,h.value=!1;let o;y.package_?o=await $fetch("/api/package-contact-form",{method:"POST",body:{name:t.fullName,email:t.email,phone:`${t.countryCode}${t.phone}`,message:t.message,packageId:y.package_.id,packageName:y.package_[`title_${k.value.slice(0,2)}`],locale:k.value}}):o=await $fetch("/api/contact-messages",{method:"POST",body:{name:t.fullName,email:t.email,phone:`${t.countryCode}${t.phone}`,subject:"استفسار عام",message:t.message,type:"general",source:"website"}}),console.log("Form submission result:",o),o.success?(h.value=!0,t.fullName="",t.email="",t.phone="",t.message="",h.value=!0,z(),setTimeout(()=>{b()},3e3)):x.value=!0}catch(o){console.error("Error submitting contact form:",o),x.value=!0,T()}finally{u.value=!1}};return A(()=>{const o=a=>{a.key==="Escape"&&b()};window.addEventListener("keydown",o),D(()=>{window.removeEventListener("keydown",o)})}),(o,a)=>{var f;const p=M;return o.modelValue?(i(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:b},[e("div",{class:v(["bg-white rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto transform transition-all duration-300",{"scale-100 opacity-100":o.modelValue,"scale-95 opacity-0":!o.modelValue}]),onClick:a[5]||(a[5]=C(()=>{},["stop"]))},[e("div",J,[e("div",K,[e("h2",Q,n(r(s)("contact.title")),1),e("button",{onClick:b,class:"text-gray-400 hover:text-gray-600 transition-colors"},[$(p,{name:"material-symbols:close",class:"h-6 w-6"})])]),e("p",W,[P(n(r(s)("contact.description"))+" ",1),e("span",Y,n(r(s)("contact.free")),1)])]),e("div",ee,[e("form",{onSubmit:C(I,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",te,n(r(s)("contact.form.fullName.label")),1),g(e("input",{"onUpdate:modelValue":a[0]||(a[0]=l=>t.fullName=l),type:"text",id:"fullName",required:"",placeholder:r(s)("contact.form.fullName.placeholder"),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-primary focus:ring-1 focus:ring-primary transition-colors placeholder:text-gray-400 outline-none text-gray-700 text-sm"},null,8,oe),[[_,t.fullName]])]),e("div",null,[e("label",ae,n(r(s)("contact.form.email.label")),1),g(e("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>t.email=l),type:"email",id:"email",required:"",placeholder:r(s)("contact.form.email.placeholder"),class:v(["w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-primary focus:ring-1 focus:ring-primary transition-colors placeholder:text-gray-400 outline-none text-gray-700 text-sm",{"border-red-500 focus:border-red-500 focus:ring-red-500":c.email}])},null,10,se),[[_,t.email]]),c.email?(i(),d("p",re,n(c.email),1)):m("",!0)]),e("div",null,[e("label",le,n(r(s)("contact.form.phone.label")),1),e("div",ne,[g(e("select",{"onUpdate:modelValue":a[2]||(a[2]=l=>t.countryCode=l),class:v(["px-3 py-2.5 rounded-lg border border-gray-300 focus:border-primary focus:ring-1 focus:ring-primary transition-colors outline-none text-gray-700 text-sm min-w-[80px]",{"border-red-500 focus:border-red-500 focus:ring-red-500":c.phone}])},[(i(),d(Z,null,O(X,l=>e("option",{key:l.key,value:l.code},n(l.code),9,ce)),64))],2),[[R,t.countryCode]]),g(e("input",{"onUpdate:modelValue":a[3]||(a[3]=l=>t.phone=l),type:"tel",id:"phone",required:"",placeholder:(f=X.find(l=>l.code===t.countryCode))==null?void 0:f.example,class:v(["flex-1 px-3 py-2.5 rounded-lg border border-gray-300 focus:border-primary focus:ring-1 focus:ring-primary transition-colors placeholder:text-gray-400 outline-none text-gray-700 text-sm",{"text-right":o.$i18n.locale==="ar","border-red-500 focus:border-red-500 focus:ring-red-500":c.phone}]),pattern:"[0-9]*",inputmode:"numeric",onInput:B},null,42,ie),[[_,t.phone]])]),c.phone?(i(),d("p",de,n(c.phone),1)):m("",!0)]),e("div",null,[e("label",me,n(r(s)("contact.form.message.label")),1),g(e("textarea",{"onUpdate:modelValue":a[4]||(a[4]=l=>t.message=l),id:"message",rows:"3",required:"",placeholder:r(s)("contact.form.message.placeholder"),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-primary focus:ring-1 focus:ring-primary transition-colors placeholder:text-gray-400 outline-none text-gray-700 text-sm resize-none"},null,8,ue),[[_,t.message]])]),h.value?(i(),d("div",pe,[e("div",fe,[$(p,{name:"material-symbols:check-circle",class:"h-6 w-6 text-green-600"}),e("div",null,[e("h4",ge,n(r(s)("contact.success.title")),1),e("p",ye,n(r(s)("contact.success.message")),1)])])])):m("",!0),x.value?(i(),d("div",he,[e("div",xe,[$(p,{name:"material-symbols:error",class:"h-6 w-6 text-red-600"}),e("div",null,[e("h4",be,n(r(s)("contact.error.title")),1),e("p",_e,n(r(s)("contact.error.message")),1)])])])):m("",!0),e("div",ve,[e("button",{type:"submit",disabled:u.value,class:"w-full bg-gradient-to-r from-primary to-primary-dark text-white py-3 rounded-lg font-medium hover:from-primary-dark hover:to-primary transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[u.value?(i(),H(p,{key:0,name:"material-symbols:refresh",class:"h-4 w-4 animate-spin"})):m("",!0),e("span",null,n(u.value?r(s)("common.loading"):r(s)("contact.form.submit")),1)],8,Xe)])],32)])],2)])):m("",!0)}}});export{Ne as _};
