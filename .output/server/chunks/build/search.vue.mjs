import{q as e}from"./index2.mjs";import{ref as a,computed as r,defineComponent as t,watch as l,mergeProps as i,unref as n,useSSRContext as s}from"vue";import{ssrRenderAttrs as o,ssrRenderComponent as u,ssrInterpolate as d,ssrRenderList as m}from"vue/server-renderer";import{useRoute as c,useRouter as v}from"vue-router";import{k as p,d as g}from"./usePackages.mjs";import{i as x}from"./server.mjs";import{G as h}from"./NuxtImg.vue2.mjs";import{I as f}from"./PackageCard.vue2.mjs";import"@iconify/utils/lib/css/icon";import"@iconify/vue";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"unhead/utils";import"devalue";import"unhead/plugins";import"@unhead/schema-org";import"@unhead/schema-org/vue";import"floating-vue";import"./nuxt-link.mjs";const b=t({__name:"search",__ssrInlineRender:!0,setup(t){c();const s=v(),{t:b,locale:y}=x(),{packages:w,pending:$,error:_}=p(),{filters:k,searchQuery:R,filterOptions:L}=(()=>{const{locale:e}=x(),{getPackages:t}=p(),l=a(""),i=a({periods:[],priceRange:{min:0,max:1/0},duration:{min:0,max:1/0},dates:{start:null,end:null},travelers:1,type:[]}),n=r((()=>t())),s=r((()=>{const e=n.value||[];if(0===e.length)return{periods:[],priceRanges:[],durationRanges:[]};const a=new Set;e.forEach((e=>{e.travel_period&&a.add(e.travel_period)}));const r=["january","february","march","april","may","june","july","august","september","october","november","december"],t=Array.from(a).sort(((e,a)=>r.findIndex((a=>e.toLowerCase().includes(a)))-r.findIndex((e=>a.toLowerCase().includes(e))))),l={january:{en:"January",ar:"يناير"},february:{en:"February",ar:"فبراير"},march:{en:"March",ar:"مارس"},april:{en:"April",ar:"أبريل"},may:{en:"May",ar:"مايو"},june:{en:"June",ar:"يونيو"},july:{en:"July",ar:"يوليو"},august:{en:"August",ar:"أغسطس"},september:{en:"September",ar:"سبتمبر"},october:{en:"October",ar:"أكتوبر"},november:{en:"November",ar:"نوفمبر"},december:{en:"December",ar:"ديسمبر"}};return{periods:t.map((e=>({id:e,name:l[e]||{en:e,ar:e}}))),priceRanges:[{min:0,max:1e3,label:"Under $1,000"},{min:1e3,max:3e3,label:"$1,000 - $3,000"},{min:3e3,max:5e3,label:"$3,000 - $5,000"},{min:5e3,max:1/0,label:"Over $5,000"}],durationRanges:[{min:0,max:3,label:"1-3 days"},{min:4,max:7,label:"4-7 days"},{min:8,max:14,label:"8-14 days"},{min:15,max:1/0,label:"15+ days"}]}})),o=r((()=>{let e=n.value||[];if(l.value){const a=l.value.toLowerCase();e=e.filter((e=>e.title_en.toLowerCase().includes(a)||e.description_en.toLowerCase().includes(a)))}return i.value.periods.length>0&&(e=e.filter((e=>i.value.periods.some((a=>e.travel_period.toLowerCase()===a.toLowerCase()))))),(i.value.priceRange.min>0||i.value.priceRange.max<1/0)&&(e=e.filter((e=>e.price>=i.value.priceRange.min&&e.price<=i.value.priceRange.max))),(i.value.duration.min>0||i.value.duration.max<1/0)&&(e=e.filter((e=>e.duration_days>=i.value.duration.min&&e.duration_days<=i.value.duration.max))),e})),u=r((()=>{let e=0;return e+=i.value.periods.length,(0!==i.value.priceRange.min||i.value.priceRange.max!==1/0)&&e++,(0!==i.value.duration.min||i.value.duration.max!==1/0)&&e++,i.value.dates.start&&i.value.dates.end&&e++,i.value.travelers>1&&e++,e}));return{searchQuery:l,filters:i,filterOptions:s,filteredPackages:o,activeFiltersCount:u,resetFilters:()=>{l.value="",i.value={periods:[],priceRange:{min:0,max:1/0},duration:{min:0,max:1/0},dates:{start:null,end:null},travelers:1,type:[]}}}})(),j=r((()=>{var e;return null!=(e=k.value)&&e.destinations?k.value.destinations.map((e=>{var a,r,t;const l=null==(r=null==(a=L.value)?void 0:a.destinations)?void 0:r.find((a=>a.id===e));return(null==(t=null==l?void 0:l.name)?void 0:t[y.value])||e})):[]})),C=r((()=>{var e,a,r,t,l;return!!k.value&&(((null==(e=k.value.destinations)?void 0:e.length)||0)>0||0!==((null==(a=k.value.priceRange)?void 0:a.min)||0)||((null==(r=k.value.priceRange)?void 0:r.max)||1/0)!==1/0||0!==((null==(t=k.value.duration)?void 0:t.min)||0)||((null==(l=k.value.duration)?void 0:l.max)||1/0)!==1/0||(k.value.travelers||1)>1)})),M=r((()=>w.value?w.value.filter((e=>{var a,r,t,l,i,n,s,o,u,d,m,c,v,p,g,x;if(R.value){const i=R.value.toLowerCase(),n=(null==(a=e.title_en)?void 0:a.toLowerCase().includes(i))||(null==(r=e.title_ar)?void 0:r.toLowerCase().includes(i)),s=(null==(t=e.description_en)?void 0:t.toLowerCase().includes(i))||(null==(l=e.description_ar)?void 0:l.toLowerCase().includes(i));if(!n&&!s)return!1}if((null==(n=null==(i=k.value)?void 0:i.destinations)?void 0:n.length)>0){const a=null==(s=null==e?void 0:e.travel_period)?void 0:s.toLowerCase();if(!a||!k.value.destinations.some((e=>{const r=e.toLowerCase();return a.includes(r)})))return!1}return!((null==e?void 0:e.price_per_person)<((null==(u=null==(o=k.value)?void 0:o.priceRange)?void 0:u.min)||0)||(null==(m=null==(d=k.value)?void 0:d.priceRange)?void 0:m.max)!==1/0&&(null==e?void 0:e.price_per_person)>k.value.priceRange.max||(null==e?void 0:e.duration_days)<((null==(v=null==(c=k.value)?void 0:c.duration)?void 0:v.min)||0)||(null==(g=null==(p=k.value)?void 0:p.duration)?void 0:g.max)!==1/0&&(null==e?void 0:e.duration_days)>k.value.duration.max||((null==(x=k.value)?void 0:x.travelers)||1)>1&&(null==e?void 0:e.max_persons)<k.value.travelers)})):[]));return l([k,R],(([e,a])=>{var r;s.replace({query:{...a&&{q:a},...(null==(r=e.destinations)?void 0:r.length)&&{periods:e.destinations.join(",")},...e.priceRange.min>0&&{priceMin:e.priceRange.min},...e.priceRange.max<1/0&&{priceMax:e.priceRange.max},...e.duration.min>0&&{durationMin:e.duration.min},...e.duration.max<1/0&&{durationMax:e.duration.max},...e.travelers>1&&{travelers:e.travelers}}})}),{deep:!0}),(a,r,t,l)=>{var s;const c=h,v=e;r(`<div${o(i({class:"min-h-screen bg-gray-50"},l))}><section class="relative bg-cover bg-center py-20"><div class="absolute inset-0">`),r(u(c,{src:"/images/packages/home/packages-hero-bg.jpeg",alt:"Stunning beachfront villa with private pool and ocean views",width:"1920",height:"1080",loading:"eager",format:"webp",quality:"90",class:"w-full h-full object-cover",placeholder:""},null,t)),r(`<div class="absolute inset-0 bg-gradient-to-b from-black/50 via-black/30 to-black/50"></div></div><div class="container relative z-10 mx-auto px-4 text-center text-white"><h1 class="text-2xl md:text-3xl font-bold mb-4">${d(n(b)("search.results.title"))}</h1><div class="flex items-center justify-center text-1xl gap-2 text-sm md:text-base mb-6 w-full">`),M.value.length>0?r(`<span>${d(n(b)("search.results.count",{count:M.value.length}))}</span>`):r(`<span>${d(n(b)("search.results.empty"))}</span>`),r('</div><div class="flex flex-wrap justify-center gap-3 mb-8">'),null!=(s=n(k))&&s.destinations&&n(k).destinations.length?r(`<div class="flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg><span>${d(j.value.join(", "))}</span></div>`):r("\x3c!----\x3e"),0!==n(k).priceRange.min||n(k).priceRange.max!==1/0?(r('<div class="flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full">'),r(u(g,{size:20,class:"text-white"},null,t)),r(`<span>${d((e=>e.max===1/0?`${b("common.from")} ${e.min.toLocaleString()}`:`${e.min.toLocaleString()} - ${e.max.toLocaleString()}`)(n(k).priceRange))}</span></div>`)):r("\x3c!----\x3e"),0!==n(k).duration.min||n(k).duration.max!==1/0?r(`<div class="flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path></svg><span>${d((e=>e.max===1/0?`${b("common.from")} ${e.min} ${b("common.days")}`:`${e.min} - ${e.max} ${b("common.days")}`)(n(k).duration))}</span></div>`):r("\x3c!----\x3e"),n(k).travelers>1?r(`<div class="flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"></path></svg><span>${d(n(k).travelers)} ${d(n(b)("search.travelers_count",{count:n(k).travelers}))}</span></div>`):r("\x3c!----\x3e"),C.value?r(`<button class="flex items-center gap-2 bg-primary/20 hover:bg-primary/30 backdrop-blur-sm px-4 py-2 rounded-full transition-colors"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg> ${d(n(b)("search.active_filters.clear_filters"))}</button>`):r("\x3c!----\x3e"),r('</div></div></section><section class="py-16"><div class="container mx-auto px-4">'),n($)?r('<div class="flex justify-center items-center min-h-[400px]"><div class="animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"></div></div>'):n(_)?(r('<div class="text-center text-red-500 py-16"><div class="max-w-md mx-auto">'),r(u(v,{name:"material-symbols:error-outline",class:"h-16 w-16 mx-auto mb-4 text-red-400"},null,t)),r(`<h3 class="text-lg font-medium mb-2">${d(n(b)("common.error"))}</h3><p class="text-gray-500">${d(n(_).message||"An error occurred while loading packages")}</p></div></div>`)):0===n(w).length?(r('<div class="text-center text-gray-500 py-16"><div class="max-w-md mx-auto">'),r(u(v,{name:"material-symbols:package-2-outline",class:"h-16 w-16 mx-auto mb-4 text-gray-400"},null,t)),r(`<h3 class="text-lg font-medium mb-2">${d(n(b)("packages.no_packages"))}</h3><p class="text-gray-500">${d(n(b)("packages.no_packages_description"))}</p></div></div>`)):0===M.value.length?(r('<div class="text-center py-16"><div class="max-w-md mx-auto">'),r(u(v,{name:"material-symbols:search-off",class:"h-16 w-16 mx-auto mb-4 text-gray-400"},null,t)),r(`<h3 class="text-lg font-medium mb-2">${d(n(b)("search.results.empty"))}</h3><p class="text-gray-500 mb-6">${d(n(b)("search.results.empty_description"))}</p><button class="px-6 py-2 bg-primary text-white rounded-xl hover:bg-primary/90 transition-colors">${d(n(b)("search.actions.clear_filters"))}</button></div></div>`)):(r('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">\x3c!--[--\x3e'),m(M.value,(e=>{r(u(f,{key:e.id,package_:e},null,t))})),r("\x3c!--]--\x3e</div>")),r("</div></section></div>")}}}),y=b.setup;b.setup=(e,a)=>{const r=s();return(r.modules||(r.modules=new Set)).add("pages/packages/search.vue"),y?y(e,a):void 0};export{b as default};
//# sourceMappingURL=search.vue.mjs.map
