import{c as e,m as t,e as a}from"../../../_/nitro.mjs";import{mkdir as s,writeFile as o}from"fs/promises";import{join as i,extname as r}from"path";import{v as m}from"../../../_/v4.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:module";import"ipx";import"node:path";import"crypto";const p=e((async e=>{try{const p=await t(e);if(!p||0===p.length)throw a({statusCode:400,statusMessage:"No files uploaded"});const c=[],n=i(process.cwd(),"public","images","packages","imported");await s(n,{recursive:!0});for(const e of p)if(e.data&&e.filename){const t=r(e.filename),a=`${m()}${t}`,p=i(n,a);await o(p,e.data);const l=`thumb_${a}`,u=i(process.cwd(),"public","images","packages","thumbnails",l);await s(i(process.cwd(),"public","images","packages","thumbnails"),{recursive:!0}),await o(u,e.data),c.push({originalName:e.filename,filename:a,thumbnail:l,path:`/images/packages/imported/${a}`,thumbnailPath:`/images/packages/thumbnails/${l}`,size:e.data.length,type:e.type||"image/jpeg"})}return{success:!0,message:"Images uploaded successfully",files:c}}catch(e){throw console.error("Error uploading images:",e),a({statusCode:500,statusMessage:"Failed to upload images"})}}));export{p as default};
//# sourceMappingURL=upload.post.mjs.map
