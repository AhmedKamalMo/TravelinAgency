import{c as a,m as t,e}from"../../../_/nitro.mjs";import{mkdir as s,writeFile as o}from"fs/promises";import{join as i,extname as r}from"path";import{v as m}from"../../../_/v4.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";import"crypto";const p=a((async a=>{try{const p=await t(a);if(!p||0===p.length)throw e({statusCode:400,statusMessage:"No files uploaded"});const c=[],n=i(process.cwd(),"public","images","packages","imported");await s(n,{recursive:!0});for(const a of p)if(a.data&&a.filename){const t=r(a.filename),e=`${m()}${t}`,p=i(n,e);await o(p,a.data);const l=`thumb_${e}`,u=i(process.cwd(),"public","images","packages","thumbnails",l);await s(i(process.cwd(),"public","images","packages","thumbnails"),{recursive:!0}),await o(u,a.data),c.push({originalName:a.filename,filename:e,thumbnail:l,path:`/images/packages/imported/${e}`,thumbnailPath:`/images/packages/thumbnails/${l}`,size:a.data.length,type:a.type||"image/jpeg"})}return{success:!0,message:"Images uploaded successfully",files:c}}catch(a){throw console.error("Error uploading images:",a),e({statusCode:500,statusMessage:"Failed to upload images"})}}));export{p as default};
//# sourceMappingURL=upload.post.mjs.map
