import{c as o,m as t,e}from"../../../_/nitro.mjs";import{mkdir as s,writeFile as a}from"fs/promises";import{join as i,extname as r}from"path";import{v as m}from"../../../_/v4.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"node:module";import"ipx";import"node:path";import"crypto";const p=o((async o=>{try{const p=await t(o);if(!p||0===p.length)throw e({statusCode:400,statusMessage:"No files uploaded"});const n=p.find((o=>"image"===o.name));if(!n||!n.data||!n.filename)throw e({statusCode:400,statusMessage:"Image file is missing or invalid"});const d=i(process.cwd(),"public","images","packages");await s(d,{recursive:!0});const c=r(n.filename),u=`${m()}${c}`,l=i(d,u);await a(l,n.data);return{success:!0,message:"Image uploaded successfully",data:{url:`/images/packages/${u}`}}}catch(o){throw console.error("Error uploading package image:",o),e({statusCode:500,statusMessage:o.message||"Failed to upload package image"})}}));export{p as default};
//# sourceMappingURL=upload-package.post.mjs.map
