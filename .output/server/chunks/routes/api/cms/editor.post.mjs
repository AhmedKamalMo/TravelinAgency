import{c as t,r as e,e as o}from"../../../_/nitro.mjs";import{e as r}from"../../../_/database.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";import"mysql2/promise";import"bcryptjs";import"jsonwebtoken";const s=t((async t=>{var s,n,i,a,p,l;const c=await e(t);try{const t=(c.title_ar||c.title||"new-page").toLowerCase().replace(/[^a-z0-9\u0600-\u06FF\s]/g,"").replace(/\s+/g,"-").substring(0,50),e=(await r("\n      INSERT INTO cms_pages (\n        slug,\n        title, \n        meta_title, \n        meta_description, \n        status, \n        template, \n        created_by\n      ) VALUES (?, ?, ?, ?, ?, ?, ?)\n    ",[t,c.title_ar||c.title||"",c.title_en||c.meta_title||"",c.meta_description_ar||c.meta_description||"",c.status||"draft",c.template||"default",1])).insertId;if(c.components&&Array.isArray(c.components))for(let t=0;t<c.components.length;t++){const o=c.components[t];await r("\n          INSERT INTO cms_sections (\n            page_id, section_type, title, subtitle, content,\n            background_color, background_image, text_color, order_index, is_active, settings\n          ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n        ",[e,o.type||"generic",(null==(s=o.props)?void 0:s.title)||"",(null==(n=o.props)?void 0:n.subtitle)||"",(null==(i=o.props)?void 0:i.content)||"",(null==(a=o.props)?void 0:a.backgroundColor)||"",(null==(p=o.props)?void 0:p.backgroundImage)||"",(null==(l=o.props)?void 0:l.textColor)||"",t,!0,JSON.stringify(o.props||{})])}return{success:!0,message:"Page created successfully",id:e}}catch(t){throw console.error("Error creating page:",t),o({statusCode:500,statusMessage:"Failed to create page"})}}));export{s as default};
//# sourceMappingURL=editor.post.mjs.map
