import{c as e,e as t,r as s}from"../../../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";const a=e((async e=>{var a,o,i;try{const r=await getServerSession(e);if(!(null==(a=null==r?void 0:r.user)?void 0:a.role)||!["admin","moderator"].includes(r.user.role))throw t({statusCode:403,statusMessage:"غير مصرح بالوصول"});const n=await s(e);if(!n.email||!n.password||!n.full_name)throw t({statusCode:400,statusMessage:"البريد الإلكتروني وكلمة المرور والاسم الكامل مطلوبة"});if(i=n.email,!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i))throw t({statusCode:400,statusMessage:"البريد الإلكتروني غير صحيح"});if(n.password.length<6)throw t({statusCode:400,statusMessage:"كلمة المرور يجب أن تكون 6 أحرف على الأقل"});if(n.phone&&(o=n.phone,!/^\+966[0-9]{9}$/.test(o)))throw t({statusCode:400,statusMessage:"رقم الهاتف غير صحيح"});if(n.role&&!["admin","moderator","user"].includes(n.role))throw t({statusCode:400,statusMessage:"الدور غير صحيح"});if(n.status&&!["active","inactive","suspended"].includes(n.status))throw t({statusCode:400,statusMessage:"الحالة غير صحيحة"});return{success:!0,data:{id:Date.now(),email:n.email,full_name:n.full_name,phone:n.phone||"",role:n.role||"user",status:n.status||"active",email_verified:!1,phone_verified:!1,bio:n.bio||"",date_of_birth:n.date_of_birth||"",gender:n.gender||"male",nationality:n.nationality||"Saudi Arabia",address:n.address||"",city:n.city||"",country:n.country||"Saudi Arabia",postal_code:n.postal_code||"",preferences:{language:"ar",timezone:"Asia/Riyadh",notifications:{email:!0,sms:!0,push:!0},privacy:{profile_visibility:"public",show_email:!1,show_phone:!1}},created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),last_login:null,login_count:0},message:"تم إنشاء المستخدم بنجاح"}}catch(e){return console.error("Error creating user:",e),{success:!1,error:e.message||"فشل في إنشاء المستخدم"}}}));export{a as default};
//# sourceMappingURL=index.post.mjs.map
