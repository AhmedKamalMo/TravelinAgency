import{c as e,f as t}from"../../../_/nitro.mjs";import{createConnection as o}from"mysql2/promise";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";const r=e((async e=>{try{const r=t(e),a=parseInt(r.page)||1,i=parseInt(r.limit)||10,s=r.search||"",n=r.status||"",l=r.role||"",d=await o({host:"localhost",user:"root",password:"",database:"wonderland_travel"}),[c]=await d.execute("\n      SELECT * FROM users \n      ORDER BY created_at DESC\n    ");await d.end();let m=c.map((e=>{let t="user";return"admin@wonderland.com"===e.email?t="admin":"moderator@wonderland.com"===e.email&&(t="moderator"),{id:e.id,email:e.email,full_name:e.full_name||e.name,phone:e.phone,role:t,status:e.status||"active",email_verified:e.email_verified||!1,phone_verified:e.phone_verified||!1,bio:e.bio,date_of_birth:e.date_of_birth,gender:e.gender,nationality:e.nationality,address:e.address,city:e.city,country:e.country,postal_code:e.postal_code,preferences:e.preferences?JSON.parse(e.preferences):{},created_at:e.created_at,updated_at:e.updated_at,last_login:e.last_login,login_count:e.login_count||0}}));s&&(m=m.filter((e=>{var t,o;return(null==(t=e.full_name)?void 0:t.toLowerCase().includes(s.toLowerCase()))||e.email.toLowerCase().includes(s.toLowerCase())||(null==(o=e.phone)?void 0:o.toLowerCase().includes(s.toLowerCase()))}))),n&&(m=m.filter((e=>e.status===n))),l&&(m=m.filter((e=>e.role===l)));const p=(a-1)*i,u=p+i;return{success:!0,data:{users:m.slice(p,u),total:m.length,page:a,limit:i}}}catch(e){return console.error("Error fetching users:",e),{success:!1,error:e.message||"فشل في جلب المستخدمين"}}}));export{r as default};
//# sourceMappingURL=index.get.mjs.map
