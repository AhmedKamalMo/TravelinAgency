import{c as t,r as e,e as a}from"../../_/nitro.mjs";import{executeQuery as i}from"../../_/database.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";import"mysql2/promise";import"bcryptjs";import"jsonwebtoken";const r=t((async t=>{try{const r=await e(t);if(!(r.title_ar&&r.title_en&&r.description_ar&&r.description_en))throw a({statusCode:400,statusMessage:"Title and description in both languages are required"});const n=await i("\n      INSERT INTO packages (\n        title_ar,\n        title_en,\n        description_ar,\n        description_en,\n        price,\n        duration_days,\n        travel_period,\n        max_persons,\n        image_url,\n        featured,\n        active,\n        created_at,\n        updated_at\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)\n    ",[r.title_ar,r.title_en,r.description_ar,r.description_en,r.price||0,r.duration_days||1,r.travel_period||"",r.max_persons||10,r.image_url||"",r.featured?1:0,"active"===r.status?1:0]),o=await i("\n      SELECT \n        id, \n        title_ar,\n        title_en,\n        description_ar,\n        description_en,\n        price,\n        duration_days as duration,\n        image_url as image,\n        travel_period as location,\n        featured,\n        active as status,\n        created_at,\n        updated_at\n      FROM packages \n      WHERE id = ?\n    ",[n.insertId]);if(!o||0===o.length)throw a({statusCode:500,statusMessage:"Failed to retrieve created package"});const s=o[0];return{success:!0,id:s.id,package:{id:s.id,image_url:s.image,title_ar:s.title_ar,title_en:s.title_en,description_ar:s.description_ar,description_en:s.description_en,travel_period:s.location,duration_days:s.duration,price:s.price,max_persons:10,featured:s.featured,location:s.location,status:s.status,created_at:s.created_at,updated_at:s.updated_at}}}catch(t){if(console.error("Error creating package:",t),t.statusCode)throw t;throw a({statusCode:500,statusMessage:"Failed to create package"})}}));export{r as default};
//# sourceMappingURL=packages.post.mjs.map
