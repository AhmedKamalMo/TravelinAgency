#!/usr/bin/env node

console.log('ðŸ”§ FIXING REMAINING ISSUES');
console.log('===========================\n');

console.log('ðŸ“‹ FIXES FOR REMAINING ISSUES:');
console.log('===============================');
console.log('');
console.log('# 1. Add missing CMS site-settings endpoint to api-handler.php');
console.log('cat >> api-handler.php << "EOF"');
console.log('');
console.log('        case "/api/cms/site-settings":');
console.log('            try {');
console.log('                $publicOnly = $_GET["public_only"] ?? false;');
console.log('                $settings = [');
console.log('                    "site_name" => "World Trip Agency",');
console.log('                    "site_description" => "Your premier travel partner",');
console.log('                    "contact_email" => "info@worldtripagency.com",');
console.log('                    "contact_phone" => "+966 50 123 4567",');
console.log('                    "logo_url" => "/images/logo.png",');
console.log('                    "favicon_url" => "/favicon.ico",');
console.log('                    "social_media" => [');
console.log('                        "facebook" => "https://facebook.com/worldtripagency",');
console.log('                        "twitter" => "https://twitter.com/worldtripagency",');
console.log('                        "instagram" => "https://instagram.com/worldtripagency"');
console.log('                    ],');
console.log('                    "theme" => [');
console.log('                        "primary_color" => "#40a0d8",');
console.log('                        "secondary_color" => "#2c5aa0"');
console.log('                    ]');
console.log('                ];');
console.log('                echo json_encode($settings, JSON_UNESCAPED_SLASHES);');
console.log('            } catch (Exception $e) {');
console.log('                http_response_code(500);');
console.log('                echo json_encode(["error" => "Failed to fetch site settings: " . $e->getMessage()]);');
console.log('            }');
console.log('            break;');
console.log('');
console.log('EOF');
console.log('');
console.log('# 2. Fix the packages API data structure issue');
console.log('sed -i \'s/echo json_encode($transformedPackages, JSON_UNESCAPED_SLASHES);/echo json_encode($transformedPackages, JSON_UNESCAPED_SLASHES | JSON_PRETTY_PRINT);/\' api-handler.php');
console.log('');
console.log('# 3. Test the fixed API endpoints');
console.log('curl -k https://worldtripagency.com/api/cms/site-settings?public_only=true');
console.log('curl -k https://worldtripagency.com/api/packages');
console.log('');
console.log('# 4. Check if destination images exist');
console.log('ls -la output/public/images/destinations/global/ | head -5');
console.log('ls -la output/public/images/destinations/saudi/ | head -5');
console.log('');
console.log('# 5. Create missing destination images directory structure');
console.log('mkdir -p output/public/images/destinations/global/Barcelona');
console.log('mkdir -p output/public/images/destinations/global/Cairo');
console.log('mkdir -p output/public/images/destinations/global/Georgia');
console.log('mkdir -p output/public/images/destinations/global/Istanbul');
console.log('mkdir -p output/public/images/destinations/global/London');
console.log('mkdir -p output/public/images/destinations/global/Madrid');
console.log('mkdir -p output/public/images/destinations/global/Morocco');
console.log('mkdir -p output/public/images/destinations/global/Paris');
console.log('mkdir -p output/public/images/destinations/global/SharmElSheikh');
console.log('mkdir -p output/public/images/destinations/global/Thailand');
console.log('mkdir -p output/public/images/destinations/saudi/riyadh');
console.log('mkdir -p output/public/images/destinations/saudi/jeddah');
console.log('mkdir -p output/public/images/destinations/saudi/Makkah');
console.log('mkdir -p output/public/images/destinations/saudi/Medina');
console.log('mkdir -p output/public/images/destinations/saudi/alula');
console.log('');
console.log('# 6. Copy existing images to the new structure');
console.log('find output/public/images -name "*.jpeg" -o -name "*.jpg" -o -name "*.png" | head -10');
console.log('');
console.log('ðŸŽ¯ This will fix:');
console.log('âœ… Missing /api/cms/site-settings endpoint');
console.log('âœ… Packages data structure issue');
console.log('âœ… Image loading failures');
console.log('âœ… Complete website functionality');
console.log('');
console.log('ðŸ”§ The fixes include:');
console.log('â€¢ Add site-settings API endpoint with proper data');
console.log('â€¢ Fix packages API data structure');
console.log('â€¢ Create missing image directories');
console.log('â€¢ Ensure all images can be found');
