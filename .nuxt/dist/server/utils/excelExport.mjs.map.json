{"file":"excelExport.mjs","mappings":"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","names":["exportToExcel","data","columns","filename","worksheetData","item","row","column","value","worksheet","XLSX","workbook","error","exportBookingsToExcel","bookings","getBookingStatusName","getPaymentStatusName","formatPrice","formatDate","exportPackagesToExcel","packages","getCategoryName","getPackageStatusName","exportDestinationsToExcel","destinations","getDestinationTypeName","getDestinationStatusName","exportUsersToExcel","users","getRoleName","getUserStatusName","price","dateString","status","category","type","role"],"sources":["../../../../utils/excelExport.ts"],"sourcesContent":["import * as XLSX from 'xlsx'\r\n\r\nexport interface ExportData {\r\n  [key: string]: any\r\n}\r\n\r\nexport interface ExportColumn {\r\n  key: string\r\n  label: string\r\n  formatter?: (value: any) => string\r\n}\r\n\r\n/**\r\n * تصدير البيانات إلى ملف Excel\r\n * @param data البيانات المراد تصديرها\r\n * @param columns تعريف الأعمدة\r\n * @param filename اسم الملف\r\n */\r\nexport function exportToExcel(\r\n  data: ExportData[],\r\n  columns: ExportColumn[],\r\n  filename: string = 'export.xlsx'\r\n) {\r\n  try {\r\n    // تحويل البيانات إلى تنسيق Excel\r\n    const worksheetData = data.map(item => {\r\n      const row: { [key: string]: any } = {}\r\n      columns.forEach(column => {\r\n        const value = item[column.key]\r\n        row[column.label] = column.formatter ? column.formatter(value) : value\r\n      })\r\n      return row\r\n    })\r\n\r\n    // إنشاء ورقة العمل\r\n    const worksheet = XLSX.utils.json_to_sheet(worksheetData)\r\n    \r\n    // إنشاء المصنف\r\n    const workbook = XLSX.utils.book_new()\r\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1')\r\n\r\n    // تحميل الملف\r\n    XLSX.writeFile(workbook, filename)\r\n    \r\n    return true\r\n  } catch (error) {\r\n    console.error('خطأ في تصدير البيانات:', error)\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * تصدير الحجوزات إلى Excel\r\n */\r\nexport function exportBookingsToExcel(bookings: any[]) {\r\n  const columns: ExportColumn[] = [\r\n    { key: 'booking_number', label: 'رقم الحجز' },\r\n    { key: 'customer_name', label: 'اسم العميل' },\r\n    { key: 'customer_email', label: 'البريد الإلكتروني' },\r\n    { key: 'customer_phone', label: 'رقم الهاتف' },\r\n    { key: 'package_title', label: 'اسم الباقة' },\r\n    { key: 'travel_date', label: 'تاريخ السفر' },\r\n    { key: 'return_date', label: 'تاريخ العودة' },\r\n    { key: 'adults', label: 'عدد البالغين' },\r\n    { key: 'children', label: 'عدد الأطفال' },\r\n    { key: 'status', label: 'حالة الحجز', formatter: (value) => getBookingStatusName(value) },\r\n    { key: 'payment_status', label: 'حالة الدفع', formatter: (value) => getPaymentStatusName(value) },\r\n    { key: 'total_amount', label: 'المبلغ الإجمالي', formatter: (value) => formatPrice(value) },\r\n    { key: 'currency', label: 'العملة' },\r\n    { key: 'created_at', label: 'تاريخ الحجز', formatter: (value) => formatDate(value) }\r\n  ]\r\n\r\n  const filename = `حجوزات_${new Date().toISOString().split('T')[0]}.xlsx`\r\n  return exportToExcel(bookings, columns, filename)\r\n}\r\n\r\n/**\r\n * تصدير الباقات إلى Excel\r\n */\r\nexport function exportPackagesToExcel(packages: any[]) {\r\n  const columns: ExportColumn[] = [\r\n    { key: 'title_ar', label: 'العنوان (عربي)' },\r\n    { key: 'title_en', label: 'العنوان (إنجليزي)' },\r\n    { key: 'description_ar', label: 'الوصف (عربي)' },\r\n    { key: 'price', label: 'السعر', formatter: (value) => formatPrice(value) },\r\n    { key: 'duration_days', label: 'المدة (أيام)' },\r\n    { key: 'travel_period', label: 'الوجهة' },\r\n    { key: 'category', label: 'الفئة', formatter: (value) => getCategoryName(value) },\r\n    { key: 'status', label: 'الحالة', formatter: (value) => getPackageStatusName(value) },\r\n    { key: 'featured', label: 'مميزة', formatter: (value) => value ? 'نعم' : 'لا' },\r\n    { key: 'created_at', label: 'تاريخ الإنشاء', formatter: (value) => formatDate(value) }\r\n  ]\r\n\r\n  const filename = `حزم_${new Date().toISOString().split('T')[0]}.xlsx`\r\n  return exportToExcel(packages, columns, filename)\r\n}\r\n\r\n/**\r\n * تصدير الوجهات إلى Excel\r\n */\r\nexport function exportDestinationsToExcel(destinations: any[]) {\r\n  const columns: ExportColumn[] = [\r\n    { key: 'name_ar', label: 'الاسم (عربي)' },\r\n    { key: 'name_en', label: 'الاسم (إنجليزي)' },\r\n    { key: 'description_ar', label: 'الوصف (عربي)' },\r\n    { key: 'country', label: 'البلد' },\r\n    { key: 'city', label: 'المدينة' },\r\n    { key: 'region', label: 'المنطقة' },\r\n    { key: 'type', label: 'النوع', formatter: (value) => getDestinationTypeName(value) },\r\n    { key: 'status', label: 'الحالة', formatter: (value) => getDestinationStatusName(value) },\r\n    { key: 'is_featured', label: 'مميزة', formatter: (value) => value ? 'نعم' : 'لا' },\r\n    { key: 'created_at', label: 'تاريخ الإنشاء', formatter: (value) => formatDate(value) }\r\n  ]\r\n\r\n  const filename = `وجهات_${new Date().toISOString().split('T')[0]}.xlsx`\r\n  return exportToExcel(destinations, columns, filename)\r\n}\r\n\r\n/**\r\n * تصدير المستخدمين إلى Excel\r\n */\r\nexport function exportUsersToExcel(users: any[]) {\r\n  const columns: ExportColumn[] = [\r\n    { key: 'full_name', label: 'الاسم الكامل' },\r\n    { key: 'email', label: 'البريد الإلكتروني' },\r\n    { key: 'phone', label: 'رقم الهاتف' },\r\n    { key: 'role', label: 'الدور', formatter: (value) => getRoleName(value) },\r\n    { key: 'status', label: 'الحالة', formatter: (value) => getUserStatusName(value) },\r\n    { key: 'city', label: 'المدينة' },\r\n    { key: 'country', label: 'البلد' },\r\n    { key: 'created_at', label: 'تاريخ الإنشاء', formatter: (value) => formatDate(value) }\r\n  ]\r\n\r\n  const filename = `مستخدمين_${new Date().toISOString().split('T')[0]}.xlsx`\r\n  return exportToExcel(users, columns, filename)\r\n}\r\n\r\n// دوال المساعدة\r\nfunction formatPrice(price: number): string {\r\n  if (!price) return '0.00 ر.س'\r\n  return new Intl.NumberFormat('ar-SA', {\r\n    style: 'currency',\r\n    currency: 'SAR'\r\n  }).format(price)\r\n}\r\n\r\nfunction formatDate(dateString: string): string {\r\n  if (!dateString) return 'غير محدد'\r\n  const date = new Date(dateString)\r\n  return date.toLocaleDateString('ar-SA')\r\n}\r\n\r\nfunction getBookingStatusName(status: string): string {\r\n  const statuses: { [key: string]: string } = {\r\n    confirmed: 'مؤكدة',\r\n    pending: 'في الانتظار',\r\n    cancelled: 'ملغية',\r\n    completed: 'مكتملة'\r\n  }\r\n  return statuses[status] || status\r\n}\r\n\r\nfunction getPaymentStatusName(status: string): string {\r\n  const statuses: { [key: string]: string } = {\r\n    paid: 'مدفوع',\r\n    partial: 'مدفوع جزئياً',\r\n    pending: 'في الانتظار',\r\n    refunded: 'مسترد'\r\n  }\r\n  return statuses[status] || status\r\n}\r\n\r\nfunction getCategoryName(category: string): string {\r\n  const categories: { [key: string]: string } = {\r\n    domestic: 'محلي',\r\n    international: 'دولي',\r\n    religious: 'ديني',\r\n    adventure: 'مغامرة',\r\n    cultural: 'ثقافي'\r\n  }\r\n  return categories[category] || category\r\n}\r\n\r\nfunction getPackageStatusName(status: string): string {\r\n  const statuses: { [key: string]: string } = {\r\n    active: 'نشط',\r\n    inactive: 'غير نشط',\r\n    draft: 'مسودة'\r\n  }\r\n  return statuses[status] || status\r\n}\r\n\r\nfunction getDestinationTypeName(type: string): string {\r\n  const types: { [key: string]: string } = {\r\n    city: 'مدينة',\r\n    landmark: 'معلم تاريخي',\r\n    nature: 'طبيعة',\r\n    beach: 'شاطئ',\r\n    mountain: 'جبل'\r\n  }\r\n  return types[type] || type\r\n}\r\n\r\nfunction getDestinationStatusName(status: string): string {\r\n  const statuses: { [key: string]: string } = {\r\n    active: 'نشط',\r\n    inactive: 'غير نشط',\r\n    draft: 'مسودة'\r\n  }\r\n  return statuses[status] || status\r\n}\r\n\r\nfunction getRoleName(role: string): string {\r\n  const roles: { [key: string]: string } = {\r\n    admin: 'مدير',\r\n    moderator: 'مشرف',\r\n    user: 'مستخدم'\r\n  }\r\n  return roles[role] || role\r\n}\r\n\r\nfunction getUserStatusName(status: string): string {\r\n  const statuses: { [key: string]: string } = {\r\n    active: 'نشط',\r\n    inactive: 'غير نشط',\r\n    suspended: 'معلق'\r\n  }\r\n  return statuses[status] || status\r\n}\r\n"],"version":3}