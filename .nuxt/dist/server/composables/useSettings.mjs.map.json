{"file":"useSettings.mjs","mappings":"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","names":["useSettings","settings","ref","loading","error","loadSettings","publicOnly","result","err","getSetting","key","defaultValue","getSettingsByCategory","category","siteSettings","computed","contactSettings","socialSettings","seoSettings","systemSettings","securitySettings","updateSetting","value","updateSettings","newSettings","flatSettings","readonly"],"sources":["../../../../composables/useSettings.ts"],"sourcesContent":["export const useSettings = () => {\r\n  const settings = ref({})\r\n  const loading = ref(false)\r\n  const error = ref(null)\r\n\r\n  // تحميل الإعدادات\r\n  const loadSettings = async (publicOnly = false) => {\r\n    try {\r\n      loading.value = true\r\n      error.value = null\r\n      \r\n      const result = await $fetch('/api/cms/site-settings', {\r\n        query: { public_only: publicOnly }\r\n      })\r\n      \r\n      if (result && result.data) {\r\n        settings.value = result.data.flatObject || {}\r\n      }\r\n      \r\n      return settings.value\r\n    } catch (err) {\r\n      error.value = err\r\n      console.error('Error loading settings:', err)\r\n      throw err\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n\r\n  // الحصول على إعداد محدد\r\n  const getSetting = (key: string, defaultValue: any = '') => {\r\n    return settings.value[key] || defaultValue\r\n  }\r\n\r\n  // الحصول على إعدادات فئة معينة\r\n  const getSettingsByCategory = (category: string) => {\r\n    const result: any = {}\r\n    Object.keys(settings.value).forEach(key => {\r\n      if (key.startsWith(category + '_') || key.includes(category)) {\r\n        result[key] = settings.value[key]\r\n      }\r\n    })\r\n    return result\r\n  }\r\n\r\n  // إعدادات الموقع العامة\r\n  const siteSettings = computed(() => ({\r\n    name_ar: getSetting('site_name_ar', 'Wonder Land'),\r\n    name_en: getSetting('site_name_en', 'Wonder Land'),\r\n    tagline_ar: getSetting('site_tagline_ar', 'وكالة السفر الرائدة'),\r\n    tagline_en: getSetting('site_tagline_en', 'Leading Travel Agency'),\r\n    description_ar: getSetting('site_description_ar', 'وكالة سفر رائدة في المملكة العربية السعودية'),\r\n    description_en: getSetting('site_description_en', 'Leading travel agency in Saudi Arabia'),\r\n    logo: getSetting('site_logo', '/images/logo.png')\r\n  }))\r\n\r\n  // إعدادات التواصل\r\n  const contactSettings = computed(() => ({\r\n    email: getSetting('contact_email', 'info@wonderland.com'),\r\n    phone: getSetting('contact_phone', '+966501234567'),\r\n    whatsapp: getSetting('contact_whatsapp', '+966501234567'),\r\n    address: getSetting('contact_address', 'الرياض، المملكة العربية السعودية'),\r\n    website: getSetting('website_url', 'https://wonderland.com')\r\n  }))\r\n\r\n  // إعدادات وسائل التواصل الاجتماعي\r\n  const socialSettings = computed(() => ({\r\n    facebook: getSetting('social_facebook', ''),\r\n    twitter: getSetting('social_twitter', ''),\r\n    instagram: getSetting('social_instagram', ''),\r\n    youtube: getSetting('social_youtube', ''),\r\n    linkedin: getSetting('social_linkedin', ''),\r\n    snapchat: getSetting('social_snapchat', '')\r\n  }))\r\n\r\n  // إعدادات SEO\r\n  const seoSettings = computed(() => ({\r\n    keywords: getSetting('seo_keywords', 'سفر، سياحة، رحلات، السعودية'),\r\n    description: getSetting('seo_description', 'اكتشف أفضل الوجهات السياحية مع Wonder Land'),\r\n    googleAnalytics: getSetting('google_analytics', ''),\r\n    googleTagManager: getSetting('google_tag_manager', ''),\r\n    facebookPixel: getSetting('facebook_pixel', '')\r\n  }))\r\n\r\n  // إعدادات النظام\r\n  const systemSettings = computed(() => ({\r\n    defaultLanguage: getSetting('default_language', 'ar'),\r\n    timezone: getSetting('timezone', 'Asia/Riyadh'),\r\n    defaultCurrency: getSetting('default_currency', 'SAR'),\r\n    itemsPerPage: parseInt(getSetting('items_per_page', '20')),\r\n    maintenanceMode: getSetting('maintenance_mode', 'false') === 'true',\r\n    allowRegistration: getSetting('allow_registration', 'true') === 'true',\r\n    enableNotifications: getSetting('enable_notifications', 'true') === 'true',\r\n    enableAnalytics: getSetting('enable_analytics', 'true') === 'true'\r\n  }))\r\n\r\n  // إعدادات الأمان\r\n  const securitySettings = computed(() => ({\r\n    sessionTimeout: parseInt(getSetting('session_timeout', '60')),\r\n    maxLoginAttempts: parseInt(getSetting('max_login_attempts', '5')),\r\n    require2FA: getSetting('require_2fa', 'false') === 'true',\r\n    enableCaptcha: getSetting('enable_captcha', 'false') === 'true',\r\n    logActivities: getSetting('log_activities', 'true') === 'true',\r\n    forceHttps: getSetting('force_https', 'true') === 'true'\r\n  }))\r\n\r\n  // تحديث إعداد\r\n  const updateSetting = async (key: string, value: any) => {\r\n    try {\r\n      await $fetch('/api/cms/site-settings', {\r\n        method: 'PUT',\r\n        body: {\r\n          settings: [{\r\n            setting_key: key,\r\n            setting_value: value.toString(),\r\n            setting_type: typeof value === 'boolean' ? 'boolean' : typeof value === 'number' ? 'number' : 'text',\r\n            category: 'general',\r\n            is_public: true\r\n          }]\r\n        }\r\n      })\r\n      \r\n      // تحديث الإعداد محلياً\r\n      settings.value[key] = value\r\n      \r\n      return true\r\n    } catch (err) {\r\n      console.error('Error updating setting:', err)\r\n      throw err\r\n    }\r\n  }\r\n\r\n  // تحديث عدة إعدادات\r\n  const updateSettings = async (newSettings: Record<string, any>) => {\r\n    try {\r\n      const flatSettings = Object.keys(newSettings).map(key => ({\r\n        setting_key: key,\r\n        setting_value: newSettings[key].toString(),\r\n        setting_type: typeof newSettings[key] === 'boolean' ? 'boolean' : typeof newSettings[key] === 'number' ? 'number' : 'text',\r\n        category: 'general',\r\n        is_public: true\r\n      }))\r\n\r\n      await $fetch('/api/cms/site-settings', {\r\n        method: 'PUT',\r\n        body: { settings: flatSettings }\r\n      })\r\n      \r\n      // تحديث الإعدادات محلياً\r\n      Object.assign(settings.value, newSettings)\r\n      \r\n      return true\r\n    } catch (err) {\r\n      console.error('Error updating settings:', err)\r\n      throw err\r\n    }\r\n  }\r\n\r\n  return {\r\n    // البيانات\r\n    settings: readonly(settings),\r\n    loading: readonly(loading),\r\n    error: readonly(error),\r\n    \r\n    // الإعدادات المجمعة\r\n    siteSettings,\r\n    contactSettings,\r\n    socialSettings,\r\n    seoSettings,\r\n    systemSettings,\r\n    securitySettings,\r\n    \r\n    // الوظائف\r\n    loadSettings,\r\n    getSetting,\r\n    getSettingsByCategory,\r\n    updateSetting,\r\n    updateSettings\r\n  }\r\n}\r\n"],"version":3}