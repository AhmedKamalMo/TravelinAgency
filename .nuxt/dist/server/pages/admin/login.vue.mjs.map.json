{"file":"login.vue.mjs","mappings":"y7BAoHA,MAAMA,EAAYC,EAAI,CACpB,MAAO,uBACP,SAAU,UACZ,CAAC,EAEKC,EAAeD,EAAI,EAAK,EAGxB,CAAE,KAAAE,EAAa,QAAAC,EAAS,MAAAC,CAAK,EAAKC,EAAO,EAGzCC,EAAwBN,EAAI,EAAK,EAgCvC,OAAAO,EAAY,IAAM,CAEZD,EAAsB,OAASJ,EAAK,OAASA,EAAK,MAAM,MAAQ,CAAC,QAAS,cAAe,WAAW,EAAE,SAASA,EAAK,MAAM,IAAI,IAChI,QAAQ,IAAI,mEAAmE,EAC/EM,EAAW,kBAAkB,EAEjC,CAAC,EAaDC,EAAQ,CACN,MAAO,mCACP,KAAM,CACJ,CAAE,KAAM,cAAe,QAAS,mCAAqC,EACrE,CAAE,KAAM,SAAU,QAAS,mBAAmB,CAClD,CACA,CAAC","names":["loginForm","ref","showPassword","user","loading","error","useAuth","hasCheckedInitialAuth","watchEffect","navigateTo","useHead"],"sources":["../../../../../pages/admin/login.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4 relative overflow-hidden\" dir=\"rtl\">\n    <!-- خلفية متحركة -->\n    <div class=\"absolute inset-0 overflow-hidden\">\n      <div class=\"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob\"></div>\n      <div class=\"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-2000\"></div>\n      <div class=\"absolute top-40 left-40 w-80 h-80 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-4000\"></div>\n    </div>\n\n    <div class=\"max-w-md w-full space-y-8 relative z-10\">\n      <div class=\"bg-white/10 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/20\">\n        <!-- شعار الموقع -->\n        <div class=\"text-center mb-8\">\n          <div class=\"mx-auto h-24 w-24 bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 rounded-2xl flex items-center justify-center mb-6 shadow-lg\">\n            <Icon name=\"material-symbols:admin-panel-settings\" class=\"h-12 w-12 text-white\" />\n          </div>\n          <h2 class=\"text-3xl font-bold text-white mb-3 bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent\">\n            لوحة تحكم الإدارة\n          </h2>\n          <p class=\"text-gray-300 text-lg\">\n            تسجيل الدخول للوصول إلى لوحة التحكم\n          </p>\n        </div>\n\n        <!-- نموذج تسجيل الدخول -->\n        <form @submit.prevent=\"handleLogin\" class=\"space-y-6\">\n          <div>\n            <label for=\"email\" class=\"block text-sm font-medium text-white mb-3\">\n              البريد الإلكتروني\n            </label>\n            <div class=\"relative group\">\n              <input\n                id=\"email\"\n                v-model=\"loginForm.email\"\n                type=\"email\"\n                required\n                class=\"w-full px-4 py-4 bg-white/10 border border-white/20 rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent transition-all duration-300 pr-12 text-white placeholder-gray-300 backdrop-blur-sm\"\n                placeholder=\"أدخل البريد الإلكتروني\"\n                :disabled=\"loading\"\n              />\n              <Icon name=\"material-symbols:mail-outline\" class=\"absolute right-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-300 group-focus-within:text-purple-400 transition-colors\" />\n            </div>\n          </div>\n\n          <div>\n            <label for=\"password\" class=\"block text-sm font-medium text-white mb-3\">\n              كلمة المرور\n            </label>\n            <div class=\"relative group\">\n              <input\n                id=\"password\"\n                v-model=\"loginForm.password\"\n                :type=\"showPassword ? 'text' : 'password'\"\n                required\n                class=\"w-full px-4 py-4 bg-white/10 border border-white/20 rounded-xl focus:ring-2 focus:ring-purple-400 focus:border-transparent transition-all duration-300 pr-12 pl-12 text-white placeholder-gray-300 backdrop-blur-sm\"\n                placeholder=\"أدخل كلمة المرور\"\n                :disabled=\"loading\"\n              />\n              <Icon name=\"material-symbols:lock-outline\" class=\"absolute right-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-300 group-focus-within:text-purple-400 transition-colors\" />\n              <button\n                type=\"button\"\n                @click=\"showPassword = !showPassword\"\n                class=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-300 hover:text-white transition-colors\"\n                :disabled=\"loading\"\n              >\n                <Icon :name=\"showPassword ? 'material-symbols:visibility-off' : 'material-symbols:visibility'\" class=\"h-5 w-5\" />\n              </button>\n            </div>\n          </div>\n\n          <!-- رسائل الخطأ -->\n          <div v-if=\"error\" class=\"bg-red-500/20 border border-red-500/30 rounded-xl p-4 backdrop-blur-sm\">\n            <div class=\"flex items-center\">\n              <Icon name=\"material-symbols:error-outline\" class=\"h-5 w-5 text-red-300 ml-2\" />\n              <p class=\"text-sm text-red-200\">{{ error }}</p>\n            </div>\n          </div>\n\n          <!-- زر تسجيل الدخول -->\n          <button\n            type=\"submit\"\n            :disabled=\"loading\"\n            class=\"w-full bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-white py-4 px-6 rounded-xl font-semibold hover:from-purple-600 hover:via-pink-600 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-400 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-lg hover:shadow-xl transform hover:scale-[1.02]\"\n          >\n            <Icon v-if=\"loading\" name=\"material-symbols:progress-activity\" class=\"animate-spin h-5 w-5 ml-2\" />\n            <span class=\"text-lg\">{{ loading ? 'جارٍ تسجيل الدخول...' : 'تسجيل الدخول' }}</span>\n          </button>\n        </form>\n\n        <!-- روابط إضافية -->\n        <div class=\"mt-8 text-center\">\n          <NuxtLink to=\"/\" class=\"inline-flex items-center text-sm text-white/80 hover:text-white transition-colors group\">\n            <Icon name=\"material-symbols:arrow-back\" class=\"h-4 w-4 ml-2 group-hover:transform group-hover:-translate-x-1 transition-transform\" />\n            العودة إلى الموقع الرئيسي\n          </NuxtLink>\n        </div>\n      </div>\n\n      <!-- معلومات إضافية -->\n      <div class=\"text-center\">\n        <p class=\"text-sm text-white/60\">\n          © 2025 Wonder Land Traveling Agency\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\n// إعداد الصفحة\ndefinePageMeta({\n  layout: false,\n  title: 'تسجيل دخول الإدارة'\n})\n\n// المتغيرات التفاعلية\nconst loginForm = ref({\n  email: 'admin@wonderland.com', // Default admin email\n  password: 'admin123' // Default admin password\n})\n\nconst showPassword = ref(false)\n\n// Authentication\nconst { user, login, loading, error } = useAuth()\n\n// التحقق من تسجيل الدخول المسبق\nconst hasCheckedInitialAuth = ref(false)\n\nonMounted(async () => {\n  // Check if there's a token cookie first to avoid unnecessary API calls\n  const tokenCookie = useCookie('auth-token')\n  \n  if (tokenCookie.value) {\n    // Only check auth if there's a token\n    const { checkAuth } = useAuth()\n    try {\n      const currentUser = await checkAuth(true) // Use silent mode to reduce console noise\n      if (currentUser && currentUser.role && ['admin', 'super_admin', 'moderator'].includes(currentUser.role)) {\n        // Only redirect if user is actually an admin\n        console.log('User is already authenticated as admin, redirecting to dashboard')\n        await navigateTo('/admin/dashboard')\n        return // Exit early to prevent further processing\n      }\n    } catch (error) {\n      // User is not authenticated, stay on login page\n      console.log('User not authenticated, staying on login page')\n    }\n  } else {\n    // No token, user is definitely not authenticated\n    console.log('No auth token found, staying on login page')\n  }\n  \n  // Mark that we've checked initial auth after a short delay\n  setTimeout(() => {\n    hasCheckedInitialAuth.value = true\n  }, 500)\n})\n\nwatchEffect(() => {\n  // Only redirect if user state changes after initial auth check\n  if (hasCheckedInitialAuth.value && user.value && user.value.role && ['admin', 'super_admin', 'moderator'].includes(user.value.role)) {\n    console.log('User state changed to admin after login, redirecting to dashboard')\n    navigateTo('/admin/dashboard')\n  }\n})\n\n// دالة تسجيل الدخول\nconst handleLogin = async () => {\n  const result = await login(loginForm.value.email, loginForm.value.password)\n  \n  if (result.success) {\n    await navigateTo('/admin/dashboard')\n  }\n  // Error handling is done in the composable\n}\n\n// SEO والميتا\nuseHead({\n  title: 'تسجيل دخول الإدارة - Wonder Land',\n  meta: [\n    { name: 'description', content: 'صفحة تسجيل دخول لوحة تحكم الإدارة' },\n    { name: 'robots', content: 'noindex, nofollow' }\n  ]\n})\n</script>\n\n<style scoped>\n/* تحسينات إضافية للتصميم */\n.bg-gradient-to-br {\n  background-image: linear-gradient(to bottom right, var(--tw-gradient-stops));\n}\n\ninput:focus {\n  box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.2);\n}\n\nbutton:focus {\n  box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.2);\n}\n\n/* أنيميشن الخلفية المتحركة */\n@keyframes blob {\n  0% {\n    transform: translate(0px, 0px) scale(1);\n  }\n  33% {\n    transform: translate(30px, -50px) scale(1.1);\n  }\n  66% {\n    transform: translate(-20px, 20px) scale(0.9);\n  }\n  100% {\n    transform: translate(0px, 0px) scale(1);\n  }\n}\n\n.animate-blob {\n  animation: blob 7s infinite;\n}\n\n.animation-delay-2000 {\n  animation-delay: 2s;\n}\n\n.animation-delay-4000 {\n  animation-delay: 4s;\n}\n\n/* تأثيرات إضافية */\n.group:hover .group-hover\\:transform {\n  transform: translateX(-4px);\n}\n\n/* تحسين النص الشفاف */\n.bg-clip-text {\n  -webkit-background-clip: text;\n  background-clip: text;\n}\n</style>\n"],"version":3}