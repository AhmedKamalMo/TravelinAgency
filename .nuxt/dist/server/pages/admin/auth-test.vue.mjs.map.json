{"file":"auth-test.vue.mjs","mappings":"guBAsIM,KAAA,CAAE,KAAAA,EAAM,QAAAC,EAAS,MAAAC,EAAuC,QAAAC,CAAQ,EAAIC,EAAQ,EAC5EC,EAAcC,EAAI,EAAE,EACpBC,EAAcD,EAAI,EAAE,EACpBE,EAAWF,EAAI,EAAK,EA+ElB,OAAAG,EAAA,CACN,MAAO,sCACP,KAAM,CACJ,CAAE,KAAM,cAAe,QAAS,0CAA2C,EAC3E,CAAE,KAAM,SAAU,QAAS,mBAAoB,CAAA,CACjD,CACD","names":["user","loading","error","isAdmin","useAuth","testResults","ref","currentTime","hasToken","useHead"],"sources":["../../../../../pages/admin/auth-test.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gray-50 p-8\" dir=\"rtl\">\r\n    <div class=\"max-w-4xl mx-auto\">\r\n      <div class=\"bg-white rounded-xl shadow-lg p-8\">\r\n        <h1 class=\"text-3xl font-bold text-gray-900 mb-8\">اختبار تدفق المصادقة</h1>\r\n        \r\n        <!-- حالة المصادقة الحالية -->\r\n        <div class=\"mb-8\">\r\n          <h2 class=\"text-xl font-semibold mb-4\">حالة المصادقة الحالية</h2>\r\n          <div class=\"bg-gray-100 rounded-lg p-4\">\r\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <span class=\"font-medium\">المستخدم مسجل:</span>\r\n                <span :class=\"user ? 'text-green-600' : 'text-red-600'\" class=\"mr-2\">\r\n                  {{ user ? 'نعم' : 'لا' }}\r\n                </span>\r\n              </div>\r\n              <div>\r\n                <span class=\"font-medium\">صلاحيات الإدارة:</span>\r\n                <span :class=\"isAdmin ? 'text-green-600' : 'text-red-600'\" class=\"mr-2\">\r\n                  {{ isAdmin ? 'نعم' : 'لا' }}\r\n                </span>\r\n              </div>\r\n              <div v-if=\"user\">\r\n                <span class=\"font-medium\">البريد الإلكتروني:</span>\r\n                <span class=\"mr-2\">{{ user.email }}</span>\r\n              </div>\r\n              <div v-if=\"user\">\r\n                <span class=\"font-medium\">الدور:</span>\r\n                <span class=\"mr-2\">{{ user.role }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- أزرار الاختبار -->\r\n        <div class=\"mb-8\">\r\n          <h2 class=\"text-xl font-semibold mb-4\">اختبارات المصادقة</h2>\r\n          <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <button\r\n              @click=\"testCheckAuth\"\r\n              :disabled=\"loading\"\r\n              class=\"bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50\"\r\n            >\r\n              اختبار التحقق من المصادقة\r\n            </button>\r\n            \r\n            <button\r\n              @click=\"testRefreshUser\"\r\n              :disabled=\"loading\"\r\n              class=\"bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50\"\r\n            >\r\n              تحديث بيانات المستخدم\r\n            </button>\r\n            \r\n            <button\r\n              @click=\"testLogout\"\r\n              :disabled=\"loading\"\r\n              class=\"bg-red-500 text-white px-6 py-3 rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50\"\r\n            >\r\n              تسجيل الخروج\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- نتائج الاختبار -->\r\n        <div class=\"mb-8\">\r\n          <h2 class=\"text-xl font-semibold mb-4\">نتائج الاختبار</h2>\r\n          <div class=\"bg-gray-100 rounded-lg p-4\">\r\n            <pre class=\"text-sm text-gray-700 whitespace-pre-wrap\">{{ testResults }}</pre>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- معلومات إضافية -->\r\n        <div class=\"mb-8\">\r\n          <h2 class=\"text-xl font-semibold mb-4\">معلومات إضافية</h2>\r\n          <div class=\"bg-gray-100 rounded-lg p-4\">\r\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <span class=\"font-medium\">Cookie موجود:</span>\r\n                <span class=\"mr-2\">{{ hasToken ? 'نعم' : 'لا' }}</span>\r\n              </div>\r\n              <div>\r\n                <span class=\"font-medium\">حالة التحميل:</span>\r\n                <span class=\"mr-2\">{{ loading ? 'جاري التحميل...' : 'مكتمل' }}</span>\r\n              </div>\r\n              <div>\r\n                <span class=\"font-medium\">الخطأ:</span>\r\n                <span class=\"mr-2\">{{ error || 'لا يوجد' }}</span>\r\n              </div>\r\n              <div>\r\n                <span class=\"font-medium\">الوقت الحالي:</span>\r\n                <span class=\"mr-2\">{{ currentTime }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- روابط سريعة -->\r\n        <div class=\"flex flex-wrap gap-4\">\r\n          <NuxtLink\r\n            to=\"/admin/dashboard\"\r\n            class=\"bg-indigo-500 text-white px-6 py-3 rounded-lg hover:bg-indigo-600 transition-colors\"\r\n          >\r\n            الذهاب إلى الداشبورد\r\n          </NuxtLink>\r\n          \r\n          <NuxtLink\r\n            to=\"/admin/login\"\r\n            class=\"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors\"\r\n          >\r\n            صفحة تسجيل الدخول\r\n          </NuxtLink>\r\n          \r\n          <button\r\n            @click=\"refreshPage\"\r\n            class=\"bg-yellow-500 text-white px-6 py-3 rounded-lg hover:bg-yellow-600 transition-colors\"\r\n          >\r\n            تحديث الصفحة\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n// إعداد الصفحة\r\ndefinePageMeta({\r\n  layout: 'admin',\r\n  middleware: 'admin'\r\n})\r\n\r\n// المتغيرات التفاعلية\r\nconst { user, loading, error, checkAuth, refreshUser, logout, isAdmin } = useAuth()\r\nconst testResults = ref('')\r\nconst currentTime = ref('')\r\nconst hasToken = ref(false)\r\n\r\n// تحديث الوقت\r\nconst updateTime = () => {\r\n  currentTime.value = new Date().toLocaleString('ar-SA')\r\n}\r\n\r\n// تحديث حالة الـ cookie\r\nconst updateTokenStatus = () => {\r\n  const tokenCookie = useCookie('auth-token')\r\n  hasToken.value = !!tokenCookie.value\r\n}\r\n\r\n// اختبار التحقق من المصادقة\r\nconst testCheckAuth = async () => {\r\n  testResults.value = 'جاري اختبار التحقق من المصادقة...\\n'\r\n  try {\r\n    const result = await checkAuth(true)\r\n    testResults.value += `النتيجة: ${result ? 'نجح' : 'فشل'}\\n`\r\n    if (result) {\r\n      testResults.value += `المستخدم: ${result.email}\\n`\r\n      testResults.value += `الدور: ${result.role}\\n`\r\n    }\r\n  } catch (error) {\r\n    testResults.value += `خطأ: ${error.message}\\n`\r\n  }\r\n  updateTokenStatus()\r\n}\r\n\r\n// اختبار تحديث بيانات المستخدم\r\nconst testRefreshUser = async () => {\r\n  testResults.value = 'جاري اختبار تحديث بيانات المستخدم...\\n'\r\n  try {\r\n    const result = await refreshUser()\r\n    testResults.value += `النتيجة: ${result ? 'نجح' : 'فشل'}\\n`\r\n    if (result) {\r\n      testResults.value += `المستخدم: ${result.email}\\n`\r\n      testResults.value += `الدور: ${result.role}\\n`\r\n    }\r\n  } catch (error) {\r\n    testResults.value += `خطأ: ${error.message}\\n`\r\n  }\r\n  updateTokenStatus()\r\n}\r\n\r\n// اختبار تسجيل الخروج\r\nconst testLogout = async () => {\r\n  testResults.value = 'جاري اختبار تسجيل الخروج...\\n'\r\n  try {\r\n    await logout()\r\n    testResults.value += 'تم تسجيل الخروج بنجاح\\n'\r\n  } catch (error) {\r\n    testResults.value += `خطأ: ${error.message}\\n`\r\n  }\r\n  updateTokenStatus()\r\n}\r\n\r\n// تحديث الصفحة\r\nconst refreshPage = () => {\r\n  window.location.reload()\r\n}\r\n\r\n// تحديث البيانات عند التحميل\r\nonMounted(() => {\r\n  updateTime()\r\n  updateTokenStatus()\r\n  \r\n  // تحديث الوقت كل ثانية\r\n  setInterval(updateTime, 1000)\r\n  \r\n  // تحديث حالة الـ cookie كل 5 ثوان\r\n  setInterval(updateTokenStatus, 5000)\r\n  \r\n  testResults.value = 'تم تحميل صفحة اختبار المصادقة\\n'\r\n  testResults.value += `الوقت: ${currentTime.value}\\n`\r\n  testResults.value += `Cookie موجود: ${hasToken.value ? 'نعم' : 'لا'}\\n`\r\n})\r\n\r\n// SEO\r\nuseHead({\r\n  title: 'اختبار المصادقة - Wonder Land Admin',\r\n  meta: [\r\n    { name: 'description', content: 'صفحة اختبار تدفق المصادقة في لوحة التحكم' },\r\n    { name: 'robots', content: 'noindex, nofollow' }\r\n  ]\r\n})\r\n</script>\r\n\r\n<style scoped>\r\npre {\r\n  font-family: 'Courier New', monospace;\r\n  direction: ltr;\r\n  text-align: left;\r\n}\r\n</style>\r\n"],"version":3}