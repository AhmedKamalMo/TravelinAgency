{"file":"index.vue.mjs","mappings":"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","names":["itemsPerPage","pages","ref","loading","searchQuery","statusFilter","typeFilter","currentPage","filteredPages","computed","filtered","page","totalItems","totalPages","totalPagesCount","publishedPages","draftPages","todayPages","today","contentStats","typeCounts","acc","type","getTypeName","statusCounts","status","getStatusName","monthlyCounts","months","month","monthIndex","formatDate","dateString","truncateText","text","length","getTypeColor","getStatusColor","watch","useHead"],"sources":["../../../../../../pages/admin/content/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"space-y-6\">\r\n    <!-- مساحة إضافية في الأعلى -->\r\n    <div class=\"h-16\"></div>\r\n    \r\n    <!-- رأس الصفحة -->\r\n    <AdminPageHeader \r\n      title=\"إدارة المحتوى\"\r\n      description=\"إدارة صفحات الموقع والمحتوى\"\r\n    >\r\n      <template #actions>\r\n        <NuxtLink\r\n          to=\"/admin/content/analytics\"\r\n          class=\"inline-flex items-center px-3 sm:px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm\"\r\n        >\r\n          <Icon name=\"material-symbols:analytics\" class=\"h-4 w-4 sm:h-5 sm:w-5 ml-2\" />\r\n          <span class=\"hidden sm:inline\">الإحصائيات</span>\r\n          <span class=\"sm:hidden\">إحصائيات</span>\r\n        </NuxtLink>\r\n        <NuxtLink\r\n          to=\"/admin/content/templates\"\r\n          class=\"inline-flex items-center px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm\"\r\n        >\r\n          <Icon name=\"material-symbols:widgets\" class=\"h-4 w-4 sm:h-5 sm:w-5 ml-2\" />\r\n          <span class=\"hidden sm:inline\">القوالب</span>\r\n          <span class=\"sm:hidden\">قوالب</span>\r\n        </NuxtLink>\r\n        <NuxtLink\r\n          to=\"/admin/content/editor\"\r\n          class=\"inline-flex items-center px-3 sm:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm\"\r\n        >\r\n          <Icon name=\"material-symbols:edit\" class=\"h-4 w-4 sm:h-5 sm:w-5 ml-2\" />\r\n          <span class=\"hidden sm:inline\">محرر المحتوى</span>\r\n          <span class=\"sm:hidden\">محرر</span>\r\n        </NuxtLink>\r\n        <NuxtLink\r\n          to=\"/admin/content/create\"\r\n          class=\"inline-flex items-center px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm\"\r\n        >\r\n          <Icon name=\"material-symbols:add\" class=\"h-4 w-4 sm:h-5 sm:w-5 ml-2\" />\r\n          <span class=\"hidden sm:inline\">إضافة صفحة جديدة</span>\r\n          <span class=\"sm:hidden\">إضافة</span>\r\n        </NuxtLink>\r\n      </template>\r\n    </AdminPageHeader>\r\n\r\n    <!-- إحصائيات سريعة -->\r\n    <AdminStats :stats=\"contentStats\" />\r\n\r\n\r\n\r\n\r\n\r\n\r\n    <!-- شريط البحث والتصفية -->\r\n    <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\r\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <!-- البحث -->\r\n        <div class=\"relative\">\r\n          <Icon name=\"material-symbols:search\" class=\"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\r\n          <input\r\n            v-model=\"searchQuery\"\r\n            type=\"text\"\r\n            placeholder=\"البحث في الصفحات...\"\r\n            class=\"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n          />\r\n        </div>\r\n\r\n        <!-- تصفية حسب الحالة -->\r\n        <select\r\n          v-model=\"statusFilter\"\r\n          class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n        >\r\n          <option value=\"\">جميع الحالات</option>\r\n          <option value=\"published\">منشور</option>\r\n          <option value=\"draft\">مسودة</option>\r\n          <option value=\"archived\">مؤرشف</option>\r\n        </select>\r\n\r\n        <!-- تصفية حسب النوع -->\r\n        <select\r\n          v-model=\"typeFilter\"\r\n          class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n        >\r\n          <option value=\"\">جميع الأنواع</option>\r\n          <option value=\"page\">صفحة</option>\r\n          <option value=\"post\">مقال</option>\r\n          <option value=\"news\">أخبار</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- قائمة الصفحات -->\r\n    <div class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\r\n      <!-- حالة التحميل -->\r\n      <div v-if=\"loading\" class=\"flex justify-center items-center py-12\">\r\n        <Icon name=\"material-symbols:progress-activity\" class=\"animate-spin h-8 w-8 text-blue-600\" />\r\n        <span class=\"mr-3 text-gray-600\">جارٍ تحميل الصفحات...</span>\r\n      </div>\r\n\r\n      <!-- قائمة الصفحات -->\r\n      <div v-else-if=\"filteredPages.length > 0\" class=\"overflow-x-auto\">\r\n        <table class=\"min-w-full divide-y divide-gray-200\">\r\n          <thead class=\"bg-gray-50\">\r\n            <tr>\r\n              <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                الصفحة\r\n              </th>\r\n              <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                النوع\r\n              </th>\r\n              <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                الحالة\r\n              </th>\r\n              <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                تاريخ الإنشاء\r\n              </th>\r\n              <th class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                الإجراءات\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody class=\"bg-white divide-y divide-gray-200\">\r\n            <tr v-for=\"page in filteredPages\" :key=\"page.id\" class=\"hover:bg-gray-50\">\r\n              <!-- معلومات الصفحة -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <div class=\"flex items-center\">\r\n                  <div class=\"flex-shrink-0 h-10 w-10\">\r\n                    <div class=\"h-10 w-10 rounded-lg bg-gray-300 flex items-center justify-center\">\r\n                      <Icon name=\"material-symbols:article\" class=\"h-6 w-6 text-gray-600\" />\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"mr-4\">\r\n                    <div class=\"text-sm font-medium text-gray-900\">{{ page.title_ar || page.title_en || page.title }}</div>\r\n                    <div class=\"text-sm text-gray-500\">{{ truncateText(page.content_ar || page.content_en || page.content, 50) }}</div>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n\r\n              <!-- النوع -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <span :class=\"getTypeColor(page.type)\" class=\"px-2 py-1 text-xs font-medium rounded-full\">\r\n                  {{ getTypeName(page.type) }}\r\n                </span>\r\n              </td>\r\n\r\n              <!-- الحالة -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <span :class=\"getStatusColor(page.status)\" class=\"px-2 py-1 text-xs font-medium rounded-full\">\r\n                  {{ getStatusName(page.status) }}\r\n                </span>\r\n              </td>\r\n\r\n              <!-- تاريخ الإنشاء -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                {{ formatDate(page.created_at) }}\r\n              </td>\r\n\r\n              <!-- الإجراءات -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                <div class=\"flex items-center space-x-2 space-x-reverse\">\r\n                  <NuxtLink\r\n                    :to=\"`/admin/content/preview/${page.id}`\"\r\n                    class=\"text-blue-600 hover:text-blue-900 p-1 rounded\"\r\n                    title=\"معاينة\"\r\n                  >\r\n                    <Icon name=\"material-symbols:visibility\" class=\"h-4 w-4\" />\r\n                  </NuxtLink>\r\n                  <NuxtLink\r\n                    :to=\"`/admin/content/editor?page=${page.id}`\"\r\n                    class=\"text-purple-600 hover:text-purple-900 p-1 rounded\"\r\n                    title=\"تحرير متقدم\"\r\n                  >\r\n                    <Icon name=\"material-symbols:design-services\" class=\"h-4 w-4\" />\r\n                  </NuxtLink>\r\n                  <NuxtLink\r\n                    :to=\"`/admin/content/${page.id}/edit`\"\r\n                    class=\"text-green-600 hover:text-green-900 p-1 rounded\"\r\n                    title=\"تحرير\"\r\n                  >\r\n                    <Icon name=\"material-symbols:edit\" class=\"h-4 w-4\" />\r\n                  </NuxtLink>\r\n                  <button\r\n                    @click=\"togglePageStatus(page)\"\r\n                    :class=\"page.status === 'published' ? 'text-orange-600 hover:text-orange-900' : 'text-green-600 hover:text-green-900'\"\r\n                    class=\"p-1 rounded\"\r\n                    :title=\"page.status === 'published' ? 'إلغاء النشر' : 'نشر'\"\r\n                  >\r\n                    <Icon :name=\"page.status === 'published' ? 'material-symbols:visibility-off' : 'material-symbols:visibility'\" class=\"h-4 w-4\" />\r\n                  </button>\r\n                  <button\r\n                    @click=\"deletePage(page)\"\r\n                    class=\"text-red-600 hover:text-red-900 p-1 rounded\"\r\n                    title=\"حذف\"\r\n                  >\r\n                    <Icon name=\"material-symbols:delete\" class=\"h-4 w-4\" />\r\n                  </button>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <!-- حالة عدم وجود بيانات -->\r\n      <div v-else class=\"text-center py-12\">\r\n        <Icon name=\"material-symbols:article\" class=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\r\n        <h3 class=\"text-lg font-medium text-gray-900 mb-2\">لا توجد صفحات</h3>\r\n        <p class=\"text-gray-500 mb-6\">لم يتم العثور على أي صفحات</p>\r\n        <NuxtLink\r\n          to=\"/admin/content/create\"\r\n          class=\"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n        >\r\n          <Icon name=\"material-symbols:add\" class=\"h-5 w-5 ml-2\" />\r\n          إضافة صفحة جديدة\r\n        </NuxtLink>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- التصفح -->\r\n    <div v-if=\"totalPages > 1\" class=\"flex items-center justify-between\">\r\n      <div class=\"text-sm text-gray-700\">\r\n        عرض {{ (currentPage - 1) * itemsPerPage + 1 }} إلى {{ Math.min(currentPage * itemsPerPage, totalItems) }} من أصل {{ totalItems }} صفحة\r\n      </div>\r\n      <div class=\"flex space-x-1 space-x-reverse\">\r\n        <button\r\n          @click=\"currentPage = Math.max(1, currentPage - 1)\"\r\n          :disabled=\"currentPage === 1\"\r\n          class=\"px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        >\r\n          السابق\r\n        </button>\r\n        <span class=\"px-3 py-2 text-sm bg-blue-600 text-white border border-blue-600 rounded-md\">\r\n          {{ currentPage }}\r\n        </span>\r\n        <button\r\n          @click=\"currentPage = Math.min(totalPages, currentPage + 1)\"\r\n          :disabled=\"currentPage === totalPages\"\r\n          class=\"px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        >\r\n          التالي\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { PieChart, DoughnutChart, BarChart } from '~/components/charts'\r\n\r\n// إعداد الصفحة\r\ndefinePageMeta({\r\n  layout: 'admin',\r\n  middleware: 'admin'\r\n})\r\n\r\n// المتغيرات التفاعلية\r\nconst pages = ref([])\r\nconst loading = ref(true)\r\nconst searchQuery = ref('')\r\nconst statusFilter = ref('')\r\nconst typeFilter = ref('')\r\nconst currentPage = ref(1)\r\nconst itemsPerPage = 10\r\n\r\n// المتغيرات المحسوبة\r\nconst filteredPages = computed(() => {\r\n  let filtered = pages.value\r\n\r\n  // تصفية البحث\r\n  if (searchQuery.value) {\r\n    filtered = filtered.filter(page => \r\n      (page.title_ar && page.title_ar.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.title_en && page.title_en.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.title && page.title.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.content_ar && page.content_ar.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.content_en && page.content_en.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.content && page.content.toLowerCase().includes(searchQuery.value.toLowerCase()))\r\n    )\r\n  }\r\n\r\n  // تصفية الحالة\r\n  if (statusFilter.value) {\r\n    filtered = filtered.filter(page => page.status === statusFilter.value)\r\n  }\r\n\r\n  // تصفية النوع\r\n  if (typeFilter.value) {\r\n    filtered = filtered.filter(page => page.type === typeFilter.value)\r\n  }\r\n\r\n  return filtered.slice((currentPage.value - 1) * itemsPerPage, currentPage.value * itemsPerPage)\r\n})\r\n\r\nconst totalItems = computed(() => {\r\n  let filtered = pages.value\r\n\r\n  if (searchQuery.value) {\r\n    filtered = filtered.filter(page => \r\n      (page.title_ar && page.title_ar.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.title_en && page.title_en.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.title && page.title.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.content_ar && page.content_ar.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.content_en && page.content_en.toLowerCase().includes(searchQuery.value.toLowerCase())) ||\r\n      (page.content && page.content.toLowerCase().includes(searchQuery.value.toLowerCase()))\r\n    )\r\n  }\r\n\r\n  if (statusFilter.value) {\r\n    filtered = filtered.filter(page => page.status === statusFilter.value)\r\n  }\r\n\r\n  if (typeFilter.value) {\r\n    filtered = filtered.filter(page => page.type === typeFilter.value)\r\n  }\r\n\r\n  return filtered.length\r\n})\r\n\r\nconst totalPages = computed(() => Math.ceil(totalItems.value / itemsPerPage))\r\n\r\n// إحصائيات\r\nconst totalPagesCount = computed(() => pages.value.length)\r\nconst publishedPages = computed(() => pages.value.filter(page => page.status === 'published').length)\r\nconst draftPages = computed(() => pages.value.filter(page => page.status === 'draft').length)\r\nconst todayPages = computed(() => {\r\n  const today = new Date()\r\n  today.setHours(0, 0, 0, 0)\r\n  return pages.value.filter(page => new Date(page.created_at) >= today).length\r\n})\r\n\r\n// إحصائيات المحتوى\r\nconst contentStats = computed(() => [\r\n  {\r\n    key: 'total',\r\n    label: 'إجمالي الصفحات',\r\n    value: totalPagesCount.value,\r\n    icon: 'material-symbols:article',\r\n    iconBg: 'bg-blue-100',\r\n    iconColor: 'text-blue-600'\r\n  },\r\n  {\r\n    key: 'published',\r\n    label: 'منشور',\r\n    value: publishedPages.value,\r\n    icon: 'material-symbols:visibility',\r\n    iconBg: 'bg-green-100',\r\n    iconColor: 'text-green-600'\r\n  },\r\n  {\r\n    key: 'draft',\r\n    label: 'مسودة',\r\n    value: draftPages.value,\r\n    icon: 'material-symbols:edit',\r\n    iconBg: 'bg-orange-100',\r\n    iconColor: 'text-orange-600'\r\n  },\r\n  {\r\n    key: 'today',\r\n    label: 'اليوم',\r\n    value: todayPages.value,\r\n    icon: 'material-symbols:today',\r\n    iconBg: 'bg-purple-100',\r\n    iconColor: 'text-purple-600'\r\n  }\r\n])\r\n\r\n// بيانات الرسوم البيانية للمحتوى\r\nconst contentTypeData = computed(() => {\r\n  const typeCounts = pages.value.reduce((acc, page) => {\r\n    acc[page.type] = (acc[page.type] || 0) + 1\r\n    return acc\r\n  }, {})\r\n\r\n  return {\r\n    labels: Object.keys(typeCounts).map(type => getTypeName(type)),\r\n    datasets: [{\r\n      data: Object.values(typeCounts),\r\n      backgroundColor: [\r\n        'rgba(59, 130, 246, 0.8)',\r\n        'rgba(16, 185, 129, 0.8)',\r\n        'rgba(245, 158, 11, 0.8)',\r\n        'rgba(239, 68, 68, 0.8)'\r\n      ],\r\n      borderColor: [\r\n        'rgb(59, 130, 246)',\r\n        'rgb(16, 185, 129)',\r\n        'rgb(245, 158, 11)',\r\n        'rgb(239, 68, 68)'\r\n      ]\r\n    }]\r\n  }\r\n})\r\n\r\nconst contentStatusData = computed(() => {\r\n  const statusCounts = pages.value.reduce((acc, page) => {\r\n    acc[page.status] = (acc[page.status] || 0) + 1\r\n    return acc\r\n  }, {})\r\n\r\n  return {\r\n    labels: Object.keys(statusCounts).map(status => getStatusName(status)),\r\n    datasets: [{\r\n      data: Object.values(statusCounts),\r\n      backgroundColor: [\r\n        'rgba(34, 197, 94, 0.8)',\r\n        'rgba(245, 158, 11, 0.8)',\r\n        'rgba(107, 114, 128, 0.8)'\r\n      ],\r\n      borderColor: [\r\n        'rgb(34, 197, 94)',\r\n        'rgb(245, 158, 11)',\r\n        'rgb(107, 114, 128)'\r\n      ]\r\n    }]\r\n  }\r\n})\r\n\r\nconst monthlyPublishingData = computed(() => {\r\n  const monthlyCounts = {}\r\n  const months = ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو']\r\n  \r\n  // تهيئة العدادات\r\n  months.forEach(month => {\r\n    monthlyCounts[month] = 0\r\n  })\r\n\r\n  // حساب عدد الصفحات المنشورة في كل شهر\r\n  pages.value.forEach(page => {\r\n    if (page.status === 'published') {\r\n      const date = new Date(page.created_at)\r\n      const monthIndex = date.getMonth()\r\n      if (monthIndex < 6) { // آخر 6 أشهر\r\n        monthlyCounts[months[monthIndex]]++\r\n      }\r\n    }\r\n  })\r\n\r\n  return {\r\n    labels: months,\r\n    datasets: [{\r\n      label: 'عدد الصفحات المنشورة',\r\n      data: Object.values(monthlyCounts),\r\n      backgroundColor: 'rgba(139, 92, 246, 0.8)',\r\n      borderColor: 'rgb(139, 92, 246)',\r\n      borderWidth: 1\r\n    }]\r\n  }\r\n})\r\n\r\n// إعدادات الرسوم البيانية\r\nconst contentTypeOptions = ref({\r\n  plugins: {\r\n    legend: {\r\n      position: 'bottom',\r\n      labels: {\r\n        padding: 15,\r\n        usePointStyle: true\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nconst contentStatusOptions = ref({\r\n  plugins: {\r\n    legend: {\r\n      position: 'bottom',\r\n      labels: {\r\n        padding: 15,\r\n        usePointStyle: true\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nconst monthlyPublishingOptions = ref({\r\n  plugins: {\r\n    legend: {\r\n      display: false\r\n    }\r\n  },\r\n  scales: {\r\n    y: {\r\n      beginAtZero: true,\r\n      ticks: {\r\n        stepSize: 1\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\n// تحميل الصفحات\r\nconst loadPages = async () => {\r\n  try {\r\n    loading.value = true\r\n    console.log('🔄 Loading pages from API...')\r\n    const result = await $fetch('/api/content')\r\n    console.log('📊 API Response:', result)\r\n    \r\n    // Ensure pages.value is always an array\r\n    if (result && result.pages && Array.isArray(result.pages)) {\r\n      pages.value = result.pages\r\n      console.log('✅ Loaded pages:', pages.value.length)\r\n    } else if (Array.isArray(result)) {\r\n      pages.value = result\r\n      console.log('✅ Loaded pages (direct array):', pages.value.length)\r\n    } else {\r\n      pages.value = []\r\n      console.log('⚠️ No pages found, using empty array')\r\n    }\r\n  } catch (error) {\r\n    console.error('❌ خطأ في تحميل الصفحات:', error)\r\n    // بيانات وهمية للعرض\r\n    pages.value = [\r\n      {\r\n        id: 1,\r\n        title_ar: 'من نحن',\r\n        title_en: 'About Us',\r\n        content_ar: 'نحن وكالة سفر رائدة في المملكة العربية السعودية',\r\n        content_en: 'We are a leading travel agency in Saudi Arabia',\r\n        type: 'page',\r\n        status: 'published',\r\n        created_at: new Date().toISOString()\r\n      },\r\n      {\r\n        id: 2,\r\n        title_ar: 'أخبار السفر',\r\n        title_en: 'Travel News',\r\n        content_ar: 'أحدث أخبار السفر والسياحة',\r\n        content_en: 'Latest travel and tourism news',\r\n        type: 'news',\r\n        status: 'draft',\r\n        created_at: new Date(Date.now() - 86400000).toISOString()\r\n      }\r\n    ]\r\n    console.log('📝 Using fallback data:', pages.value.length, 'pages')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// تغيير حالة الصفحة\r\nconst togglePageStatus = async (page) => {\r\n  try {\r\n    const newStatus = page.status === 'published' ? 'draft' : 'published'\r\n    \r\n    // TODO: Add API endpoint for updating page status\r\n    const index = pages.value.findIndex(p => p.id === page.id)\r\n    if (index !== -1) {\r\n      pages.value[index].status = newStatus\r\n    }\r\n\r\n    console.log(`تم ${newStatus === 'published' ? 'نشر' : 'إلغاء نشر'} الصفحة بنجاح`)\r\n  } catch (error) {\r\n    console.error('خطأ في تغيير حالة الصفحة:', error)\r\n  }\r\n}\r\n\r\n// حذف الصفحة\r\nconst deletePage = async (page) => {\r\n  if (!confirm('هل أنت متأكد من حذف هذه الصفحة؟ لا يمكن التراجع عن هذا الإجراء.')) return\r\n\r\n  try {\r\n    await $fetch(`/api/content/${page.id}`, { method: 'DELETE' })\r\n    \r\n    // Remove from local list\r\n    pages.value = pages.value.filter(p => p.id !== page.id)\r\n    \r\n    console.log('تم حذف الصفحة بنجاح')\r\n  } catch (error) {\r\n    console.error('خطأ في حذف الصفحة:', error)\r\n  }\r\n}\r\n\r\n// دوال المساعدة\r\nconst formatDate = (dateString) => {\r\n  const date = new Date(dateString)\r\n  return date.toLocaleDateString('ar-SA')\r\n}\r\n\r\nconst truncateText = (text, length) => {\r\n  if (!text) return ''\r\n  return text.length > length ? text.substring(0, length) + '...' : text\r\n}\r\n\r\nconst getTypeName = (type) => {\r\n  const types = {\r\n    page: 'صفحة',\r\n    post: 'مقال',\r\n    news: 'أخبار'\r\n  }\r\n  return types[type] || type\r\n}\r\n\r\nconst getTypeColor = (type) => {\r\n  const colors = {\r\n    page: 'bg-blue-100 text-blue-800',\r\n    post: 'bg-green-100 text-green-800',\r\n    news: 'bg-purple-100 text-purple-800'\r\n  }\r\n  return colors[type] || 'bg-gray-100 text-gray-800'\r\n}\r\n\r\nconst getStatusName = (status) => {\r\n  const statuses = {\r\n    published: 'منشور',\r\n    draft: 'مسودة',\r\n    archived: 'مؤرشف'\r\n  }\r\n  return statuses[status] || status\r\n}\r\n\r\nconst getStatusColor = (status) => {\r\n  const colors = {\r\n    published: 'bg-green-100 text-green-800',\r\n    draft: 'bg-orange-100 text-orange-800',\r\n    archived: 'bg-gray-100 text-gray-800'\r\n  }\r\n  return colors[status] || 'bg-gray-100 text-gray-800'\r\n}\r\n\r\n// إعادة تعيين الصفحة عند تغيير الفلاتر\r\nwatch([searchQuery, statusFilter, typeFilter], () => {\r\n  currentPage.value = 1\r\n})\r\n\r\n// تحميل البيانات عند تحميل الصفحة\r\nonMounted(async () => {\r\n  // التأكد من أن المستخدم مصادق عليه قبل تحميل البيانات\r\n  const { checkAuth } = useAuth()\r\n  try {\r\n    await checkAuth(true)\r\n    await loadPages()\r\n  } catch (error) {\r\n    console.error('خطأ في تحميل بيانات المحتوى:', error)\r\n  }\r\n})\r\n\r\n// SEO والميتا\r\nuseHead({\r\n  title: 'إدارة المحتوى - Wonder Land Admin',\r\n  meta: [\r\n    { name: 'description', content: 'إدارة صفحات الموقع والمحتوى' },\r\n    { name: 'robots', content: 'noindex, nofollow' }\r\n  ]\r\n})\r\n</script>\r\n\r\n"],"version":3}