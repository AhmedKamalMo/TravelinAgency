{"version":3,"file":"edit.vue.mjs","sources":["../../../../../../../pages/admin/destinations/[id]/edit.vue"],"sourcesContent":["<template>\r\n  <div class=\"space-y-6\">\r\n    <!-- مساحة إضافية في الأعلى -->\r\n    <div class=\"h-16\"></div>\r\n    \r\n    <!-- رأس الصفحة -->\r\n    <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\r\n      <div>\r\n        <h1 class=\"text-2xl font-bold text-gray-900\">تحرير الوجهة</h1>\r\n        <p class=\"mt-1 text-sm text-gray-600\">تحرير معلومات الوجهة السياحية</p>\r\n      </div>\r\n      <div class=\"mt-4 sm:mt-0 flex space-x-3 space-x-reverse\">\r\n        <NuxtLink\r\n          :to=\"`/admin/destinations/${destinationId}`\"\r\n          class=\"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\r\n        >\r\n          <Icon name=\"material-symbols:visibility\" class=\"h-5 w-5 ml-2\" />\r\n          عرض\r\n        </NuxtLink>\r\n        <NuxtLink\r\n          to=\"/admin/destinations\"\r\n          class=\"inline-flex items-center px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors\"\r\n        >\r\n          <Icon name=\"material-symbols:arrow-back\" class=\"h-5 w-5 ml-2\" />\r\n          العودة للقائمة\r\n        </NuxtLink>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- حالة التحميل -->\r\n    <div v-if=\"loading\" class=\"flex justify-center items-center py-12\">\r\n      <Icon name=\"material-symbols:progress-activity\" class=\"animate-spin h-8 w-8 text-blue-600\" />\r\n      <span class=\"mr-3 text-gray-600\">جارٍ تحميل بيانات الوجهة...</span>\r\n    </div>\r\n\r\n    <!-- نموذج تحرير الوجهة -->\r\n    <div v-else-if=\"destination\" class=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\r\n      \r\n      <form @submit.prevent=\"updateDestination\" class=\"space-y-6\">\r\n        <!-- المعلومات الأساسية -->\r\n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          <!-- الاسم بالعربية -->\r\n          <div>\r\n            <label for=\"name_ar\" class=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              الاسم بالعربية *\r\n            </label>\r\n            <input\r\n              id=\"name_ar\"\r\n              v-model=\"form.name_ar\"\r\n              type=\"text\"\r\n              required\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n              placeholder=\"أدخل اسم الوجهة بالعربية\"\r\n            />\r\n          </div>\r\n\r\n          <!-- الاسم بالإنجليزية -->\r\n          <div>\r\n            <label for=\"name_en\" class=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              الاسم بالإنجليزية *\r\n            </label>\r\n            <input\r\n              id=\"name_en\"\r\n              v-model=\"form.name_en\"\r\n              type=\"text\"\r\n              required\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n              placeholder=\"Enter destination name in English\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- الوصف -->\r\n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          <!-- الوصف بالعربية -->\r\n          <div>\r\n            <label for=\"description_ar\" class=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              الوصف بالعربية *\r\n            </label>\r\n            <textarea\r\n              id=\"description_ar\"\r\n              v-model=\"form.description_ar\"\r\n              required\r\n              rows=\"4\"\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n              placeholder=\"أدخل وصف الوجهة بالعربية\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <!-- الوصف بالإنجليزية -->\r\n          <div>\r\n            <label for=\"description_en\" class=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              الوصف بالإنجليزية *\r\n            </label>\r\n            <textarea\r\n              id=\"description_en\"\r\n              v-model=\"form.description_en\"\r\n              required\r\n              rows=\"4\"\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n              placeholder=\"Enter destination description in English\"\r\n            ></textarea>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- معلومات إضافية -->\r\n        <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n          <!-- نوع الوجهة -->\r\n          <div>\r\n            <label for=\"category\" class=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              نوع الوجهة *\r\n            </label>\r\n            <select\r\n              id=\"category\"\r\n              v-model=\"form.category\"\r\n              required\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n            >\r\n              <option value=\"international\">عالمي</option>\r\n              <option value=\"saudi\">سعودي</option>\r\n            </select>\r\n          </div>\r\n\r\n                <!-- صورة الوجهة -->\r\n                <div class=\"md:col-span-2\">\r\n                  <label class=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    صورة الوجهة\r\n                  </label>\r\n                  <ImageUpload\r\n                    v-model=\"form.image_url\"\r\n                    alt=\"صورة الوجهة\"\r\n                    @upload-complete=\"handleImageUploadComplete\"\r\n                    @upload-error=\"handleImageUploadError\"\r\n                  />\r\n                  <p class=\"mt-2 text-xs text-gray-500\">\r\n                    يمكنك رفع صورة JPG, PNG, JPEG بحجم أقصى 5MB\r\n                  </p>\r\n                </div>\r\n\r\n          <!-- حالة الوجهة -->\r\n          <div>\r\n            <label for=\"active\" class=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              حالة الوجهة\r\n            </label>\r\n            <select\r\n              id=\"active\"\r\n              v-model=\"form.active\"\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n            >\r\n              <option :value=\"true\">نشط</option>\r\n              <option :value=\"false\">غير نشط</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- خيارات إضافية -->\r\n        <div class=\"flex items-center space-x-4 space-x-reverse\">\r\n          <label class=\"flex items-center\">\r\n            <input\r\n              v-model=\"form.featured\"\r\n              type=\"checkbox\"\r\n              class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n            />\r\n            <span class=\"mr-2 text-sm text-gray-700\">وجهة مميزة</span>\r\n          </label>\r\n        </div>\r\n\r\n        <!-- أزرار الإجراءات -->\r\n        <div class=\"flex items-center justify-end space-x-4 space-x-reverse pt-6 border-t border-gray-200\">\r\n          <NuxtLink\r\n            to=\"/admin/destinations\"\r\n            class=\"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\r\n          >\r\n            إلغاء\r\n          </NuxtLink>\r\n          <button\r\n            type=\"submit\"\r\n            :disabled=\"updateLoading\"\r\n            class=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n          >\r\n            <Icon v-if=\"updateLoading\" name=\"material-symbols:progress-activity\" class=\"animate-spin h-5 w-5 ml-2\" />\r\n            {{ updateLoading ? 'جاري الحفظ...' : 'حفظ التغييرات' }}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n\r\n    <!-- حالة عدم وجود الوجهة -->\r\n    <div v-else class=\"text-center py-12\">\r\n      <Icon name=\"material-symbols:place\" class=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\r\n      <h3 class=\"text-lg font-medium text-gray-900 mb-2\">الوجهة غير موجودة</h3>\r\n      <p class=\"text-gray-500 mb-6\">لم يتم العثور على الوجهة المطلوبة</p>\r\n      <NuxtLink\r\n        to=\"/admin/destinations\"\r\n        class=\"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n      >\r\n        العودة للقائمة\r\n      </NuxtLink>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n// Import components\r\nimport ImageUpload from '~/components/ui/ImageUpload.vue'\r\n\r\n\r\n// إعداد الصفحة\r\ndefinePageMeta({\r\n  layout: 'admin',\r\n  middleware: 'admin'\r\n})\r\n\r\n// الحصول على معرف الوجهة من الرابط\r\nconst route = useRoute()\r\nconst destinationId = route.params.id\r\n\r\n// المتغيرات التفاعلية\r\nconst loading = ref(true)\r\nconst updateLoading = ref(false)\r\nconst destination = ref(null)\r\nconst form = ref({\r\n  name_ar: '',\r\n  name_en: '',\r\n  description_ar: '',\r\n  description_en: '',\r\n  category: 'international',\r\n  image_url: '',\r\n  active: true,\r\n  featured: false\r\n})\r\n\r\n// تحميل بيانات الوجهة\r\nconst loadDestination = async () => {\r\n  const { showError } = useNotifications()\r\n  \r\n  try {\r\n    loading.value = true\r\n    const result = await $fetch(`/api/destinations/${destinationId}`)\r\n    \r\n    if (result.success && result.data) {\r\n      destination.value = result.data\r\n      \r\n      // ملء النموذج بالبيانات الموجودة\r\n      await nextTick()\r\n      form.value = {\r\n        name_ar: result.data.name_ar || '',\r\n        name_en: result.data.name_en || '',\r\n        description_ar: result.data.description_ar || '',\r\n        description_en: result.data.description_en || '',\r\n        category: result.data.category || 'international',\r\n        image_url: result.data.image_url || result.data.image || '',\r\n        active: result.data.active === 1 || result.data.active === true,\r\n        featured: result.data.featured === 1 || result.data.featured === true\r\n      }\r\n    } else {\r\n      destination.value = null\r\n    }\r\n  } catch (error) {\r\n    console.error('خطأ في تحميل بيانات الوجهة:', error)\r\n    destination.value = null\r\n    showError('خطأ في التحميل', 'حدث خطأ في تحميل بيانات الوجهة. يرجى المحاولة مرة أخرى.')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// معالجة رفع الصورة بنجاح\r\nconst handleImageUploadComplete = (fileInfo) => {\r\n  const { showSuccess } = useNotifications()\r\n  showSuccess('تم رفع الصورة', 'تم رفع الصورة بنجاح!')\r\n}\r\n\r\n// معالجة خطأ رفع الصورة\r\nconst handleImageUploadError = (error) => {\r\n  const { showError } = useNotifications()\r\n  showError('خطأ في رفع الصورة', error.message || 'حدث خطأ في رفع الصورة')\r\n}\r\n\r\n// تحديث الوجهة\r\nconst updateDestination = async () => {\r\n  const { showSuccess, showError, showWarning } = useNotifications()\r\n  \r\n  try {\r\n    updateLoading.value = true\r\n    \r\n    // التحقق من صحة البيانات قبل الإرسال\r\n    if (!form.value.name_ar || !form.value.name_en || !form.value.description_ar || !form.value.description_en) {\r\n      showWarning('حقول مطلوبة', 'يرجى ملء جميع الحقول المطلوبة')\r\n      return\r\n    }\r\n    \r\n    const result = await $fetch(`/api/destinations/${destinationId}`, {\r\n      method: 'PUT',\r\n      body: form.value\r\n    })\r\n    \r\n    if (result.success) {\r\n      showSuccess('تم التحديث بنجاح', 'تم تحديث الوجهة بنجاح!')\r\n      // إعادة التوجيه إلى صفحة عرض الوجهة\r\n      await navigateTo(`/admin/destinations/${destinationId}`)\r\n    } else {\r\n      showError('فشل في التحديث', 'فشل في تحديث الوجهة. يرجى المحاولة مرة أخرى.')\r\n    }\r\n  } catch (error) {\r\n    console.error('خطأ في تحديث الوجهة:', error)\r\n    showError('خطأ في التحديث', 'حدث خطأ في تحديث الوجهة. يرجى المحاولة مرة أخرى.')\r\n  } finally {\r\n    updateLoading.value = false\r\n  }\r\n}\r\n\r\n\r\n\r\n// تحميل البيانات عند تحميل الصفحة\r\nonMounted(() => {\r\n  loadDestination()\r\n})\r\n\r\n// SEO والميتا\r\nuseHead({\r\n  title: computed(() => `تحرير ${destination.value?.name_ar || 'الوجهة'} - Wonder Land Admin`),\r\n  meta: [\r\n    { name: 'description', content: 'تحرير معلومات الوجهة السياحية' },\r\n    { name: 'robots', content: 'noindex, nofollow' }\r\n  ]\r\n})\r\n</script>\r\n"],"names":["destinationId","useRoute","loading","ref","updateLoading","destination","form","handleImageUploadComplete","fileInfo","showSuccess","useNotifications","handleImageUploadError","error","showError","useHead","computed","_a"],"mappings":"45BAuNA,MAAMA,EADQC,EAAU,EACI,OAAO,GAG7BC,EAAUC,EAAI,EAAI,EAClBC,EAAgBD,EAAI,EAAK,EACzBE,EAAcF,EAAI,IAAI,EACtBG,EAAOH,EAAI,CACf,QAAS,GACT,QAAS,GACT,eAAgB,GAChB,eAAgB,GAChB,SAAU,gBACV,UAAW,GACX,OAAQ,GACR,SAAU,EACZ,CAAC,EAsCKI,EAA6BC,GAAa,CAC9C,KAAM,CAAE,YAAAC,CAAa,EAAGC,EAAkB,EAC1CD,EAAY,gBAAiB,sBAAsB,CACrD,EAGME,EAA0BC,GAAU,CACxC,KAAM,CAAE,UAAAC,CAAW,EAAGH,EAAkB,EACxCG,EAAU,oBAAqBD,EAAM,SAAW,uBAAuB,CACzE,EA2CA,OAAAE,EAAQ,CACN,MAAOC,EAAS,IAAM,OAAA,iBAASC,EAAAX,EAAY,QAAZ,YAAAW,EAAmB,UAAW,QAAQ,uBAAsB,EAC3F,KAAM,CACJ,CAAE,KAAM,cAAe,QAAS,+BAAiC,EACjE,CAAE,KAAM,SAAU,QAAS,mBAAqB,CACjD,CACH,CAAC"}