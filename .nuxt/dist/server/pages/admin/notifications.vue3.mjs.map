{"version":3,"file":"notifications.vue3.mjs","sources":["../../../../../pages/admin/notifications.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6\">\n    <!-- رأس الصفحة -->\n    <div class=\"flex items-center justify-between\">\n      <div>\n        <h1 class=\"text-2xl font-bold text-gray-900\">الإشعارات</h1>\n        <p class=\"text-gray-600 mt-1\">إدارة جميع الإشعارات والتنبيهات</p>\n      </div>\n      <div class=\"flex items-center space-x-3 space-x-reverse\">\n        <button\n          @click=\"refreshNotifications\"\n          class=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          :disabled=\"isLoading\"\n        >\n          <Icon \n            name=\"material-symbols:refresh\" \n            class=\"h-4 w-4 ml-2\"\n            :class=\"{ 'animate-spin': isLoading }\"\n          />\n          تحديث\n        </button>\n        <button\n          v-if=\"totalUnread > 0\"\n          @click=\"markAllAsRead\"\n          class=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        >\n          تعيين الكل كمقروء\n        </button>\n      </div>\n    </div>\n\n    <!-- إحصائيات الإشعارات -->\n    <div class=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n      <div class=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n        <div class=\"flex items-center\">\n          <div class=\"h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center\">\n            <Icon name=\"material-symbols:mail-outline\" class=\"h-5 w-5 text-blue-600\" />\n          </div>\n          <div class=\"mr-4\">\n            <p class=\"text-sm font-medium text-gray-600\">رسائل التواصل</p>\n            <p class=\"text-2xl font-bold text-gray-900\">{{ getNotificationCount('contact') }}</p>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n        <div class=\"flex items-center\">\n          <div class=\"h-10 w-10 bg-green-100 rounded-lg flex items-center justify-center\">\n            <Icon name=\"material-symbols:package-2-outline\" class=\"h-5 w-5 text-green-600\" />\n          </div>\n          <div class=\"mr-4\">\n            <p class=\"text-sm font-medium text-gray-600\">استفسارات الباقات</p>\n            <p class=\"text-2xl font-bold text-gray-900\">{{ getNotificationCount('package') }}</p>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n        <div class=\"flex items-center\">\n          <div class=\"h-10 w-10 bg-purple-100 rounded-lg flex items-center justify-center\">\n            <Icon name=\"material-symbols:location-on-outline\" class=\"h-5 w-5 text-purple-600\" />\n          </div>\n          <div class=\"mr-4\">\n            <p class=\"text-sm font-medium text-gray-600\">استفسارات الوجهات</p>\n            <p class=\"text-2xl font-bold text-gray-900\">{{ getNotificationCount('destination') }}</p>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\n        <div class=\"flex items-center\">\n          <div class=\"h-10 w-10 bg-orange-100 rounded-lg flex items-center justify-center\">\n            <Icon name=\"material-symbols:book-online-outline\" class=\"h-5 w-5 text-orange-600\" />\n          </div>\n          <div class=\"mr-4\">\n            <p class=\"text-sm font-medium text-gray-600\">الحجوزات الجديدة</p>\n            <p class=\"text-2xl font-bold text-gray-900\">{{ getNotificationCount('booking') }}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- قائمة الإشعارات -->\n    <div class=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div class=\"px-6 py-4 border-b border-gray-200\">\n        <h2 class=\"text-lg font-semibold text-gray-900\">جميع الإشعارات</h2>\n      </div>\n\n      <div v-if=\"isLoading\" class=\"p-8 text-center\">\n        <Icon name=\"material-symbols:refresh\" class=\"h-8 w-8 animate-spin mx-auto text-gray-400\" />\n        <p class=\"text-gray-500 mt-2\">جاري تحميل الإشعارات...</p>\n      </div>\n\n      <div v-else-if=\"notifications.length === 0\" class=\"p-8 text-center\">\n        <Icon name=\"material-symbols:notifications-none\" class=\"h-12 w-12 mx-auto text-gray-400\" />\n        <h3 class=\"text-lg font-medium text-gray-900 mt-4\">لا توجد إشعارات</h3>\n        <p class=\"text-gray-500 mt-2\">ستظهر الإشعارات الجديدة هنا عند وصولها</p>\n      </div>\n\n      <div v-else class=\"divide-y divide-gray-200\">\n        <div\n          v-for=\"notification in notifications\"\n          :key=\"`${notification.type}-${notification.id}`\"\n          class=\"p-6 hover:bg-gray-50 transition-colors\"\n          :class=\"{ 'bg-blue-50': !notification.is_read }\"\n        >\n          <div class=\"flex items-start space-x-4 space-x-reverse\">\n            <!-- أيقونة الإشعار -->\n            <div class=\"flex-shrink-0\">\n              <div \n                class=\"h-10 w-10 rounded-full flex items-center justify-center\"\n                :class=\"getNotificationColor(notification.type).replace('text-', 'bg-').replace('-600', '-100')\"\n              >\n                <Icon \n                  :name=\"getNotificationIcon(notification.type)\" \n                  class=\"h-5 w-5\"\n                  :class=\"getNotificationColor(notification.type)\"\n                />\n              </div>\n            </div>\n\n            <!-- محتوى الإشعار -->\n            <div class=\"flex-1 min-w-0\">\n              <div class=\"flex items-center justify-between\">\n                <h3 class=\"text-lg font-medium text-gray-900\">\n                  {{ notification.title }}\n                </h3>\n                <div class=\"flex items-center space-x-3 space-x-reverse\">\n                  <span class=\"text-sm text-gray-500\">\n                    {{ formatNotificationTime(notification.created_at) }}\n                  </span>\n                  <div \n                    v-if=\"!notification.is_read\"\n                    class=\"h-2 w-2 bg-blue-500 rounded-full\"\n                  ></div>\n                  <button\n                    v-if=\"!notification.is_read\"\n                    @click=\"markAsRead(notification.id, notification.type)\"\n                    class=\"text-sm text-blue-600 hover:text-blue-800 font-medium\"\n                  >\n                    تعيين كمقروء\n                  </button>\n                </div>\n              </div>\n              \n              <p class=\"text-gray-600 mt-1\">\n                {{ notification.description }}\n              </p>\n              \n              <div class=\"mt-3 flex items-center text-sm text-gray-500 space-x-4 space-x-reverse\">\n                <span class=\"flex items-center\">\n                  <Icon name=\"material-symbols:person-outline\" class=\"h-4 w-4 ml-1\" />\n                  {{ notification.name }}\n                </span>\n                <span class=\"flex items-center\">\n                  <Icon name=\"material-symbols:mail-outline\" class=\"h-4 w-4 ml-1\" />\n                  {{ notification.email }}\n                </span>\n                <span class=\"flex items-center\">\n                  <Icon name=\"material-symbols:phone-outline\" class=\"h-4 w-4 ml-1\" />\n                  {{ notification.phone }}\n                </span>\n              </div>\n\n              <div v-if=\"notification.message\" class=\"mt-3 p-3 bg-gray-50 rounded-lg\">\n                <p class=\"text-sm text-gray-700\">{{ notification.message }}</p>\n              </div>\n\n              <!-- أزرار الإجراءات -->\n              <div class=\"mt-4 flex items-center space-x-3 space-x-reverse\">\n                <button\n                  @click=\"navigateToNotification(notification)\"\n                  class=\"px-3 py-1 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100\"\n                >\n                  عرض التفاصيل\n                </button>\n                <button\n                  v-if=\"notification.type === 'contact'\"\n                  @click=\"replyToContact(notification)\"\n                  class=\"px-3 py-1 text-sm font-medium text-green-600 bg-green-50 rounded-md hover:bg-green-100\"\n                >\n                  الرد\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { AdminNotification } from '~/types/notifications';\n\n// تحديد layout الإدارة\ndefinePageMeta({\n  layout: 'admin',\n  middleware: 'admin'\n});\n\n// استخدام composable الإشعارات\nconst {\n  notifications,\n  totalUnread,\n  isLoading,\n  fetchNotifications,\n  markAsRead,\n  markAllAsRead,\n  getNotificationIcon,\n  getNotificationColor,\n  formatNotificationTime\n} = useNotifications();\n\n// تحميل الإشعارات عند تحميل الصفحة\nonMounted(() => {\n  fetchNotifications();\n});\n\n// دالة تحديث الإشعارات\nconst refreshNotifications = async () => {\n  await fetchNotifications();\n};\n\n// دالة الحصول على عدد الإشعارات حسب النوع\nconst getNotificationCount = (type: string) => {\n  return notifications.value.filter(n => n.type === type && !n.is_read).length;\n};\n\n// دالة التنقل إلى الإشعار\nconst navigateToNotification = (notification: AdminNotification) => {\n  let route = '';\n  switch (notification.type) {\n    case 'contact':\n      route = '/admin/contacts';\n      break;\n    case 'package':\n      route = '/admin/packages';\n      break;\n    case 'destination':\n      route = '/admin/destinations';\n      break;\n    case 'booking':\n      route = '/admin/bookings';\n      break;\n  }\n\n  if (route) {\n    navigateTo(route);\n  }\n};\n\n// دالة الرد على رسالة التواصل\nconst replyToContact = (notification: AdminNotification) => {\n  // يمكن إضافة منطق الرد هنا\n  console.log('Reply to contact:', notification);\n  // يمكن فتح نافذة الرد أو التنقل إلى صفحة الرد\n};\n\n// تحديث الإشعارات كل 30 ثانية\nlet refreshInterval: NodeJS.Timeout | null = null;\n\nonMounted(() => {\n  refreshInterval = setInterval(() => {\n    fetchNotifications();\n  }, 30000);\n});\n\nonUnmounted(() => {\n  if (refreshInterval) {\n    clearInterval(refreshInterval);\n  }\n});\n</script>\n"],"names":["notifications","totalUnread","isLoading","getNotificationIcon","getNotificationColor","formatNotificationTime","useNotifications","getNotificationCount","type","n"],"mappings":"6fA0MM,KAAA,CACJ,cAAAA,EACA,YAAAC,EACA,UAAAC,EAIA,oBAAAC,EACA,qBAAAC,EACA,uBAAAC,GACEC,EAAiB,EAafC,EAAwBC,GACrBR,EAAc,MAAM,OAAYS,GAAAA,EAAE,OAASD,GAAQ,CAACC,EAAE,OAAO,EAAE"}