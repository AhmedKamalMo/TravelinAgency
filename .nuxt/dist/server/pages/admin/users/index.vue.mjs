import O from"../../../components/admin/AdminPageHeader.vue.mjs";import X from"../../../node_modules/_nuxt/icon/dist/runtime/components/index2.mjs";import Z from"../../../node_modules/nuxt/dist/app/components/nuxt-link.mjs";import I from"../../../components/admin/AdminStats.vue.mjs";import{ref as L,computed as F,watch as _,mergeProps as ee,withCtx as A,createVNode as c,unref as t,createTextVNode as te,useSSRContext as se}from"vue";import{ssrRenderAttrs as ae,ssrRenderComponent as d,ssrRenderAttr as j,ssrIncludeBooleanAttr as m,ssrLooseContain as x,ssrLooseEqual as g,ssrRenderList as re,ssrInterpolate as b,ssrRenderClass as N}from"vue/server-renderer";import"F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import{useUsers as le}from"../../../composables/useUsers.mjs";import{useExcelExport as oe}from"../../../composables/useExcelExport.mjs";import{useHead as ne}from"../../../node_modules/nuxt/dist/head/runtime/composables/v3.mjs";const k=10,V={__name:"index",__ssrInlineRender:!0,setup(E){const{users:C,isLoading:D,userStats:Y,getRoleName:q,getRoleColor:B,getStatusName:Q,getStatusColor:W,formatDate:z}=le(),p=L(""),l=L(""),o=L(""),n=L(""),$=L(1),M=F(()=>{let a=C.value;if(p.value&&(a=a.filter(e=>{var s,y,v;return((s=e.full_name)==null?void 0:s.toLowerCase().includes(p.value.toLowerCase()))||((y=e.name)==null?void 0:y.toLowerCase().includes(p.value.toLowerCase()))||e.email.toLowerCase().includes(p.value.toLowerCase())||((v=e.phone)==null?void 0:v.toLowerCase().includes(p.value.toLowerCase()))})),l.value&&(a=a.filter(e=>e.status===l.value)),o.value&&(a=a.filter(e=>e.role===o.value)),n.value){const e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()),y=new Date(s.getTime()-7*24*60*60*1e3),v=new Date(s.getTime()-30*24*60*60*1e3);a=a.filter(r=>{const u=new Date(r.created_at);switch(n.value){case"today":return u>=s;case"week":return u>=y;case"month":return u>=v;default:return!0}})}return a.slice(($.value-1)*k,$.value*k)}),S=F(()=>{let a=C.value;if(p.value&&(a=a.filter(e=>{var s,y,v;return((s=e.full_name)==null?void 0:s.toLowerCase().includes(p.value.toLowerCase()))||((y=e.name)==null?void 0:y.toLowerCase().includes(p.value.toLowerCase()))||e.email.toLowerCase().includes(p.value.toLowerCase())||((v=e.phone)==null?void 0:v.toLowerCase().includes(p.value.toLowerCase()))})),l.value&&(a=a.filter(e=>e.status===l.value)),o.value&&(a=a.filter(e=>e.role===o.value)),n.value){const e=new Date,s=new Date(e.getFullYear(),e.getMonth(),e.getDate()),y=new Date(s.getTime()-7*24*60*60*1e3),v=new Date(s.getTime()-30*24*60*60*1e3);a=a.filter(r=>{const u=new Date(r.created_at);switch(n.value){case"today":return u>=s;case"week":return u>=y;case"month":return u>=v;default:return!0}})}return a.length}),U=F(()=>Math.ceil(S.value/k)),G=()=>{try{const{exportUsersToExcel:a}=oe();a(C.value)?console.log("تم تصدير المستخدمين بنجاح"):console.error("فشل في تصدير المستخدمين")}catch(a){console.error("خطأ في تصدير المستخدمين:",a)}};return _([p,l,o,n],()=>{$.value=1}),ne({title:"إدارة المستخدمين - Wonder Land Admin",meta:[{name:"description",content:"إدارة وتحرير المستخدمين المسجلين"},{name:"robots",content:"noindex, nofollow"}]}),(a,e,s,y)=>{const v=O,r=X,u=Z,J=I;e(`<div${ae(ee({class:"space-y-6"},y))}><div class="h-16"></div>`),e(d(v,{title:"إدارة المستخدمين",description:"إدارة وتحرير المستخدمين المسجلين"},{actions:A((i,w,h,f)=>{if(w)w(`<button class="inline-flex items-center px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"${f}>`),w(d(r,{name:"material-symbols:download",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"},null,h,f)),w(`<span class="hidden sm:inline"${f}>تصدير البيانات</span><span class="sm:hidden"${f}>تصدير</span></button>`),w(d(u,{to:"/admin/users/create",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"},{default:A((R,P,K,T)=>{if(P)P(d(r,{name:"material-symbols:add",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"},null,K,T)),P(`<span class="hidden sm:inline"${T}>إضافة مستخدم جديد</span><span class="sm:hidden"${T}>إضافة</span>`);else return[c(r,{name:"material-symbols:add",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),c("span",{class:"hidden sm:inline"},"إضافة مستخدم جديد"),c("span",{class:"sm:hidden"},"إضافة")]}),_:1},h,f));else return[c("button",{onClick:G,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"},[c(r,{name:"material-symbols:download",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),c("span",{class:"hidden sm:inline"},"تصدير البيانات"),c("span",{class:"sm:hidden"},"تصدير")]),c(u,{to:"/admin/users/create",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"},{default:A(()=>[c(r,{name:"material-symbols:add",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),c("span",{class:"hidden sm:inline"},"إضافة مستخدم جديد"),c("span",{class:"sm:hidden"},"إضافة")]),_:1})]}),_:1},s)),e(d(J,{stats:t(Y)},null,s)),e('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><div class="grid grid-cols-1 md:grid-cols-4 gap-4"><div class="relative">'),e(d(r,{name:"material-symbols:search",class:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"},null,s)),e(`<input${j("value",t(p))} type="text" placeholder="البحث في المستخدمين..." class="w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></div><select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option value=""${m(Array.isArray(t(l))?x(t(l),""):g(t(l),""))?" selected":""}>جميع الحالات</option><option value="active"${m(Array.isArray(t(l))?x(t(l),"active"):g(t(l),"active"))?" selected":""}>نشط</option><option value="inactive"${m(Array.isArray(t(l))?x(t(l),"inactive"):g(t(l),"inactive"))?" selected":""}>غير نشط</option><option value="suspended"${m(Array.isArray(t(l))?x(t(l),"suspended"):g(t(l),"suspended"))?" selected":""}>معلق</option></select><select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option value=""${m(Array.isArray(t(o))?x(t(o),""):g(t(o),""))?" selected":""}>جميع الأدوار</option><option value="admin"${m(Array.isArray(t(o))?x(t(o),"admin"):g(t(o),"admin"))?" selected":""}>مدير</option><option value="moderator"${m(Array.isArray(t(o))?x(t(o),"moderator"):g(t(o),"moderator"))?" selected":""}>مشرف</option><option value="user"${m(Array.isArray(t(o))?x(t(o),"user"):g(t(o),"user"))?" selected":""}>مستخدم</option></select><select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option value=""${m(Array.isArray(t(n))?x(t(n),""):g(t(n),""))?" selected":""}>جميع التواريخ</option><option value="today"${m(Array.isArray(t(n))?x(t(n),"today"):g(t(n),"today"))?" selected":""}>اليوم</option><option value="week"${m(Array.isArray(t(n))?x(t(n),"week"):g(t(n),"week"))?" selected":""}>هذا الأسبوع</option><option value="month"${m(Array.isArray(t(n))?x(t(n),"month"):g(t(n),"month"))?" selected":""}>هذا الشهر</option></select></div></div><div class="bg-white rounded-lg shadow-sm border border-gray-200">`),t(D)?(e('<div class="flex justify-center items-center py-12">'),e(d(r,{name:"material-symbols:progress-activity",class:"animate-spin h-8 w-8 text-blue-600"},null,s)),e('<span class="mr-3 text-gray-600">جارٍ تحميل المستخدمين...</span></div>')):t(M).length>0?(e('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> المستخدم </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> البريد الإلكتروني </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> الدور </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> الحالة </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> تاريخ التسجيل </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> الإجراءات </th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><!--[-->'),re(t(M),i=>{e('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10"><div class="h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center">'),e(d(r,{name:"material-symbols:person",class:"h-6 w-6 text-gray-600"},null,s)),e(`</div></div><div class="mr-4"><div class="text-sm font-medium text-gray-900">${b(i.full_name||i.name||"غير محدد")}</div><div class="text-sm text-gray-500">${b(i.phone||"لا يوجد رقم هاتف")}</div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${b(i.email)}</div><div class="text-sm text-gray-500">${b(i.email_verified?"مؤكد":"غير مؤكد")}</div></td><td class="px-6 py-4 whitespace-nowrap"><span class="${N([t(B)(i.role),"px-2 py-1 text-xs font-medium rounded-full"])}">${b(t(q)(i.role))}</span></td><td class="px-6 py-4 whitespace-nowrap"><span class="${N([t(W)(i.status),"px-2 py-1 text-xs font-medium rounded-full"])}">${b(t(Q)(i.status))}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${b(t(z)(i.created_at))}</td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><div class="flex items-center space-x-2 space-x-reverse">`),e(d(u,{to:`/admin/users/${i.id}`,class:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"عرض"},{default:A((w,h,f,R)=>{if(h)h(d(r,{name:"material-symbols:visibility",class:"h-4 w-4"},null,f,R));else return[c(r,{name:"material-symbols:visibility",class:"h-4 w-4"})]}),_:2},s)),e(d(u,{to:`/admin/users/${i.id}/edit`,class:"text-green-600 hover:text-green-900 p-1 rounded",title:"تحرير"},{default:A((w,h,f,R)=>{if(h)h(d(r,{name:"material-symbols:edit",class:"h-4 w-4"},null,f,R));else return[c(r,{name:"material-symbols:edit",class:"h-4 w-4"})]}),_:2},s)),e(`<button class="${N([i.status==="active"?"text-orange-600 hover:text-orange-900":"text-green-600 hover:text-green-900","p-1 rounded"])}"${j("title",i.status==="active"?"إلغاء التفعيل":"تفعيل")}>`),e(d(r,{name:i.status==="active"?"material-symbols:pause":"material-symbols:play-arrow",class:"h-4 w-4"},null,s)),e('</button><button class="text-red-600 hover:text-red-900 p-1 rounded" title="حذف">'),e(d(r,{name:"material-symbols:delete",class:"h-4 w-4"},null,s)),e("</button></div></td></tr>")}),e("<!--]--></tbody></table></div>")):(e('<div class="text-center py-12">'),e(d(r,{name:"material-symbols:people",class:"h-16 w-16 text-gray-300 mx-auto mb-4"},null,s)),e('<h3 class="text-lg font-medium text-gray-900 mb-2">لا يوجد مستخدمون</h3><p class="text-gray-500 mb-6">لم يتم العثور على أي مستخدمين</p>'),e(d(u,{to:"/admin/users/create",class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},{default:A((i,w,h,f)=>{if(w)w(d(r,{name:"material-symbols:add",class:"h-5 w-5 ml-2"},null,h,f)),w(" إضافة مستخدم جديد ");else return[c(r,{name:"material-symbols:add",class:"h-5 w-5 ml-2"}),te(" إضافة مستخدم جديد ")]}),_:1},s)),e("</div>")),e("</div>"),t(U)>1?e(`<div class="flex items-center justify-between"><div class="text-sm text-gray-700"> عرض ${b((t($)-1)*k+1)} إلى ${b(Math.min(t($)*k,t(S)))} من أصل ${b(t(S))} مستخدم </div><div class="flex space-x-1 space-x-reverse"><button${m(t($)===1)?" disabled":""} class="px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> السابق </button><span class="px-3 py-2 text-sm bg-blue-600 text-white border border-blue-600 rounded-md">${b(t($))}</span><button${m(t($)===t(U))?" disabled":""} class="px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> التالي </button></div></div>`):e("<!---->"),e("</div>")}}},H=V.setup;V.setup=(E,C)=>{const D=se();return(D.modules||(D.modules=new Set)).add("pages/admin/users/index.vue"),H?H(E,C):void 0};export{V as default};
//# sourceMappingURL=index.vue.mjs.map
