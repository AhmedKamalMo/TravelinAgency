{"file":"css.mjs","mappings":"kdAMA,MAAMA,EAAoB,wBAC1B,SAASC,EAAkBC,EAAU,CAC5B,OAAAA,EAAS,QAAQ,YAAa,MAAM,CAC7C,CAqCO,MAAMC,EAA8CC,EAAA,CACzD,KAAM,cACN,MAAO,CACL,KAAM,CACJ,KAAM,OACN,SAAU,EACZ,EACA,UAAW,CACT,KAAM,CAAC,SAAU,QAAS,IAAI,EAC9B,QAAS,KACT,SAAU,EAAA,CAEd,EACA,MAAMC,EAAO,CACX,MAAMC,EAAOC,EAAW,EAClBC,EAAUC,IAAe,KACzBC,EAAWC,EAAS,IAAMN,EAAM,KAAOG,EAAQ,kBAAoBH,EAAM,KAAO,EAAE,EAalFH,EAAWS,EAAS,IAAM,IAAMV,EAAkBS,EAAS,KAAK,CAAC,EAC9D,SAAAE,EAAOC,EAAMC,EAAY,GAAM,CACtC,IAAIC,EAAeb,EAAS,MACxBM,EAAQ,iBACVO,EAAe,UAAUA,CAAY,KAEjC,MAAAC,EAAMC,EAAWJ,EAAM,CAC3B,aAAAE,EACA,OAAQ,aACR,UAAWG,EAAmBb,EAAM,UAAWG,EAAQ,SAAS,CAAA,CACjE,EACG,OAAAA,EAAQ,UAAYM,EACf,UAAUN,EAAQ,QAAQ,MAAMQ,CAAG,KAErCA,CAAA,CAwCT,OAAAG,EAAiB,SAAY,OACH,CACtB,MAAMC,EAAUC,IAAmB,MAAQ,CAAC,EAC5C,GAAI,GAACC,EAAAF,GAAA,YAAAA,EAAS,wBAAT,MAAAE,EAAgC,SAASZ,EAAS,QAAQ,CACvD,MAAAG,EAAO,MAAMU,EAASlB,EAAM,KAAMG,EAAQ,YAAY,EAAE,MAAM,IAAM,IAAI,EAC9E,GAAI,CAACK,EACI,OAAA,KACT,IAAIW,EAASlB,EAAK,OAAO,SAAS,SAASN,CAAiB,EAoB5D,GAnBKwB,IACHA,EAASlB,EAAK,OAAO,SAAS,SAASN,CAAiB,MAAwB,IAChFM,EAAK,eAAe,IAAM,CAChBmB,EAAA,CACN,MAAO,CACL,IAAM,CACE,MAAAC,EAA+B,GACjC,IAAAV,EAAM,MAAM,KAAKQ,EAAO,OAAQ,CAAA,EAAE,KAAA,EAAO,KAAKE,CAAG,EACrD,OAAIlB,EAAQ,WACJQ,EAAA,UAAUR,EAAQ,QAAQ,KAAKkB,CAAG,GAAGV,CAAG,GAAGU,CAAG,KAE/C,CAAE,UAAWV,CAAI,CAAA,CAC1B,CACF,EACC,CACD,YAAa,KAAA,CACd,CAAA,CACF,GAECX,EAAM,MAAQ,CAACmB,EAAO,IAAInB,EAAM,IAAI,EAAG,CACnC,MAAAW,EAAMJ,EAAOC,EAAM,EAAK,EACvBW,EAAA,IAAInB,EAAM,KAAMW,CAAG,CAAA,CAErB,OAAA,IAAA,CACT,CACF,CACD,EACM,IAAMW,EAAE,OAAQ,CAAE,MAAO,CAAC,UAAWjB,EAAS,KAAK,EAAG,CAAA,CAEjE,CAAC","names":["SYMBOL_SERVER_CSS","escapeCssSelector","selector","NuxtIconCss","defineComponent","props","nuxt","useNuxtApp","options","useAppConfig","cssClass","computed","getCSS","icon","withLayer","iconSelector","css","getIconCSS","resolveCustomizeFn","onServerPrefetch","configs","useRuntimeConfig","_a","loadIcon","ssrCSS","useHead","sep","h"],"sources":["../../../../../../../../../node_modules/@nuxt/icon/dist/runtime/components/css.js"],"sourcesContent":["import { addIcon, getIcon as _getIcon } from \"@iconify/vue\";\nimport { computed, watch, h, defineComponent } from \"vue\";\nimport { getIconCSS } from \"@iconify/utils/lib/css/icon\";\nimport { loadIcon, resolveCustomizeFn } from \"./shared.js\";\nimport { useAppConfig, useNuxtApp, useHead, useRuntimeConfig, onServerPrefetch } from \"#imports\";\nlet cssSelectors;\nconst SYMBOL_SERVER_CSS = \"NUXT_ICONS_SERVER_CSS\";\nfunction escapeCssSelector(selector) {\n  return selector.replace(/([^\\w-])/g, \"\\\\$1\");\n}\nfunction getAllSelectors() {\n  if (cssSelectors)\n    return cssSelectors;\n  cssSelectors = /* @__PURE__ */ new Set();\n  const filter = (selector) => {\n    selector = selector.replace(/^:where\\((.*)\\)$/, \"$1\").trim();\n    if (selector.startsWith(\".\")) {\n      return selector;\n    }\n  };\n  const scanCssRules = (rules) => {\n    if (!rules?.length)\n      return;\n    for (const rule of rules) {\n      if (rule?.cssRules) {\n        scanCssRules(rule.cssRules);\n      }\n      const selectorRaw = rule?.selectorText;\n      if (typeof selectorRaw === \"string\") {\n        const selector = filter(selectorRaw);\n        if (selector)\n          cssSelectors.add(selector);\n      }\n    }\n  };\n  if (typeof document !== \"undefined\") {\n    for (const styleSheet of document.styleSheets) {\n      try {\n        const rules = styleSheet.cssRules || styleSheet.rules;\n        scanCssRules(rules);\n      } catch {\n      }\n    }\n  }\n  return cssSelectors;\n}\nexport const NuxtIconCss = /* @__PURE__ */ defineComponent({\n  name: \"NuxtIconCss\",\n  props: {\n    name: {\n      type: String,\n      required: true\n    },\n    customize: {\n      type: [Function, Boolean, null],\n      default: null,\n      required: false\n    }\n  },\n  setup(props) {\n    const nuxt = useNuxtApp();\n    const options = useAppConfig().icon;\n    const cssClass = computed(() => props.name ? options.cssSelectorPrefix + props.name : \"\");\n    function getIcon(name) {\n      if (!name)\n        return;\n      const icon = _getIcon(name);\n      if (icon)\n        return icon;\n      const payload = nuxt.payload?.data?.[name];\n      if (payload) {\n        addIcon(name, payload);\n        return payload;\n      }\n    }\n    const selector = computed(() => \".\" + escapeCssSelector(cssClass.value));\n    function getCSS(icon, withLayer = true) {\n      let iconSelector = selector.value;\n      if (options.cssWherePseudo) {\n        iconSelector = `:where(${iconSelector})`;\n      }\n      const css = getIconCSS(icon, {\n        iconSelector,\n        format: \"compressed\",\n        customise: resolveCustomizeFn(props.customize, options.customize)\n      });\n      if (options.cssLayer && withLayer) {\n        return `@layer ${options.cssLayer} { ${css} }`;\n      }\n      return css;\n    }\n    if (import.meta.client) {\n      const selectors = getAllSelectors();\n      async function mountCSS(icon) {\n        if (selectors.has(selector.value))\n          return;\n        if (typeof document === \"undefined\")\n          return;\n        const style = document.createElement(\"style\");\n        style.textContent = getCSS(icon);\n        if (import.meta.dev) {\n          style.dataset.nuxtIconDev = props.name;\n        }\n        const firstStyle = document.head.querySelector('style, link[rel=\"stylesheet\"]');\n        if (firstStyle)\n          document.head.insertBefore(style, firstStyle);\n        else\n          document.head.appendChild(style);\n        selectors.add(selector.value);\n      }\n      watch(\n        () => props.name,\n        () => {\n          if (selectors.has(selector.value)) {\n            return;\n          }\n          const data = getIcon(props.name);\n          if (data) {\n            mountCSS(data);\n          } else {\n            loadIcon(props.name, import.meta.server ? options.fetchTimeout : -1).then((data2) => {\n              if (data2)\n                mountCSS(data2);\n            }).catch(() => null);\n          }\n        },\n        { immediate: true }\n      );\n    }\n    onServerPrefetch(async () => {\n      if (import.meta.server) {\n        const configs = useRuntimeConfig().icon || {};\n        if (!configs?.serverKnownCssClasses?.includes(cssClass.value)) {\n          const icon = await loadIcon(props.name, options.fetchTimeout).catch(() => null);\n          if (!icon)\n            return null;\n          let ssrCSS = nuxt.vueApp._context.provides[SYMBOL_SERVER_CSS];\n          if (!ssrCSS) {\n            ssrCSS = nuxt.vueApp._context.provides[SYMBOL_SERVER_CSS] = /* @__PURE__ */ new Map();\n            nuxt.runWithContext(() => {\n              useHead({\n                style: [\n                  () => {\n                    const sep = import.meta.dev ? \"\\n\" : \"\";\n                    let css = Array.from(ssrCSS.values()).sort().join(sep);\n                    if (options.cssLayer) {\n                      css = `@layer ${options.cssLayer} {${sep}${css}${sep}}`;\n                    }\n                    return { innerHTML: css };\n                  }\n                ]\n              }, {\n                tagPriority: \"low\"\n              });\n            });\n          }\n          if (props.name && !ssrCSS.has(props.name)) {\n            const css = getCSS(icon, false);\n            ssrCSS.set(props.name, css);\n          }\n          return null;\n        }\n      }\n    });\n    return () => h(\"span\", { class: [\"iconify\", cssClass.value] });\n  }\n});\n"],"version":3}