import{isArray as T,isString as C,isObject as v}from"../../../../_intlify/shared/dist/shared.mjs";import{hasProtocol as L}from"../../../../ufo/dist/index.mjs";import A from"../../../../is-https/dist/index.mjs";import{DEFAULT_COOKIE_KEY as N,localeCodes as w,normalizedLocales as k,NUXT_I18N_MODULE_ID as S}from"../../../../../.nuxt/i18n.options.mjs";import{getLocalesRegex as O,findBrowserLocale as B,getI18nTarget as x}from"./routing/utils.mjs";import{initCommonComposableOptions as P,createLogger as M}from"./utils.mjs";import{useRequestHeaders as D,useRequestEvent as F}from"../../../../nuxt/dist/app/composables/ssr.mjs";import{useCookie as H}from"../../../../nuxt/dist/app/composables/cookie.mjs";import{useRuntimeConfig as g,useNuxtApp as K}from"../../../../nuxt/dist/app/nuxt.mjs";import{unref as U}from"vue";function y(e){return S+" "+e}function te(e,t,...o){const r=x(e),[i,s]=[r,r[t]];return Reflect.apply(s,i,[...o])}function ne(e,t){const o=x(e);return U(o[t])}function re(e,t,o){Object.defineProperty(e,t,{get:()=>o})}function ie(e,t=P()){return(...o)=>e(t,...o)}function j(e){return e.split(",").map(t=>t.split(";")[0])}function q(){let e;{const o=D(["accept-language"])["accept-language"];o&&(e=B(k,j(o)))}return e}function se(){const e=R(),t=e&&e.cookieKey||N,o=new Date,r={expires:new Date(o.setDate(o.getDate()+365)),path:"/",sameSite:e&&e.cookieCrossOrigin?"none":"lax",secure:e&&e.cookieCrossOrigin||e&&e.cookieSecure};return e&&e.cookieDomain&&(r.domain=e.cookieDomain),H(t,r)}function ae(e,t,o){if(t===!1||!t.useCookie)return;const r=e.value??void 0;if(r!=null){if(w.includes(r))return r;if(o)return e.value=o,o;e.value=void 0}}function ce(e,t,o){o===!1||!o.useCookie||(e.value=t)}var G=(e=>(e.NOT_FOUND="not_found_match",e.FIRST_ACCESS="first_access_only",e.NO_REDIRECT_ROOT="not_redirect_on_root",e.NO_REDIRECT_NO_PREFIX="not_redirect_on_no_prefix",e.SSG_IGNORE="detect_ignore_on_ssg",e))(G||{});const V={locale:""};function fe(e,t,o=""){M("detectBrowserLanguage");const r=R();if(!r)return V;const{strategy:i}=g().public.i18n,{ssg:s,callType:n,firstAccess:a,localeCookie:f}=t;if(i==="no_prefix")return{locale:"",reason:"detect_ignore_on_ssg"};if(!a)return{locale:i==="no_prefix"?o:"",reason:"first_access_only"};const{redirectOn:d,alwaysRedirect:p,useCookie:m,fallbackLocale:l}=r,c=C(e)?e:e.path;if(i!=="no_prefix"){if(d==="root"&&c!=="/")return{locale:"",reason:"not_redirect_on_root"};if(d==="no prefix"&&!p&&c.match(O(w)))return{locale:"",reason:"not_redirect_on_no_prefix"}}let u;const _=m&&f||void 0;m&&(u="cookie");const b=q();_||(u="navigator_or_header");const h=_||b,E=h||l||"";return!h&&l&&(u="fallback"),{locale:E,from:u}}function I(){let e;{const t=D(["x-forwarded-host","host"]);let o;"x-forwarded-host"in t?o=t["x-forwarded-host"]:"host"in t&&(o=t.host),e=T(o)?o[0]:o}return e}function ue(e,t,o){let r=I()||"";if(r){let i;const s=e.filter(n=>{if(n&&n.domain){let a=n.domain;return L(n.domain)&&(a=n.domain.replace(/(http|https):\/\//,"")),a===r}else if(Array.isArray(n==null?void 0:n.domains))return n.domains.includes(r);return!1});if(s.length===1)i=s[0];else if(s.length>1)if(t==="no_prefix")console.warn(y("Multiple matching domains found! This is not supported for no_prefix strategy in combination with differentDomains!")),i=s[0];else{if(o){const n=v(o)?o.path:C(o)?o:"";if(n&&n!==""){const a=n.match(O(s.map(f=>f.code)));a&&a.length>1&&(i=s.find(f=>f.code===a[1]))}}i||(i=s.find(n=>Array.isArray(n.defaultForDomains)?n.defaultForDomains.includes(r):n.domainDefault))}if(i)return i.code;r=""}return r}function de(e){var a,f,d,p,m,l;const t=g(),o=K(),r=I(),i=t.public.i18n,s=k.find(c=>c.code===e),n=((f=(a=i==null?void 0:i.locales)==null?void 0:a[e])==null?void 0:f.domain)||(s==null?void 0:s.domain)||((m=(p=(d=i==null?void 0:i.locales)==null?void 0:d[e])==null?void 0:p.domains)==null?void 0:m.find(c=>c===r))||((l=s==null?void 0:s.domains)==null?void 0:l.find(c=>c===r));if(n){if(L(n,{strict:!0}))return n;let c;{const{node:{req:u}}=F(o);c=u&&A(u)?"https:":"http:"}return c+"//"+n}console.warn(y("Could not find domain name for locale "+e))}const R=(e=g().public.i18n)=>(e==null?void 0:e.detectBrowserLanguage)===!1?!1:e==null?void 0:e.detectBrowserLanguage;export{V as DefaultDetectBrowserLanguageFromResult,G as DetectFailure,te as callVueI18nInterfaces,re as defineGetter,fe as detectBrowserLanguage,y as formatMessage,q as getBrowserLocale,de as getDomainFromLocale,I as getHost,se as getI18nCookie,ae as getLocaleCookie,ue as getLocaleDomain,ne as getVueI18nPropertyValue,j as parseAcceptLanguage,R as runtimeDetectBrowserLanguage,ce as setLocaleCookie,ie as wrapComposable};
//# sourceMappingURL=internal.mjs.map
