import{assign as j,isFunction as y,isObject as P}from"../../../../../../_intlify/shared/dist/shared.mjs";import{getComposer as C,isVueI18n as U,resolveBaseUrl as h}from"../utils.mjs";import{switchLocalePath as O,localeLocation as V,localeRoute as L,localePath as w,resolveRoute as B,getRouteBaseName as D}from"../compatibles/routing.mjs";import{localeHead as G}from"../compatibles/head.mjs";import{wrapComposable as s}from"../../internal.mjs";import{initCommonComposableOptions as H}from"../../utils.mjs";import{effectScope as N,computed as d,ref as b}from"vue";function Q(e,{locales:t=[],localeCodes:l=[],baseUrl:u="",hooks:c={},context:m={}}={}){const r=N(),g=e.install;return e.install=(i,...f)=>{const n=S(f[0])?j({},f[0]):{inject:!0};n.inject==null&&(n.inject=!0);const E=n.__composerExtend;if(n.__composerExtend=o=>{const p=C(e);o.locales=d(()=>p.locales.value),o.localeCodes=d(()=>p.localeCodes.value),o.baseUrl=d(()=>p.baseUrl.value);let a;return y(E)&&(a=Reflect.apply(E,n,[o])),()=>{a&&a()}},e.mode==="legacy"){const o=n.__vueI18nExtend;n.__vueI18nExtend=p=>{I(p,c.onExtendVueI18n);let a;return y(o)&&(a=Reflect.apply(o,n,[p])),()=>{a&&a()}}}f[0]=n,Reflect.apply(g,e,[i,...f]);const _=C(e);r.run(()=>{A(_,{locales:t,localeCodes:l,baseUrl:u,hooks:c,context:m}),e.mode==="legacy"&&U(e.global)&&I(e.global,c.onExtendVueI18n)});const x=i,v=e.mode==="composition"?x.config.globalProperties.$i18n:null;if(v&&F(v,_,c.onExtendExportedGlobal),n.inject){const o=H(e);i.mixin({methods:{getRouteBaseName:s(D,o),resolveRoute:s(B,o),localePath:s(w,o),localeRoute:s(L,o),localeLocation:s(V,o),switchLocalePath:s(O,o),localeHead:s(G,o)}})}if(x.unmount){const o=x.unmount;x.unmount=()=>{r.stop(),o()}}},r}function A(e,t){const{locales:l,localeCodes:u,baseUrl:c,context:m}=t,r=b(l),g=b(u),i=b("");e.locales=d(()=>r.value),e.localeCodes=d(()=>g.value),e.baseUrl=d(()=>i.value),i.value=h(c,m),t.hooks&&t.hooks.onExtendComposer&&t.hooks.onExtendComposer(e)}function R(e,t,l){const u=[{locales:{get(){return e.locales.value}},localeCodes:{get(){return e.localeCodes.value}},baseUrl:{get(){return e.baseUrl.value}}}];l&&u.push(l(e));for(const c of u)for(const[m,r]of Object.entries(c))Object.defineProperty(t,m,r)}function F(e,t,l){R(t,e,l)}function I(e,t){const l=C(e);R(l,e,t)}function S(e){return P(e)&&("inject"in e||"__composerExtend"in e||"__vueI18nExtend"in e)}export{Q as extendI18n};
//# sourceMappingURL=i18n.mjs.map
