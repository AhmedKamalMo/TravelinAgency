import{aB as s,J as c,aC as d,n as l}from"./D1nMFiHg.js";const m=s(async r=>{let o,a;if(console.log("🚀 Admin middleware called for:",r.path),r.path==="/admin/login"){console.log("⏭️ Skipping middleware for login page");return}const{user:n,checkAuth:i}=c();let e=n.value;if(e)console.log("✅ User already authenticated from cookie:",e.email);else{console.log("👤 No user in state, checking auth...");try{e=([o,a]=d(()=>i(!0)),o=await o,a(),o)}catch(t){return console.error("❌ Auth check failed:",t),l("/admin/login")}}if(!e||!e.role||!["admin","super_admin","moderator"].includes(e.role))return console.log("❌ No authenticated admin user found, redirecting to login"),l("/admin/login");console.log("✅ User has admin privileges:",e.email,"role:",e.role),console.log("✅ Middleware completed successfully for:",r.path)});export{m as default};
