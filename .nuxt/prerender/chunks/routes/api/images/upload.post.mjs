import{defineEventHandler as a,readMultipartFormData as e,createError as s}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{mkdir as t,writeFile as i}from"node:fs/promises";import{join as o,extname as m}from"node:path";import{v as r}from"../../../_/v4.mjs";import"node:crypto";const c=a((async a=>{try{const c=await e(a);if(!c||0===c.length)throw s({statusCode:400,statusMessage:"No files uploaded"});const p=[],l=o(process.cwd(),"public","images","packages","imported");await t(l,{recursive:!0});for(const a of c)if(a.data&&a.filename){const e=m(a.filename),s=`${r()}${e}`,c=o(l,s);await i(c,a.data);const n=`thumb_${s}`,d=o(process.cwd(),"public","images","packages","thumbnails",n);await t(o(process.cwd(),"public","images","packages","thumbnails"),{recursive:!0}),await i(d,a.data),p.push({originalName:a.filename,filename:s,thumbnail:n,path:`/images/packages/imported/${s}`,thumbnailPath:`/images/packages/thumbnails/${n}`,size:a.data.length,type:a.type||"image/jpeg"})}return{success:!0,message:"Images uploaded successfully",files:p}}catch(a){throw console.error("Error uploading images:",a),s({statusCode:500,statusMessage:"Failed to upload images"})}}));export{c as default};
//# sourceMappingURL=upload.post.mjs.map
