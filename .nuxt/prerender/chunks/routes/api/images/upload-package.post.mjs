import{defineEventHandler as e,readMultipartFormData as s,createError as a}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{mkdir as t,writeFile as o}from"node:fs/promises";import{join as i,extname as r}from"node:path";import{v as m}from"../../../_/v4.mjs";import"node:crypto";const d=e((async e=>{try{const d=await s(e);if(!d||0===d.length)throw a({statusCode:400,statusMessage:"No files uploaded"});const c=d.find((e=>"image"===e.name));if(!c||!c.data||!c.filename)throw a({statusCode:400,statusMessage:"Image file is missing or invalid"});const n=i(process.cwd(),"public","images","packages");await t(n,{recursive:!0});const g=r(c.filename),l=`${m()}${g}`,p=i(n,l);await o(p,c.data);return{success:!0,message:"Image uploaded successfully",data:{url:`/images/packages/${l}`}}}catch(e){throw console.error("Error uploading package image:",e),a({statusCode:500,statusMessage:e.message||"Failed to upload package image"})}}));export{d as default};
//# sourceMappingURL=upload-package.post.mjs.map
