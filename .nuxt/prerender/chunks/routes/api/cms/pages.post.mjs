import{defineEventHandler as e,readBody as i,createError as s}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{executeQuery as t}from"../../../_/database.mjs";import"../../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const n=e((async e=>{try{const n=await i(e),{slug:o,title:d,meta_title:l,meta_description:r,meta_keywords:a,status:m="draft",template:u="default",created_by:c=1}=n;if(!o||!d)throw s({statusCode:400,statusMessage:"Slug and title are required"});if((await t("SELECT id FROM cms_pages WHERE slug = ?",[o])).length>0)throw s({statusCode:400,statusMessage:"Page with this slug already exists"});const g="\n      INSERT INTO cms_pages \n      (slug, title, meta_title, meta_description, meta_keywords, status, template, created_by, updated_by)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ",p=[o,d,l||null,r||null,a||null,m,u,c,c],f=(await t(g,p)).insertId;return{success:!0,data:{page:(await t("SELECT * FROM cms_pages WHERE id = ?",[f]))[0]},message:"Page created successfully"}}catch(e){if(console.error("Error creating page:",e),e.statusCode)throw e;throw s({statusCode:500,statusMessage:"Error creating page"})}}));export{n as default};
//# sourceMappingURL=pages.post.mjs.map
