import{defineEventHandler as e,getQuery as n,createError as i}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{executeQuery as o}from"../../../_/database.mjs";import"../../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const s=e((async e=>{try{const i=n(e),{menu_name:s,active_only:d=!0}=i;let t="\n      SELECT \n        n.*,\n        p.slug as page_slug,\n        p.title as page_title\n      FROM cms_navigation n\n      LEFT JOIN cms_pages p ON n.page_id = p.id\n      WHERE 1=1\n    ";const r=[];s&&(t+=" AND n.menu_name = ?",r.push(s)),"true"===d&&(t+=" AND n.is_active = 1"),t+=" ORDER BY n.menu_name, n.order_index ASC";const m=await o(t,r),l=new Map,a=[];for(const e of m)l.set(e.id,{...e,children:[]});for(const e of m)if(e.parent_id){const n=l.get(e.parent_id);n&&n.children.push(l.get(e.id))}else a.push(l.get(e.id));return{success:!0,data:{menus:a.reduce(((e,n)=>(e[n.menu_name]||(e[n.menu_name]=[]),e[n.menu_name].push(n),e)),{}),flat:m}}}catch(e){throw console.error("Error fetching navigation:",e),i({statusCode:500,statusMessage:"Error fetching navigation"})}}));export{s as default};
//# sourceMappingURL=navigation.get.mjs.map
