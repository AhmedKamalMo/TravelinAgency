import{defineEventHandler as e,readBody as i,createError as n}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{e as s}from"../../../_/database.mjs";import"../../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const o=e((async e=>{try{const o=await i(e),{page_id:t,section_type:d,title:r,subtitle:l,content:m,background_color:a,background_image:c,text_color:u,order_index:g=0,settings:p={}}=o;if(!t||!d)throw n({statusCode:400,statusMessage:"Page ID and section type are required"});if(0===(await s("SELECT id FROM cms_pages WHERE id = ?",[t])).length)throw n({statusCode:404,statusMessage:"Page not found"});const _="\n      INSERT INTO cms_sections \n      (page_id, section_type, title, subtitle, content, background_color, background_image, text_color, order_index, settings)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ",f=[t,d,r||null,l||null,m||null,a||null,c||null,u||null,g,JSON.stringify(p)],y=(await s(_,f)).insertId,j=await s("SELECT * FROM cms_sections WHERE id = ?",[y]);return j[0].settings&&(j[0].settings=JSON.parse(j[0].settings)),{success:!0,data:{section:j[0]},message:"Section created successfully"}}catch(e){if(console.error("Error creating section:",e),e.statusCode)throw e;throw n({statusCode:500,statusMessage:"Error creating section"})}}));export{o as default};
//# sourceMappingURL=sections.post.mjs.map
