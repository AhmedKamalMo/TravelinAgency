import{defineEventHandler as e,readBody as i,createError as n}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{e as o}from"../../../_/database.mjs";import"../../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const t=e((async e=>{var t,s,r,l,d,m;const a=await i(e);try{const e=(a.title_ar||a.title||"new-page").toLowerCase().replace(/[^a-z0-9\u0600-\u06FF\s]/g,"").replace(/\s+/g,"-").substring(0,50),i=(await o("\n      INSERT INTO cms_pages (\n        slug,\n        title, \n        meta_title, \n        meta_description, \n        status, \n        template, \n        created_by\n      ) VALUES (?, ?, ?, ?, ?, ?, ?)\n    ",[e,a.title_ar||a.title||"",a.title_en||a.meta_title||"",a.meta_description_ar||a.meta_description||"",a.status||"draft",a.template||"default",1])).insertId;if(a.components&&Array.isArray(a.components))for(let e=0;e<a.components.length;e++){const n=a.components[e];await o("\n          INSERT INTO cms_sections (\n            page_id, section_type, title, subtitle, content,\n            background_color, background_image, text_color, order_index, is_active, settings\n          ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n        ",[i,n.type||"generic",(null==(t=n.props)?void 0:t.title)||"",(null==(s=n.props)?void 0:s.subtitle)||"",(null==(r=n.props)?void 0:r.content)||"",(null==(l=n.props)?void 0:l.backgroundColor)||"",(null==(d=n.props)?void 0:d.backgroundImage)||"",(null==(m=n.props)?void 0:m.textColor)||"",e,!0,JSON.stringify(n.props||{})])}return{success:!0,message:"Page created successfully",id:i}}catch(e){throw console.error("Error creating page:",e),n({statusCode:500,statusMessage:"Failed to create page"})}}));export{t as default};
//# sourceMappingURL=editor.post.mjs.map
