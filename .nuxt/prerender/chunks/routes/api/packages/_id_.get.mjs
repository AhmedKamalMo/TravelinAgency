import{defineEventHandler as e,getRouterParam as i,createError as t}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{executeQuery as n}from"../../../_/database.mjs";import"../../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const a=e((async e=>{try{const a=i(e,"id");if(!a)throw t({statusCode:400,statusMessage:"Package ID is required"});try{const e=await n("\n        SELECT \n          id, \n          title_ar,\n          title_en,\n          description_ar,\n          description_en,\n          price,\n          duration_days as duration,\n          image_url as image,\n          travel_period as location,\n          max_persons,\n          featured,\n          active as status,\n          created_at,\n          updated_at\n        FROM packages \n        WHERE numeric_id = ? OR id = ?\n      ",[a,a]);if(e&&e.length>0){const i=e[0];return{package:{id:i.id,title:i.title_ar||i.title_en,title_ar:i.title_ar,title_en:i.title_en,description:i.description_ar||i.description_en,description_ar:i.description_ar,description_en:i.description_en,price:i.price,duration:`${i.duration} days`,duration_days:i.duration,image:i.image,image_url:i.image,destination:i.location,location:i.location,travel_period:i.location,max_persons:i.max_persons||10,category:"international",featured:i.featured,status:1===i.status?"active":"inactive",features:[],itinerary:[],included:[],excluded:[],created_at:i.created_at,updated_at:i.updated_at}}}}catch(e){console.log("Database package not available, trying local data...")}try{const e=await import("node:fs"),i=(await import("node:path")).join(process.cwd(),"public","packages-with-local-images.json"),t=e.readFileSync(i,"utf8"),n=JSON.parse(t).find((e=>e.id===parseInt(a)));if(n)return{package:{id:n.id,title:n.title,title_ar:n.title,title_en:n.title,description:n.description,description_ar:n.description,description_en:n.description,price:n.price,duration:n.duration,duration_days:7,image:n.image,image_url:n.image,destination:n.destination,location:n.destination,travel_period:n.destination,max_persons:10,category:"international",featured:n.featured,status:n.status,features:[],itinerary:[],included:[],excluded:[],created_at:n.created_at,updated_at:n.updated_at}}}catch(e){console.log("Local package not available")}throw t({statusCode:404,statusMessage:"Package not found"})}catch(e){if(console.error("Error fetching package:",e),e.statusCode)throw e;throw t({statusCode:500,statusMessage:"Failed to fetch package"})}}));export{a as default};
//# sourceMappingURL=_id_.get.mjs.map
