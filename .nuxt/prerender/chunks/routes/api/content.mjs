import{defineEventHandler as e,getMethod as t,createError as n,readBody as i}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{e as s}from"../../_/database.mjs";import"../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const o=e((async e=>{switch(t(e)){case"GET":return await async function(){try{return{success:!0,pages:(await s("\n        SELECT \n          id, \n          title,\n          meta_title,\n          meta_description,\n          'page' as type,\n          status,\n          template,\n          created_at,\n          updated_at\n        FROM cms_pages \n        ORDER BY created_at DESC\n      ")).map((e=>({id:e.id,title:e.title,title_ar:e.title,title_en:e.meta_title||e.title,content:e.meta_description||"",content_ar:e.meta_description||"",content_en:e.meta_description||"",type:e.type,status:e.status,template:e.template,created_at:e.created_at,updated_at:e.updated_at})))}}catch(e){return console.error("Error fetching content pages:",e),{success:!1,error:"Failed to fetch content pages",pages:[]}}}();case"POST":return await async function(e){try{const t=await i(e);if(!(t.title_ar&&t.title_en&&t.content_ar&&t.content_en))throw n({statusCode:400,statusMessage:"Missing required fields"});return{success:!0,message:"Content page created successfully",id:(await s("\n      INSERT INTO cms_pages (\n        title, meta_title, meta_description, \n        status, template, created_by\n      ) VALUES (?, ?, ?, ?, ?, ?)\n    ",[t.title_ar||t.title,t.title_en||t.meta_title,t.content_ar||t.meta_description,t.status||"draft",t.template||"default",1])).insertId}}catch(e){return console.error("Error creating content page:",e),{success:!1,error:"Failed to create content page"}}}(e);default:throw n({statusCode:405,statusMessage:"Method not allowed"})}}));export{o as default};
//# sourceMappingURL=content.mjs.map
