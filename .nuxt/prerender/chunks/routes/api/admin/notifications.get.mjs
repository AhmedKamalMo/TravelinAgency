import{defineEventHandler as e}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{e as n}from"../../../_/database.mjs";import"../../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const i=e((async e=>{try{console.log("üîî Fetching admin notifications...");const e=await n("\n      SELECT \n        id,\n        name,\n        email,\n        phone,\n        message,\n        'contact' as type,\n        'ÿ±ÿ≥ÿßŸÑÿ© ÿ™ŸàÿßÿµŸÑ ÿ¨ÿØŸäÿØÿ©' as title,\n        'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ÿ™ŸàÿßÿµŸÑ ÿ¨ÿØŸäÿØÿ© ŸÖŸÜ ÿßŸÑÿπŸÖŸäŸÑ' as description,\n        created_at,\n        is_read\n      FROM contact_messages \n      WHERE is_read = 0\n      ORDER BY created_at DESC\n      LIMIT 10\n    "),i=await n("\n      SELECT \n        id,\n        name,\n        email,\n        phone,\n        message,\n        package_name,\n        'package' as type,\n        'ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿπŸÜ ÿ®ÿßŸÇÿ© ÿ¨ÿØŸäÿØÿ©' as title,\n        CONCAT('ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿ¨ÿØŸäÿØ ÿπŸÜ ÿ®ÿßŸÇÿ©: ', package_name) as description,\n        created_at,\n        is_read\n      FROM package_inquiries \n      WHERE is_read = 0\n      ORDER BY created_at DESC\n      LIMIT 10\n    "),t=await n("\n      SELECT \n        id,\n        name,\n        email,\n        phone,\n        message,\n        destination_name,\n        'destination' as type,\n        'ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿπŸÜ Ÿàÿ¨Ÿáÿ© ÿ¨ÿØŸäÿØÿ©' as title,\n        CONCAT('ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ± ÿ¨ÿØŸäÿØ ÿπŸÜ Ÿàÿ¨Ÿáÿ©: ', destination_name) as description,\n        created_at,\n        is_read\n      FROM destination_inquiries \n      WHERE is_read = 0\n      ORDER BY created_at DESC\n      LIMIT 10\n    "),a=await n("\n      SELECT \n        id,\n        customer_name as name,\n        customer_email as email,\n        customer_phone as phone,\n        'ÿ≠ÿ¨ÿ≤ ÿ¨ÿØŸäÿØ' as message,\n        package_name,\n        'booking' as type,\n        'ÿ≠ÿ¨ÿ≤ ÿ¨ÿØŸäÿØ' as title,\n        CONCAT('ÿ≠ÿ¨ÿ≤ ÿ¨ÿØŸäÿØ ŸÑŸÑÿ®ÿßŸÇÿ©: ', package_name) as description,\n        created_at,\n        is_read\n      FROM bookings \n      WHERE is_read = 0\n      ORDER BY created_at DESC\n      LIMIT 10\n    "),s=[...e,...i,...t,...a].sort(((e,n)=>new Date(n.created_at).getTime()-new Date(e.created_at).getTime())),o=s.filter((e=>!e.is_read)).length;return{success:!0,data:{notifications:s.slice(0,20),totalUnread:o,counts:{contact:e.length,package:i.length,destination:t.length,booking:a.length}}}}catch(e){return console.error("‚ùå Error fetching admin notifications:",e),{success:!0,data:{notifications:[],totalUnread:0,counts:{contact:0,package:0,destination:0,booking:0}}}}}));export{i as default};
//# sourceMappingURL=notifications.get.mjs.map
