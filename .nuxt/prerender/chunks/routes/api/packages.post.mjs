import{defineEventHandler as e,readBody as i,createError as n}from"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import{e as t}from"../../_/database.mjs";import"../../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue/index.mjs";import"node:fs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/mysql2/promise.js";import"file://F:/TravelinAgency/node_modules/bcryptjs/index.js";import"file://F:/TravelinAgency/node_modules/jsonwebtoken/index.js";const r=e((async e=>{try{const r=await i(e);if(!(r.title_ar&&r.title_en&&r.description_ar&&r.description_en))throw n({statusCode:400,statusMessage:"Title and description in both languages are required"});const s=await t("\n      INSERT INTO packages (\n        title_ar,\n        title_en,\n        description_ar,\n        description_en,\n        price,\n        duration_days,\n        travel_period,\n        max_persons,\n        image_url,\n        featured,\n        active,\n        created_at,\n        updated_at\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)\n    ",[r.title_ar,r.title_en,r.description_ar,r.description_en,r.price||0,r.duration_days||1,r.travel_period||"",r.max_persons||10,r.image_url||"",r.featured?1:0,"active"===r.status?1:0]),a=await t("\n      SELECT \n        id, \n        title_ar,\n        title_en,\n        description_ar,\n        description_en,\n        price,\n        duration_days as duration,\n        image_url as image,\n        travel_period as location,\n        featured,\n        active as status,\n        created_at,\n        updated_at\n      FROM packages \n      WHERE id = ?\n    ",[s.insertId]);if(!a||0===a.length)throw n({statusCode:500,statusMessage:"Failed to retrieve created package"});const d=a[0];return{success:!0,id:d.id,package:{id:d.id,image_url:d.image,title_ar:d.title_ar,title_en:d.title_en,description_ar:d.description_ar,description_en:d.description_en,travel_period:d.location,duration_days:d.duration,price:d.price,max_persons:10,featured:d.featured,location:d.location,status:d.status,created_at:d.created_at,updated_at:d.updated_at}}}catch(e){if(console.error("Error creating package:",e),e.statusCode)throw e;throw n({statusCode:500,statusMessage:"Failed to create package"})}}));export{r as default};
//# sourceMappingURL=packages.post.mjs.map
