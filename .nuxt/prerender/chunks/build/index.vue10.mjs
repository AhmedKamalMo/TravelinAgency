import{i as e}from"./AdminPageHeader.vue.mjs";import{q as t}from"./index2.mjs";import{M as l}from"./nuxt-link.mjs";import{d as s}from"./AdminStats.vue.mjs";import{t as a,l as n,u as i}from"./AdminSelect.vue.mjs";import{ref as o,computed as d,watch as r,mergeProps as m,withCtx as u,createVNode as c,unref as p,isRef as v,createTextVNode as g,useSSRContext as x}from"file://F:/TravelinAgency/node_modules/vue/index.mjs";import{ssrRenderAttrs as y,ssrRenderComponent as b,ssrRenderList as h,ssrInterpolate as f,ssrRenderClass as w,ssrIncludeBooleanAttr as _}from"file://F:/TravelinAgency/node_modules/vue/server-renderer/index.mjs";import{p as j}from"./useExcelExport.mjs";import{H as A}from"./server.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/css/icon.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/vue/dist/iconify.mjs";import"F:\\TravelinAgency\\node_modules\\xlsx\\dist\\cpexcel.js";import"node:fs";import"node:stream";import"file://F:/TravelinAgency/node_modules/hookable/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unctx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/h3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue-router/dist/vue-router.node.mjs";import"file://F:/TravelinAgency/node_modules/radix3/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/defu/dist/defu.mjs";import"file://F:/TravelinAgency/node_modules/klona/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/nuxt/node_modules/cookie-es/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/destr/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ohash/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/vue-devtools-stub/dist/index.mjs";import"../_/renderer.mjs";import"file://F:/TravelinAgency/node_modules/vue-bundle-renderer/dist/runtime.mjs";import"../_/nitro.mjs";import"file://F:/TravelinAgency/node_modules/ofetch/dist/node.mjs";import"file://F:/TravelinAgency/node_modules/node-mock-http/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/scule/dist/index.mjs";import"node:url";import"file://F:/TravelinAgency/node_modules/pathe/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@iconify/utils/lib/index.mjs";import"file://F:/TravelinAgency/node_modules/consola/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/ipx/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs.mjs";import"file:///F:/TravelinAgency/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js";import"file://F:/TravelinAgency/node_modules/unstorage/drivers/fs-lite.mjs";import"file://F:/TravelinAgency/node_modules/nuxt/node_modules/unhead/dist/server.mjs";import"file://F:/TravelinAgency/node_modules/nuxt/node_modules/unhead/dist/utils.mjs";import"file://F:/TravelinAgency/node_modules/devalue/index.js";import"file://F:/TravelinAgency/node_modules/nuxt/node_modules/unhead/dist/plugins.mjs";import"file://F:/TravelinAgency/node_modules/@unhead/schema-org/dist/index.mjs";import"file://F:/TravelinAgency/node_modules/@unhead/schema-org/dist/vue.mjs";import"file://F:/TravelinAgency/node_modules/floating-vue/dist/floating-vue.mjs";const T={__name:"index",__ssrInlineRender:!0,setup(x){const T=o([]),k=o(!0),F=o(""),$=o(""),V=o(""),C=o(""),L=o(1),D=d((()=>{let e=T.value;if(F.value&&(e=e.filter((e=>{var t,l,s,a;return(null==(t=e.customer_name)?void 0:t.toLowerCase().includes(F.value.toLowerCase()))||(null==(l=e.customer_email)?void 0:l.toLowerCase().includes(F.value.toLowerCase()))||(null==(s=e.booking_number)?void 0:s.toLowerCase().includes(F.value.toLowerCase()))||(null==(a=e.package_title)?void 0:a.toLowerCase().includes(F.value.toLowerCase()))}))),$.value&&(e=e.filter((e=>e.status===$.value))),V.value&&(e=e.filter((e=>e.payment_status===V.value))),C.value){const t=new Date,l=new Date(t.getFullYear(),t.getMonth(),t.getDate()),s=new Date(l.getTime()-6048e5),a=new Date(l.getTime()-2592e6);e=e.filter((e=>{const t=new Date(e.created_at);switch(C.value){case"today":return t>=l;case"week":return t>=s;case"month":return t>=a;default:return!0}}))}return e.slice(10*(L.value-1),10*L.value)})),U=d((()=>{let e=T.value;if(F.value&&(e=e.filter((e=>{var t,l,s,a;return(null==(t=e.customer_name)?void 0:t.toLowerCase().includes(F.value.toLowerCase()))||(null==(l=e.customer_email)?void 0:l.toLowerCase().includes(F.value.toLowerCase()))||(null==(s=e.booking_number)?void 0:s.toLowerCase().includes(F.value.toLowerCase()))||(null==(a=e.package_title)?void 0:a.toLowerCase().includes(F.value.toLowerCase()))}))),$.value&&(e=e.filter((e=>e.status===$.value))),V.value&&(e=e.filter((e=>e.payment_status===V.value))),C.value){const t=new Date,l=new Date(t.getFullYear(),t.getMonth(),t.getDate()),s=new Date(l.getTime()-6048e5),a=new Date(l.getTime()-2592e6);e=e.filter((e=>{const t=new Date(e.created_at);switch(C.value){case"today":return t>=l;case"week":return t>=s;case"month":return t>=a;default:return!0}}))}return e.length})),S=d((()=>Math.ceil(U.value/10))),B=d((()=>T.value.length)),M=d((()=>T.value.filter((e=>"confirmed"===e.status)).length)),E=d((()=>T.value.filter((e=>"pending"===e.status)).length)),R=d((()=>T.value.filter((e=>"cancelled"===e.status)).length)),H=d((()=>T.value.reduce(((e,t)=>e+(t.total_amount||0)),0))),Y=d((()=>[{key:"total",label:"إجمالي الحجوزات",value:B.value,icon:"material-symbols:book-online",iconBg:"bg-blue-100",iconColor:"text-blue-600"},{key:"confirmed",label:"مؤكدة",value:M.value,icon:"material-symbols:check-circle",iconBg:"bg-green-100",iconColor:"text-green-600"},{key:"pending",label:"في الانتظار",value:E.value,icon:"material-symbols:schedule",iconBg:"bg-orange-100",iconColor:"text-orange-600"},{key:"cancelled",label:"ملغية",value:R.value,icon:"material-symbols:cancel",iconBg:"bg-red-100",iconColor:"text-red-600"},{key:"revenue",label:"إجمالي المبيعات",value:M$1(H.value),icon:"material-symbols:attach-money",iconBg:"bg-purple-100",iconColor:"text-purple-600"}])),N=d((()=>[{value:"confirmed",label:"مؤكدة"},{value:"pending",label:"في الانتظار"},{value:"cancelled",label:"ملغية"},{value:"completed",label:"مكتملة"}])),P=d((()=>[{value:"paid",label:"مدفوع"},{value:"pending",label:"في الانتظار"},{value:"failed",label:"فشل"}])),W=d((()=>[{value:"today",label:"اليوم"},{value:"week",label:"هذا الأسبوع"},{value:"month",label:"هذا الشهر"}])),K=()=>{try{const{exportBookingsToExcel:e}=j();e(T.value)?console.log("تم تصدير الحجوزات بنجاح"):console.error("فشل في تصدير الحجوزات")}catch(e){console.error("خطأ في تصدير الحجوزات:",e)}},M$1=e=>new Intl.NumberFormat("ar-SA",{style:"currency",currency:"SAR"}).format(e),I=e=>({confirmed:"bg-green-100 text-green-800",pending:"bg-orange-100 text-orange-800",cancelled:"bg-red-100 text-red-800",completed:"bg-blue-100 text-blue-800"}[e]||"bg-gray-100 text-gray-800"),te=e=>({paid:"bg-green-100 text-green-800",pending:"bg-orange-100 text-orange-800",failed:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return r([F,$,V,C],(()=>{L.value=1})),A({title:"إدارة الحجوزات - Wonder Land Admin",meta:[{name:"description",content:"عرض وإدارة حجوزات العملاء"},{name:"robots",content:"noindex, nofollow"}]}),(o,d,r,x)=>{const j=e,A=t,T=l,B=s,M=a,E=n,R=i;d(`<div${y(m({class:"space-y-6"},x))}><div class="h-16"></div>`),d(b(j,{title:"إدارة الحجوزات",description:"عرض وإدارة حجوزات العملاء"},{actions:u(((e,t,l,s)=>{if(!t)return[c("button",{onClick:K,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"},[c(A,{name:"material-symbols:download",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),c("span",{class:"hidden sm:inline"},"تصدير البيانات"),c("span",{class:"sm:hidden"},"تصدير")]),c(T,{to:"/admin/bookings/create",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"},{default:u((()=>[c(A,{name:"material-symbols:add",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),c("span",{class:"hidden sm:inline"},"إضافة حجز جديد"),c("span",{class:"sm:hidden"},"إضافة")])),_:1})];t(`<button class="inline-flex items-center px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"${s}>`),t(b(A,{name:"material-symbols:download",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"},null,l,s)),t(`<span class="hidden sm:inline"${s}>تصدير البيانات</span><span class="sm:hidden"${s}>تصدير</span></button>`),t(b(T,{to:"/admin/bookings/create",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"},{default:u(((e,t,l,s)=>{if(!t)return[c(A,{name:"material-symbols:add",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),c("span",{class:"hidden sm:inline"},"إضافة حجز جديد"),c("span",{class:"sm:hidden"},"إضافة")];t(b(A,{name:"material-symbols:add",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"},null,l,s)),t(`<span class="hidden sm:inline"${s}>إضافة حجز جديد</span><span class="sm:hidden"${s}>إضافة</span>`)})),_:1},l,s))})),_:1},r)),d(b(B,{stats:p(Y)},null,r)),d(b(M,null,{default:u(((e,t,l,s)=>{if(!t)return[c(E,{modelValue:p(F),"onUpdate:modelValue":e=>v(F)?F.value=e:null,placeholder:"البحث في الحجوزات..."},null,8,["modelValue","onUpdate:modelValue"]),c(R,{modelValue:p($),"onUpdate:modelValue":e=>v($)?$.value=e:null,options:p(N),placeholder:"جميع الحالات"},null,8,["modelValue","onUpdate:modelValue","options"]),c(R,{modelValue:p(V),"onUpdate:modelValue":e=>v(V)?V.value=e:null,options:p(P),placeholder:"جميع أنواع الدفع"},null,8,["modelValue","onUpdate:modelValue","options"]),c(R,{modelValue:p(C),"onUpdate:modelValue":e=>v(C)?C.value=e:null,options:p(W),placeholder:"جميع التواريخ"},null,8,["modelValue","onUpdate:modelValue","options"])];t(b(E,{modelValue:p(F),"onUpdate:modelValue":e=>v(F)?F.value=e:null,placeholder:"البحث في الحجوزات..."},null,l,s)),t(b(R,{modelValue:p($),"onUpdate:modelValue":e=>v($)?$.value=e:null,options:p(N),placeholder:"جميع الحالات"},null,l,s)),t(b(R,{modelValue:p(V),"onUpdate:modelValue":e=>v(V)?V.value=e:null,options:p(P),placeholder:"جميع أنواع الدفع"},null,l,s)),t(b(R,{modelValue:p(C),"onUpdate:modelValue":e=>v(C)?C.value=e:null,options:p(W),placeholder:"جميع التواريخ"},null,l,s))})),_:1},r)),d('<div class="bg-white rounded-lg shadow-sm border border-gray-200">'),p(k)?(d('<div class="flex justify-center items-center py-12">'),d(b(A,{name:"material-symbols:progress-activity",class:"animate-spin h-8 w-8 text-blue-600"},null,r)),d('<span class="mr-3 text-gray-600">جارٍ تحميل الحجوزات...</span></div>')):p(D).length>0?(d('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> الحجز </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> العميل </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> الباقة </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> الحالة </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> المبلغ </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> تاريخ الحجز </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"> الإجراءات </th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e'),h(p(D),(e=>{d('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10"><div class="h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center">'),d(b(A,{name:"material-symbols:book-online",class:"h-6 w-6 text-blue-600"},null,r)),d(`</div></div><div class="mr-4"><div class="text-sm font-medium text-gray-900">#${f(e.booking_number||e.id)}</div><div class="text-sm text-gray-500">${f(e.adults+e.children)} أشخاص</div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900">${f(e.customer_name)}</div><div class="text-sm text-gray-500">${f(e.customer_email)}</div><div class="text-sm text-gray-500">${f(e.customer_phone)}</div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900">${f(e.package_title)}</div><div class="text-sm text-gray-500">${f(e.travel_date)}</div></td><td class="px-6 py-4 whitespace-nowrap"><span class="${w([I(e.status),"px-2 py-1 text-xs font-medium rounded-full"])}">${f((e=>({confirmed:"مؤكدة",pending:"في الانتظار",cancelled:"ملغية",completed:"مكتملة"}[e]||e))(e.status))}</span>`),e.payment_status?d(`<div class="mt-1"><span class="${w([te(e.payment_status),"px-2 py-1 text-xs font-medium rounded-full"])}">${f((e=>({paid:"مدفوع",pending:"في الانتظار",failed:"فشل"}[e]||e))(e.payment_status))}</span></div>`):d("\x3c!----\x3e"),d(`</td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900">${f(M$1(e.total_amount))}</div><div class="text-sm text-gray-500">${f(e.currency||"SAR")}</div></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${f((e=>new Date(e).toLocaleDateString("ar-SA"))(e.created_at))}</td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><div class="flex items-center space-x-2 space-x-reverse">`),d(b(T,{to:`/admin/bookings/${e.id}`,class:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"عرض"},{default:u(((e,t,l,s)=>{if(!t)return[c(A,{name:"material-symbols:visibility",class:"h-4 w-4"})];t(b(A,{name:"material-symbols:visibility",class:"h-4 w-4"},null,l,s))})),_:2},r)),d(b(T,{to:`/admin/bookings/${e.id}/edit`,class:"text-green-600 hover:text-green-900 p-1 rounded",title:"تحرير"},{default:u(((e,t,l,s)=>{if(!t)return[c(A,{name:"material-symbols:edit",class:"h-4 w-4"})];t(b(A,{name:"material-symbols:edit",class:"h-4 w-4"},null,l,s))})),_:2},r)),d('<button class="text-red-600 hover:text-red-900 p-1 rounded" title="حذف">'),d(b(A,{name:"material-symbols:delete",class:"h-4 w-4"},null,r)),d("</button></div></td></tr>")})),d("\x3c!--]--\x3e</tbody></table></div>")):(d('<div class="text-center py-12">'),d(b(A,{name:"material-symbols:book-online",class:"h-16 w-16 text-gray-300 mx-auto mb-4"},null,r)),d('<h3 class="text-lg font-medium text-gray-900 mb-2">لا توجد حجوزات</h3><p class="text-gray-500 mb-6">لم يتم العثور على أي حجوزات</p>'),d(b(T,{to:"/admin/bookings/create",class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},{default:u(((e,t,l,s)=>{if(!t)return[c(A,{name:"material-symbols:add",class:"h-5 w-5 ml-2"}),g(" إضافة حجز جديد ")];t(b(A,{name:"material-symbols:add",class:"h-5 w-5 ml-2"},null,l,s)),t(" إضافة حجز جديد ")})),_:1},r)),d("</div>")),d("</div>"),p(S)>1?d(`<div class="flex items-center justify-between"><div class="text-sm text-gray-700"> عرض ${f(10*(p(L)-1)+1)} إلى ${f(Math.min(10*p(L),p(U)))} من أصل ${f(p(U))} حجز </div><div class="flex space-x-1 space-x-reverse"><button${_(1===p(L))?" disabled":""} class="px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> السابق </button><span class="px-3 py-2 text-sm bg-blue-600 text-white border border-blue-600 rounded-md">${f(p(L))}</span><button${_(p(L)===p(S))?" disabled":""} class="px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> التالي </button></div></div>`):d("\x3c!----\x3e"),d("</div>")}}},k=T.setup;T.setup=(e,t)=>{const l=x();return(l.modules||(l.modules=new Set)).add("pages/admin/bookings/index.vue"),k?k(e,t):void 0};export{T as default};
//# sourceMappingURL=index.vue10.mjs.map
