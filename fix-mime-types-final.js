#!/usr/bin/env node

console.log('ðŸ”§ FINAL FIX FOR MIME TYPES - SPECIFIC REWRITE APPROACH');
console.log('=======================================================\n');

console.log('ðŸ“‹ FINAL .HTACCESS WITH SPECIFIC MIME TYPE HANDLING:');
console.log('=====================================================');
console.log('');
console.log('# 1. Create .htaccess with specific MIME type handling');
console.log('cat > .htaccess << "EOF"');
console.log('RewriteEngine On');
console.log('');
console.log('# Handle API routes first');
console.log('RewriteCond %{REQUEST_URI} ^/api/');
console.log('RewriteRule ^(.*)$ /api-handler.php [QSA,L]');
console.log('');
console.log('# Handle CSS files with proper MIME type');
console.log('RewriteCond %{REQUEST_URI} ^/_nuxt/.*\\.css$');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L,T=text/css]');
console.log('');
console.log('# Handle JS files with proper MIME type');
console.log('RewriteCond %{REQUEST_URI} ^/_nuxt/.*\\.js$');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L,T=application/javascript]');
console.log('');
console.log('# Handle other _nuxt assets');
console.log('RewriteCond %{REQUEST_URI} ^/_nuxt/');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Handle static CSS files');
console.log('RewriteCond %{REQUEST_URI} \\.css$');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L,T=text/css]');
console.log('');
console.log('# Handle static JS files');
console.log('RewriteCond %{REQUEST_URI} \\.js$');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L,T=application/javascript]');
console.log('');
console.log('# Handle other static files');
console.log('RewriteCond %{REQUEST_URI} \\.(jpg|jpeg|png|gif|webp|svg|ico|woff|woff2|ttf|eot)$');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Serve index.html for all other requests');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{REQUEST_FILENAME} !-d');
console.log('RewriteRule ^(.*)$ /index.html [QSA,L]');
console.log('EOF');
console.log('');
console.log('# 2. Alternative: Create a simple .htaccess that works');
console.log('cat > .htaccess << "EOF"');
console.log('RewriteEngine On');
console.log('');
console.log('# API routes');
console.log('RewriteCond %{REQUEST_URI} ^/api/');
console.log('RewriteRule ^(.*)$ /api-handler.php [QSA,L]');
console.log('');
console.log('# _nuxt assets - serve directly');
console.log('RewriteCond %{REQUEST_URI} ^/_nuxt/');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Static files - serve directly');
console.log('RewriteCond %{REQUEST_URI} \\.(css|js|jpg|jpeg|png|gif|webp|svg|ico|woff|woff2|ttf|eot)$');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Everything else goes to index.html');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{REQUEST_FILENAME} !-d');
console.log('RewriteRule ^(.*)$ /index.html [QSA,L]');
console.log('EOF');
console.log('');
console.log('# 3. Test the MIME types');
console.log('curl -k -I https://travelin-agency-nlcs.vercel.app/_nuxt/entry.Cjk20dY-.css');
console.log('curl -k -I https://travelin-agency-nlcs.vercel.app/_nuxt/2Q_rtp48.js');
console.log('');
console.log('# 4. Test the website');
console.log('curl -k -I https://travelin-agency-nlcs.vercel.app/');
console.log('');
console.log('ðŸŽ¯ This approach will:');
console.log('âœ… Use T= parameter to set MIME types in rewrite rules');
console.log('âœ… Handle CSS and JS files specifically');
console.log('âœ… Fall back to simple approach if needed');
console.log('âœ… Ensure proper content-type headers');
console.log('');
console.log('ðŸ”§ The T= parameter in RewriteRule:');
console.log('â€¢ T=text/css sets Content-Type: text/css');
console.log('â€¢ T=application/javascript sets Content-Type: application/javascript');
console.log('â€¢ This overrides any default MIME type settings');
