import z from"./CiRDkbrd.js";import{_ as Z}from"./KJx1jOS2.js";import{_ as K}from"./D1wqOqmS.js";import{_ as Q}from"./BQGBBHRY.js";import{h as m,B as c,R as q,m as G,K as J,c as x,o as v,a as s,b as n,f as X,w as g,i as r,k,v as Y,Z as L,T as D,F as ee,r as te,t as p,H as S,d as se}from"./CNW6Qy33.js";import{u as oe}from"./Dp9yiPXt.js";const ae={class:"space-y-6"},ne={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},le={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},re={class:"relative"},ie={class:"bg-white rounded-lg shadow-sm border border-gray-200"},de={key:0,class:"flex justify-center items-center py-12"},ue={key:1,class:"overflow-x-auto"},ce={class:"min-w-full divide-y divide-gray-200"},me={class:"bg-white divide-y divide-gray-200"},ge={class:"px-6 py-4 whitespace-nowrap"},pe={class:"flex items-center"},be={class:"flex-shrink-0 h-10 w-10"},ye={class:"h-10 w-10 rounded-lg bg-gray-300 flex items-center justify-center"},xe={class:"mr-4"},ve={class:"text-sm font-medium text-gray-900"},he={class:"text-sm text-gray-500"},fe={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ce={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ke={class:"flex items-center space-x-2 space-x-reverse"},Le=["onClick","title"],Se=["onClick"],Pe={key:2,class:"text-center py-12"},Ae={key:0,class:"flex items-center justify-between"},$e={class:"text-sm text-gray-700"},De={class:"flex space-x-1 space-x-reverse"},Ne=["disabled"],je={class:"px-3 py-2 text-sm bg-blue-600 text-white border border-blue-600 rounded-md"},Be=["disabled"],h=10,Fe={__name:"index",setup(Ie){const l=m([]),w=m(!0),i=m(""),b=m(""),y=m(""),d=m(1),P=c(()=>{let t=l.value;return i.value&&(t=t.filter(e=>e.title_ar&&e.title_ar.toLowerCase().includes(i.value.toLowerCase())||e.title_en&&e.title_en.toLowerCase().includes(i.value.toLowerCase())||e.title&&e.title.toLowerCase().includes(i.value.toLowerCase())||e.content_ar&&e.content_ar.toLowerCase().includes(i.value.toLowerCase())||e.content_en&&e.content_en.toLowerCase().includes(i.value.toLowerCase())||e.content&&e.content.toLowerCase().includes(i.value.toLowerCase()))),b.value&&(t=t.filter(e=>e.status===b.value)),y.value&&(t=t.filter(e=>e.type===y.value)),t.slice((d.value-1)*h,d.value*h)}),_=c(()=>{let t=l.value;return i.value&&(t=t.filter(e=>e.title_ar&&e.title_ar.toLowerCase().includes(i.value.toLowerCase())||e.title_en&&e.title_en.toLowerCase().includes(i.value.toLowerCase())||e.title&&e.title.toLowerCase().includes(i.value.toLowerCase())||e.content_ar&&e.content_ar.toLowerCase().includes(i.value.toLowerCase())||e.content_en&&e.content_en.toLowerCase().includes(i.value.toLowerCase())||e.content&&e.content.toLowerCase().includes(i.value.toLowerCase()))),b.value&&(t=t.filter(e=>e.status===b.value)),y.value&&(t=t.filter(e=>e.type===y.value)),t.length}),C=c(()=>Math.ceil(_.value/h)),N=c(()=>l.value.length),j=c(()=>l.value.filter(t=>t.status==="published").length),B=c(()=>l.value.filter(t=>t.status==="draft").length),I=c(()=>{const t=new Date;return t.setHours(0,0,0,0),l.value.filter(e=>new Date(e.created_at)>=t).length}),M=c(()=>[{key:"total",label:"إجمالي الصفحات",value:N.value,icon:"material-symbols:article",iconBg:"bg-blue-100",iconColor:"text-blue-600"},{key:"published",label:"منشور",value:j.value,icon:"material-symbols:visibility",iconBg:"bg-green-100",iconColor:"text-green-600"},{key:"draft",label:"مسودة",value:B.value,icon:"material-symbols:edit",iconBg:"bg-orange-100",iconColor:"text-orange-600"},{key:"today",label:"اليوم",value:I.value,icon:"material-symbols:today",iconBg:"bg-purple-100",iconColor:"text-purple-600"}]);c(()=>{const t=l.value.reduce((e,o)=>(e[o.type]=(e[o.type]||0)+1,e),{});return{labels:Object.keys(t).map(e=>A(e)),datasets:[{data:Object.values(t),backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:["rgb(59, 130, 246)","rgb(16, 185, 129)","rgb(245, 158, 11)","rgb(239, 68, 68)"]}]}}),c(()=>{const t=l.value.reduce((e,o)=>(e[o.status]=(e[o.status]||0)+1,e),{});return{labels:Object.keys(t).map(e=>$(e)),datasets:[{data:Object.values(t),backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(245, 158, 11, 0.8)","rgba(107, 114, 128, 0.8)"],borderColor:["rgb(34, 197, 94)","rgb(245, 158, 11)","rgb(107, 114, 128)"]}]}}),c(()=>{const t={},e=["يناير","فبراير","مارس","أبريل","مايو","يونيو"];return e.forEach(o=>{t[o]=0}),l.value.forEach(o=>{if(o.status==="published"){const f=new Date(o.created_at).getMonth();f<6&&t[e[f]]++}}),{labels:e,datasets:[{label:"عدد الصفحات المنشورة",data:Object.values(t),backgroundColor:"rgba(139, 92, 246, 0.8)",borderColor:"rgb(139, 92, 246)",borderWidth:1}]}}),m({plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0}}}}),m({plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0}}}}),m({plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}});const T=async()=>{try{w.value=!0,console.log("🔄 Loading pages from API...");const t=await $fetch("/api/content");console.log("📊 API Response:",t),t&&t.pages&&Array.isArray(t.pages)?(l.value=t.pages,console.log("✅ Loaded pages:",l.value.length)):Array.isArray(t)?(l.value=t,console.log("✅ Loaded pages (direct array):",l.value.length)):(l.value=[],console.log("⚠️ No pages found, using empty array"))}catch(t){console.error("❌ خطأ في تحميل الصفحات:",t),l.value=[{id:1,title_ar:"من نحن",title_en:"About Us",content_ar:"نحن وكالة سفر رائدة في المملكة العربية السعودية",content_en:"We are a leading travel agency in Saudi Arabia",type:"page",status:"published",created_at:new Date().toISOString()},{id:2,title_ar:"أخبار السفر",title_en:"Travel News",content_ar:"أحدث أخبار السفر والسياحة",content_en:"Latest travel and tourism news",type:"news",status:"draft",created_at:new Date(Date.now()-864e5).toISOString()}],console.log("📝 Using fallback data:",l.value.length,"pages")}finally{w.value=!1}},O=async t=>{try{const e=t.status==="published"?"draft":"published",o=l.value.findIndex(u=>u.id===t.id);o!==-1&&(l.value[o].status=e),console.log(`تم ${e==="published"?"نشر":"إلغاء نشر"} الصفحة بنجاح`)}catch(e){console.error("خطأ في تغيير حالة الصفحة:",e)}},V=async t=>{if(confirm("هل أنت متأكد من حذف هذه الصفحة؟ لا يمكن التراجع عن هذا الإجراء."))try{await $fetch(`/api/content/${t.id}`,{method:"DELETE"}),l.value=l.value.filter(e=>e.id!==t.id),console.log("تم حذف الصفحة بنجاح")}catch(e){console.error("خطأ في حذف الصفحة:",e)}},E=t=>new Date(t).toLocaleDateString("ar-SA"),U=(t,e)=>t?t.length>e?t.substring(0,e)+"...":t:"",A=t=>({page:"صفحة",post:"مقال",news:"أخبار"})[t]||t,F=t=>({page:"bg-blue-100 text-blue-800",post:"bg-green-100 text-green-800",news:"bg-purple-100 text-purple-800"})[t]||"bg-gray-100 text-gray-800",$=t=>({published:"منشور",draft:"مسودة",archived:"مؤرشف"})[t]||t,H=t=>({published:"bg-green-100 text-green-800",draft:"bg-orange-100 text-orange-800",archived:"bg-gray-100 text-gray-800"})[t]||"bg-gray-100 text-gray-800";return q([i,b,y],()=>{d.value=1}),G(async()=>{const{checkAuth:t}=J();try{await t(!0),await T()}catch(e){console.error("خطأ في تحميل بيانات المحتوى:",e)}}),oe({title:"إدارة المحتوى - Wonder Land Admin",meta:[{name:"description",content:"إدارة صفحات الموقع والمحتوى"},{name:"robots",content:"noindex, nofollow"}]}),(t,e)=>{const o=z,u=Z,f=K,R=Q;return v(),x("div",ae,[e[20]||(e[20]=s("div",{class:"h-16"},null,-1)),n(f,{title:"إدارة المحتوى",description:"إدارة صفحات الموقع والمحتوى"},{actions:g(()=>[n(u,{to:"/admin/content/analytics",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm"},{default:g(()=>[n(o,{name:"material-symbols:analytics",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),e[5]||(e[5]=s("span",{class:"hidden sm:inline"},"الإحصائيات",-1)),e[6]||(e[6]=s("span",{class:"sm:hidden"},"إحصائيات",-1))]),_:1}),n(u,{to:"/admin/content/templates",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm"},{default:g(()=>[n(o,{name:"material-symbols:widgets",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),e[7]||(e[7]=s("span",{class:"hidden sm:inline"},"القوالب",-1)),e[8]||(e[8]=s("span",{class:"sm:hidden"},"قوالب",-1))]),_:1}),n(u,{to:"/admin/content/editor",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm"},{default:g(()=>[n(o,{name:"material-symbols:edit",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),e[9]||(e[9]=s("span",{class:"hidden sm:inline"},"محرر المحتوى",-1)),e[10]||(e[10]=s("span",{class:"sm:hidden"},"محرر",-1))]),_:1}),n(u,{to:"/admin/content/create",class:"inline-flex items-center px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"},{default:g(()=>[n(o,{name:"material-symbols:add",class:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),e[11]||(e[11]=s("span",{class:"hidden sm:inline"},"إضافة صفحة جديدة",-1)),e[12]||(e[12]=s("span",{class:"sm:hidden"},"إضافة",-1))]),_:1})]),_:1}),n(R,{stats:r(M)},null,8,["stats"]),s("div",ne,[s("div",le,[s("div",re,[n(o,{name:"material-symbols:search",class:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),k(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>L(i)?i.value=a:null),type:"text",placeholder:"البحث في الصفحات...",class:"w-full pr-10 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[Y,r(i)]])]),k(s("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>L(b)?b.value=a:null),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[13]||(e[13]=[s("option",{value:""},"جميع الحالات",-1),s("option",{value:"published"},"منشور",-1),s("option",{value:"draft"},"مسودة",-1),s("option",{value:"archived"},"مؤرشف",-1)]),512),[[D,r(b)]]),k(s("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>L(y)?y.value=a:null),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[14]||(e[14]=[s("option",{value:""},"جميع الأنواع",-1),s("option",{value:"page"},"صفحة",-1),s("option",{value:"post"},"مقال",-1),s("option",{value:"news"},"أخبار",-1)]),512),[[D,r(y)]])])]),s("div",ie,[r(w)?(v(),x("div",de,[n(o,{name:"material-symbols:progress-activity",class:"animate-spin h-8 w-8 text-blue-600"}),e[15]||(e[15]=s("span",{class:"mr-3 text-gray-600"},"جارٍ تحميل الصفحات...",-1))])):r(P).length>0?(v(),x("div",ue,[s("table",ce,[e[16]||(e[16]=s("thead",{class:"bg-gray-50"},[s("tr",null,[s("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الصفحة "),s("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," النوع "),s("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الحالة "),s("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," تاريخ الإنشاء "),s("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," الإجراءات ")])],-1)),s("tbody",me,[(v(!0),x(ee,null,te(r(P),a=>(v(),x("tr",{key:a.id,class:"hover:bg-gray-50"},[s("td",ge,[s("div",pe,[s("div",be,[s("div",ye,[n(o,{name:"material-symbols:article",class:"h-6 w-6 text-gray-600"})])]),s("div",xe,[s("div",ve,p(a.title_ar||a.title_en||a.title),1),s("div",he,p(U(a.content_ar||a.content_en||a.content,50)),1)])])]),s("td",fe,[s("span",{class:S([F(a.type),"px-2 py-1 text-xs font-medium rounded-full"])},p(A(a.type)),3)]),s("td",we,[s("span",{class:S([H(a.status),"px-2 py-1 text-xs font-medium rounded-full"])},p($(a.status)),3)]),s("td",_e,p(E(a.created_at)),1),s("td",Ce,[s("div",ke,[n(u,{to:`/admin/content/preview/${a.id}`,class:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"معاينة"},{default:g(()=>[n(o,{name:"material-symbols:visibility",class:"h-4 w-4"})]),_:2},1032,["to"]),n(u,{to:`/admin/content/editor?page=${a.id}`,class:"text-purple-600 hover:text-purple-900 p-1 rounded",title:"تحرير متقدم"},{default:g(()=>[n(o,{name:"material-symbols:design-services",class:"h-4 w-4"})]),_:2},1032,["to"]),n(u,{to:`/admin/content/${a.id}/edit`,class:"text-green-600 hover:text-green-900 p-1 rounded",title:"تحرير"},{default:g(()=>[n(o,{name:"material-symbols:edit",class:"h-4 w-4"})]),_:2},1032,["to"]),s("button",{onClick:W=>O(a),class:S([a.status==="published"?"text-orange-600 hover:text-orange-900":"text-green-600 hover:text-green-900","p-1 rounded"]),title:a.status==="published"?"إلغاء النشر":"نشر"},[n(o,{name:a.status==="published"?"material-symbols:visibility-off":"material-symbols:visibility",class:"h-4 w-4"},null,8,["name"])],10,Le),s("button",{onClick:W=>V(a),class:"text-red-600 hover:text-red-900 p-1 rounded",title:"حذف"},[n(o,{name:"material-symbols:delete",class:"h-4 w-4"})],8,Se)])])]))),128))])])])):(v(),x("div",Pe,[n(o,{name:"material-symbols:article",class:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e[18]||(e[18]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"لا توجد صفحات",-1)),e[19]||(e[19]=s("p",{class:"text-gray-500 mb-6"},"لم يتم العثور على أي صفحات",-1)),n(u,{to:"/admin/content/create",class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},{default:g(()=>[n(o,{name:"material-symbols:add",class:"h-5 w-5 ml-2"}),e[17]||(e[17]=se(" إضافة صفحة جديدة "))]),_:1})]))]),r(C)>1?(v(),x("div",Ae,[s("div",$e," عرض "+p((r(d)-1)*h+1)+" إلى "+p(Math.min(r(d)*h,r(_)))+" من أصل "+p(r(_))+" صفحة ",1),s("div",De,[s("button",{onClick:e[3]||(e[3]=a=>d.value=Math.max(1,r(d)-1)),disabled:r(d)===1,class:"px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," السابق ",8,Ne),s("span",je,p(r(d)),1),s("button",{onClick:e[4]||(e[4]=a=>d.value=Math.min(r(C),r(d)+1)),disabled:r(d)===r(C),class:"px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," التالي ",8,Be)])])):X("",!0)])}}};export{Fe as default};
