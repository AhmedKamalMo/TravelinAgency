import{d as e,a as t}from"../../../_/nitro.mjs";import{createConnection as o}from"mysql2/promise";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"@iconify/utils";import"node:crypto";import"consola";import"node:url";import"ipx";import"node:fs";import"node:path";const r=e((async e=>{try{const r=t(e),a=parseInt(r.page)||1,s=parseInt(r.limit)||10,i=r.search||"",n=r.status||"",l=r.role||"",d=await o({host:"localhost",user:"root",password:"",database:"wonderland_travel"}),[m]=await d.execute("\n      SELECT * FROM users \n      ORDER BY created_at DESC\n    ");await d.end();let p=m.map((e=>{let t="user";return"admin@wonderland.com"===e.email?t="admin":"moderator@wonderland.com"===e.email&&(t="moderator"),{id:e.id,email:e.email,full_name:e.full_name||e.name,phone:e.phone,role:t,status:e.status||"active",email_verified:e.email_verified||!1,phone_verified:e.phone_verified||!1,bio:e.bio,date_of_birth:e.date_of_birth,gender:e.gender,nationality:e.nationality,address:e.address,city:e.city,country:e.country,postal_code:e.postal_code,preferences:e.preferences?JSON.parse(e.preferences):{},created_at:e.created_at,updated_at:e.updated_at,last_login:e.last_login,login_count:e.login_count||0}}));i&&(p=p.filter((e=>e.full_name?.toLowerCase().includes(i.toLowerCase())||e.email.toLowerCase().includes(i.toLowerCase())||e.phone?.toLowerCase().includes(i.toLowerCase())))),n&&(p=p.filter((e=>e.status===n))),l&&(p=p.filter((e=>e.role===l)));const c=(a-1)*s,u=c+s;return{success:!0,data:{users:p.slice(c,u),total:p.length,page:a,limit:s}}}catch(e){return console.error("Error fetching users:",e),{success:!1,error:e.message||"فشل في جلب المستخدمين"}}}));export{r as default};
//# sourceMappingURL=index.get.mjs.map
