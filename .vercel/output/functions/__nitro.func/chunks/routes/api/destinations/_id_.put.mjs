import{d as e,g as t,r as n,c as a}from"../../../_/nitro.mjs";import{e as i}from"../../../_/database.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"@iconify/utils";import"node:crypto";import"consola";import"node:url";import"ipx";import"node:fs";import"node:path";import"mysql2/promise";import"bcryptjs";import"jsonwebtoken";const o=e((async e=>{try{const o=t(e,"id"),r=await n(e);if(!o)throw a({statusCode:400,statusMessage:"Destination ID is required"});if(!(r.name_ar&&r.name_en&&r.description_ar&&r.description_en))throw a({statusCode:400,statusMessage:"Name and description in both languages are required"});if(0===(await i("\n      UPDATE destinations SET\n        name_ar = ?,\n        name_en = ?,\n        description_ar = ?,\n        description_en = ?,\n        image_url = ?,\n        category = ?,\n        featured = ?,\n        active = ?,\n        updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    ",[r.name_ar,r.name_en,r.description_ar,r.description_en,r.image_url||null,r.category||"international",r.featured?1:0,r.active?1:0,o])).affectedRows)throw a({statusCode:404,statusMessage:"Destination not found"});const s=await i("\n      SELECT \n        id, \n        name_ar,\n        name_en,\n        description_ar,\n        description_en,\n        image_url,\n        category,\n        featured,\n        active,\n        region_ar,\n        region_en,\n        location_type_ar,\n        location_type_en,\n        destination_type_ar,\n        destination_type_en,\n        coordinates,\n        created_at,\n        updated_at\n      FROM destinations \n      WHERE id = ?\n    ",[o]);if(!s||0===s.length)throw a({statusCode:500,statusMessage:"Failed to retrieve updated destination"});const d=s[0];return{success:!0,message:"Destination updated successfully",data:{id:d.id,name:d.name_ar||d.name_en,name_ar:d.name_ar,name_en:d.name_en,description:d.description_ar||d.description_en,description_ar:d.description_ar,description_en:d.description_en,image:d.image_url,image_url:d.image_url,category:d.category,featured:1===d.featured,active:1===d.active,status:1===d.active?"active":"inactive",region_ar:d.region_ar,region_en:d.region_en,location_type_ar:d.location_type_ar,location_type_en:d.location_type_en,destination_type_ar:d.destination_type_ar,destination_type_en:d.destination_type_en,coordinates:d.coordinates?JSON.parse(d.coordinates):null,created_at:d.created_at,updated_at:d.updated_at}}}catch(e){if(console.error("Error updating destination:",e),e.statusCode)throw e;throw a({statusCode:500,statusMessage:"Failed to update destination"})}}));export{o as default};
//# sourceMappingURL=_id_.put.mjs.map
