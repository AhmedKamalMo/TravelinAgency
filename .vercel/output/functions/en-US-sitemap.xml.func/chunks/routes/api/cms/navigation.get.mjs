import{d as t,a as n,c as e}from"../../../_/nitro.mjs";import{executeQuery as o}from"../../../_/database.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"@iconify/utils";import"node:crypto";import"consola";import"node:url";import"ipx";import"node:fs";import"node:path";import"mysql2/promise";import"bcryptjs";import"jsonwebtoken";const r=t((async t=>{try{const e=n(t),{menu_name:r,active_only:s=!0}=e;let i="\n      SELECT \n        n.*,\n        p.slug as page_slug,\n        p.title as page_title\n      FROM cms_navigation n\n      LEFT JOIN cms_pages p ON n.page_id = p.id\n      WHERE 1=1\n    ";const a=[];r&&(i+=" AND n.menu_name = ?",a.push(r)),"true"===s&&(i+=" AND n.is_active = 1"),i+=" ORDER BY n.menu_name, n.order_index ASC";const p=await o(i,a),m=new Map,c=[];for(const t of p)m.set(t.id,{...t,children:[]});for(const t of p)if(t.parent_id){const n=m.get(t.parent_id);n&&n.children.push(m.get(t.id))}else c.push(m.get(t.id));return{success:!0,data:{menus:c.reduce(((t,n)=>(t[n.menu_name]||(t[n.menu_name]=[]),t[n.menu_name].push(n),t)),{}),flat:p}}}catch(t){throw console.error("Error fetching navigation:",t),e({statusCode:500,statusMessage:"Error fetching navigation"})}}));export{r as default};
//# sourceMappingURL=navigation.get.mjs.map
