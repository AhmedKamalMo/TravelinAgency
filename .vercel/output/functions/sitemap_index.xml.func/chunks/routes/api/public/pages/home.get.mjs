import{d as t}from"../../../../_/nitro.mjs";import{e as n}from"../../../../_/database.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"@iconify/utils";import"node:crypto";import"consola";import"node:url";import"ipx";import"node:fs";import"node:path";import"mysql2/promise";import"bcryptjs";import"jsonwebtoken";const e=t((async t=>{try{const t=await n("SELECT \n        p.id,\n        p.slug,\n        p.title,\n        p.meta_title,\n        p.meta_description,\n        p.meta_keywords,\n        p.status,\n        p.template,\n        p.updated_at\n       FROM cms_pages p\n       WHERE p.slug = 'home' AND p.status = 'published'",[]);if(0===t.length)return{success:!1,message:"Homepage not found or not published"};const e=await n("SELECT \n        s.id,\n        s.section_type,\n        s.title,\n        s.subtitle,\n        s.content,\n        s.background_color,\n        s.background_image,\n        s.text_color,\n        s.order_index,\n        s.settings\n       FROM cms_sections s\n       WHERE s.page_id = ? AND s.is_active = 1\n       ORDER BY s.order_index ASC",[t[0].id]);for(const t of e){if(t.content_blocks=await n("SELECT \n          id,\n          block_type,\n          title,\n          content,\n          image_url,\n          video_url,\n          link_url,\n          link_text,\n          order_index,\n          settings\n         FROM cms_content_blocks \n         WHERE section_id = ? AND is_active = 1\n         ORDER BY order_index ASC",[t.id]),t.settings)try{t.settings=JSON.parse(t.settings)}catch(n){t.settings={}}t.content_blocks.forEach((t=>{if(t.settings)try{t.settings=JSON.parse(t.settings)}catch(n){t.settings={}}}))}return{success:!0,data:{page:t[0],sections:e}}}catch(t){return console.error("Error fetching public homepage:",t),{success:!1,message:"Error fetching homepage content"}}}));export{e as default};
//# sourceMappingURL=home.get.mjs.map
