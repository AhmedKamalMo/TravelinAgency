import{d as e,g as t,r as a,c as n}from"../../../_/nitro.mjs";import{executeQuery as i}from"../../../_/database.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"@iconify/utils";import"node:crypto";import"consola";import"node:url";import"ipx";import"node:fs";import"node:path";import"mysql2/promise";import"bcryptjs";import"jsonwebtoken";const r=e((async e=>{try{const r=t(e,"id"),o=await a(e);if(!r)throw n({statusCode:400,statusMessage:"Destination ID is required"});if(!(o.name_ar&&o.name_en&&o.description_ar&&o.description_en))throw n({statusCode:400,statusMessage:"Name and description in both languages are required"});if(0===(await i("\n      UPDATE destinations SET\n        name_ar = ?,\n        name_en = ?,\n        description_ar = ?,\n        description_en = ?,\n        image_url = ?,\n        category = ?,\n        featured = ?,\n        active = ?,\n        updated_at = CURRENT_TIMESTAMP\n      WHERE id = ?\n    ",[o.name_ar,o.name_en,o.description_ar,o.description_en,o.image_url||null,o.category||"international",o.featured?1:0,o.active?1:0,r])).affectedRows)throw n({statusCode:404,statusMessage:"Destination not found"});const s=await i("\n      SELECT \n        id, \n        name_ar,\n        name_en,\n        description_ar,\n        description_en,\n        image_url,\n        category,\n        featured,\n        active,\n        created_at,\n        updated_at\n      FROM destinations \n      WHERE id = ?\n    ",[r]);if(!s||0===s.length)throw n({statusCode:500,statusMessage:"Failed to retrieve updated destination"});const d=s[0];return{success:!0,message:"Destination updated successfully",data:{id:d.id,name:d.name_ar||d.name_en,name_ar:d.name_ar,name_en:d.name_en,description:d.description_ar||d.description_en,description_ar:d.description_ar,description_en:d.description_en,image:d.image_url,image_url:d.image_url,category:d.category,featured:1===d.featured,active:1===d.active,status:1===d.active?"active":"inactive",region_ar:"saudi"===d.category?"السعودية":"دولي",region_en:"saudi"===d.category?"Saudi Arabia":"International",location_type_ar:"وجهة",location_type_en:"Destination",destination_type_ar:"saudi"===d.category?"محلي":"دولي",destination_type_en:"saudi"===d.category?"Domestic":"International",coordinates:null,created_at:d.created_at,updated_at:d.updated_at}}}catch(e){if(console.error("Error updating destination:",e),e.statusCode)throw e;throw n({statusCode:500,statusMessage:"Failed to update destination"})}}));export{r as default};
//# sourceMappingURL=_id_.put.mjs.map
