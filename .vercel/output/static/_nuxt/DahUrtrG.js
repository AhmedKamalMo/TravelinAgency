import A from"./CjUD-tqt.js";import{h as y,B,l as E,c,o as l,a as s,u as r,k as v,e as f,t as d,b as m,j as M,v as S,Y as V,F as _,r as x,A as w,n as k}from"./DHjegAIK.js";import{u as R}from"./DOtPdQ7M.js";const U={class:"min-h-screen bg-gray-50"},W={class:"bg-white shadow-sm border-b"},F={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},O={class:"flex justify-between items-center py-4"},H={class:"flex items-center space-x-4 space-x-reverse"},Y=["disabled"],z=["disabled"],G={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},J={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},K={class:"lg:col-span-1"},Q={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},X={class:"mb-4"},Z={class:"space-y-4"},ee={class:"text-sm font-medium text-gray-700"},te={class:"space-y-1"},se=["onClick"],oe={class:"lg:col-span-3"},ae={class:"bg-white rounded-lg shadow-sm border border-gray-200 min-h-96"},ne={key:0,class:"p-6"},le={class:"prose max-w-none"},ie={class:"text-center py-8 border border-gray-200 rounded-lg"},re={class:"text-lg font-medium"},ce={key:1,class:"p-6"},pe={key:0,class:"text-center py-12"},de={key:1,class:"space-y-4"},me={class:"flex justify-between items-center mb-2"},ue={class:"font-medium text-gray-900"},ge={class:"flex space-x-2 space-x-reverse"},ye=["onClick","disabled"],be=["onClick","disabled"],he=["onClick"],ve=["onClick"],fe={class:"text-center py-4 bg-gray-50 rounded"},_e={class:"text-sm text-gray-600"},$e={__name:"editor",setup(xe){const a=y([]),b=y(!1),p=y(!1),u=y(""),C=y([{name:"العناصر الأساسية",components:[{type:"hero",name:"قسم البطل",icon:"material-symbols:image",props:{title:"مرحباً بك في Wonder Land",subtitle:"اكتشف أجمل الوجهات السياحية",backgroundImage:"/images/hero-bg.jpg",buttonText:"اكتشف الآن",buttonLink:"/packages"}},{type:"about",name:"من نحن",icon:"material-symbols:info",props:{title:"من نحن",content:"نحن وكالة سفر رائدة في المملكة العربية السعودية...",image:"/images/about.jpg"}},{type:"services",name:"الخدمات",icon:"material-symbols:room-service",props:{title:"خدماتنا",services:`حج وعمرة
رحلات سياحية
تذاكر طيران
حجز فنادق`}},{type:"contact",name:"التواصل",icon:"material-symbols:contact-mail",props:{title:"تواصل معنا",phone:"+966 50 123 4567",email:"info@wonderland.com",address:"الرياض، المملكة العربية السعودية"}}]}]),I=B(()=>u.value?C.value.map(o=>({...o,components:o.components.filter(t=>t.name.includes(u.value)||t.type.includes(u.value))})).filter(o=>o.components.length>0):C.value),$=o=>{const t={id:Date.now(),type:o.type,props:{...o.props},classes:"mb-6"};a.value.push(t)},g=()=>{const t=w().query.page;let e=[];t==="1"?e=[{type:"hero",props:{title:"مرحباً بك في Wonder Land",subtitle:"اكتشف أجمل الوجهات السياحية",backgroundImage:"/images/hero-bg.jpg",buttonText:"اكتشف الآن",buttonLink:"/packages"}},{type:"about",props:{title:"من نحن",content:"نحن وكالة سفر رائدة في المملكة العربية السعودية، نقدم أفضل خدمات السفر والسياحة لعملائنا الكرام.",image:"/images/about.jpg"}}]:t==="2"?e=[{type:"heading",props:{title:"الباقات السياحية",subtitle:"اكتشف أفضل العروض والرحلات"}},{type:"services",props:{title:"باقاتنا المميزة",services:[{title:"باقة دبي",description:"رحلة لمدة 3 أيام",price:"1500 ريال"},{title:"باقة تركيا",description:"رحلة لمدة 5 أيام",price:"2500 ريال"},{title:"باقة ماليزيا",description:"رحلة لمدة 7 أيام",price:"3500 ريال"}]}}]:t==="3"?e=[{type:"heading",props:{title:"باقة مخصصة",subtitle:"صمم رحلتك حسب احتياجاتك"}},{type:"contact",props:{title:"تواصل معنا",description:"أخبرنا عن رحلتك المثالية وسنساعدك في تصميمها"}}]:t==="4"?e=[{type:"heading",props:{title:"من نحن",subtitle:"تعرف على وكالة السفر وخدماتنا"}},{type:"about",props:{title:"قصتنا",content:"نحن وكالة سفر رائدة في المملكة العربية السعودية، نقدم أفضل خدمات السفر والسياحة لعملائنا الكرام. نسعى دائماً لتوفير تجارب سفر لا تُنسى.",image:"/images/about.jpg"}},{type:"testimonials",props:{title:"آراء عملائنا",testimonials:[{name:"أحمد محمد",text:"تجربة رائعة، شكراً لكم"},{name:"فاطمة علي",text:"خدمة ممتازة ورحلة لا تُنسى"}]}}]:e=[{type:"heading",props:{title:"مرحباً بك",subtitle:"ابدأ في إنشاء صفحتك"}},{type:"paragraph",props:{content:"هذه صفحة جديدة. يمكنك إضافة المكونات التي تريدها من الشريط الجانبي."}}],e.forEach(n=>{$(n)})},P=(o,t)=>{if(t==="up"&&o>0){const e=a.value[o];a.value[o]=a.value[o-1],a.value[o-1]=e}else if(t==="down"&&o<a.value.length-1){const e=a.value[o];a.value[o]=a.value[o+1],a.value[o+1]=e}},j=o=>{a.value.splice(o,1)},L=()=>{b.value=!b.value},D=async()=>{try{p.value=!0;const t=w().query.page,e={title_ar:"صفحة جديدة",title_en:"New Page",content_ar:"",content_en:"",components:a.value,status:"draft",template:"default"};if(t)(await $fetch(`/api/cms/editor/${t}`,{method:"PUT",body:e})).success&&(console.log("Page saved successfully"),await k(`/admin/content/editor?page=${t}`));else{const n=await $fetch("/api/cms/editor",{method:"POST",body:e});n.success&&(console.log("Page created successfully"),await k(`/admin/content/editor?page=${n.id}`))}}catch(o){console.error("Error saving page:",o)}finally{p.value=!1}},T=async()=>{try{p.value=!0;const t=w().query.page,e={title_ar:"صفحة جديدة",title_en:"New Page",content_ar:"",content_en:"",components:a.value,status:"published",template:"default"};if(t)(await $fetch(`/api/cms/editor/${t}`,{method:"PUT",body:e})).success&&(console.log("Page published successfully"),await k(`/admin/content/editor?page=${t}`));else{const n=await $fetch("/api/cms/editor",{method:"POST",body:e});n.success&&(console.log("Page created and published successfully"),await k(`/admin/content/editor?page=${n.id}`))}}catch(o){console.error("Error publishing page:",o)}finally{p.value=!1}},N=async()=>{const o=w(),t=o.query.page;if(t)try{console.log("Loading page with ID:",t);const e=await $fetch(`/api/cms/editor/${t}`);console.log("API Response:",e),e.success&&e.page?e.page.components&&Array.isArray(e.page.components)&&e.page.components.length>0?(console.log("Loading existing components:",e.page.components),a.value=e.page.components):(console.log("No components found, adding default components"),g()):(console.log("No page data found, adding default components"),g())}catch(e){console.error("Error loading page:",e),g()}else{const e=o.query.template;e&&(console.log("Loading template:",e),g())}},q=o=>{if(o>=0&&o<a.value.length){const e={...a.value[o],id:Date.now()+Math.random()};a.value.splice(o+1,0,e)}};return E(()=>{N()}),R({title:"محرر المحتوى - Wonder Land Admin",meta:[{name:"description",content:"محرر محتوى متقدم لإنشاء وتعديل الصفحات"},{name:"robots",content:"noindex, nofollow"}]}),(o,t)=>{const e=A;return l(),c("div",U,[s("div",W,[s("div",F,[s("div",O,[t[1]||(t[1]=s("div",{class:"flex items-center"},[s("h1",{class:"text-2xl font-bold text-gray-900"},"محرر المحتوى")],-1)),s("div",H,[s("button",{onClick:D,disabled:r(p),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center"},[r(p)?(l(),v(e,{key:0,name:"material-symbols:progress-activity",class:"animate-spin h-4 w-4 ml-2"})):(l(),v(e,{key:1,name:"material-symbols:save",class:"h-4 w-4 ml-2"})),f(" "+d(r(p)?"جاري الحفظ...":"حفظ"),1)],8,Y),s("button",{onClick:T,disabled:r(p),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors flex items-center"},[r(p)?(l(),v(e,{key:0,name:"material-symbols:progress-activity",class:"animate-spin h-4 w-4 ml-2"})):(l(),v(e,{key:1,name:"material-symbols:publish",class:"h-4 w-4 ml-2"})),f(" "+d(r(p)?"جاري النشر...":"نشر"),1)],8,z),s("button",{onClick:L,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center"},[m(e,{name:"material-symbols:visibility",class:"h-4 w-4 ml-2"}),f(" "+d(r(b)?"تحرير":"معاينة"),1)])])])])]),s("div",G,[s("div",J,[s("div",K,[s("div",Q,[t[2]||(t[2]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"المكونات",-1)),s("div",X,[M(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>V(u)?u.value=n:null),type:"text",placeholder:"البحث في المكونات...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[S,r(u)]])]),s("div",Z,[(l(!0),c(_,null,x(r(I),n=>(l(),c("div",{key:n.name,class:"space-y-2"},[s("h3",ee,d(n.name),1),s("div",te,[(l(!0),c(_,null,x(n.components,i=>(l(),c("button",{key:i.type,onClick:h=>$(i),class:"w-full text-right px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors flex items-center justify-between"},[m(e,{name:i.icon,class:"h-4 w-4"},null,8,["name"]),f(" "+d(i.name),1)],8,se))),128))])]))),128))])])]),s("div",oe,[s("div",ae,[r(b)?(l(),c("div",ne,[t[4]||(t[4]=s("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"معاينة الصفحة",-1)),s("div",le,[(l(!0),c(_,null,x(r(a),(n,i)=>(l(),c("div",{key:i,class:"mb-6"},[s("div",ie,[s("p",re,d(n.type),1),t[3]||(t[3]=s("p",{class:"text-sm text-gray-500"},"مكون محمل من قاعدة البيانات",-1))])]))),128))])])):(l(),c("div",ce,[t[7]||(t[7]=s("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"تحرير الصفحة",-1)),r(a).length===0?(l(),c("div",pe,[m(e,{name:"material-symbols:add-box",class:"h-16 w-16 text-gray-300 mx-auto mb-4"}),t[5]||(t[5]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"ابدأ بإنشاء صفحتك",-1)),t[6]||(t[6]=s("p",{class:"text-gray-500 mb-6"},"اسحب المكونات من الشريط الجانبي لبدء التصميم",-1)),s("button",{onClick:g,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," إضافة مكونات افتراضية ")])):(l(),c("div",de,[(l(!0),c(_,null,x(r(a),(n,i)=>(l(),c("div",{key:i,class:"border border-gray-200 rounded-lg p-4"},[s("div",me,[s("h4",ue,d(n.type),1),s("div",ge,[s("button",{onClick:h=>P(i,"up"),disabled:i===0,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",title:"نقل لأعلى"},[m(e,{name:"material-symbols:keyboard-arrow-up",class:"h-4 w-4"})],8,ye),s("button",{onClick:h=>P(i,"down"),disabled:i===r(a).length-1,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",title:"نقل لأسفل"},[m(e,{name:"material-symbols:keyboard-arrow-down",class:"h-4 w-4"})],8,be),s("button",{onClick:h=>q(i),class:"p-1 text-blue-400 hover:text-blue-600",title:"نسخ"},[m(e,{name:"material-symbols:content-copy",class:"h-4 w-4"})],8,he),s("button",{onClick:h=>j(i),class:"p-1 text-red-400 hover:text-red-600",title:"حذف"},[m(e,{name:"material-symbols:delete",class:"h-4 w-4"})],8,ve)])]),s("div",fe,[s("p",_e,d(n.type)+" - مكون محمل من قاعدة البيانات",1)])]))),128))]))]))])])])])])}}};export{$e as default};
