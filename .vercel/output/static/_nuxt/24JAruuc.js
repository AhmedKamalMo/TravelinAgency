import{_ as X}from"./DT7sJ5yo.js";import Y from"./BOaYbNxV.js";import{z as U,g as H,B as g,d as Z,P as F,Q as ee,m as te,R as ae,c as d,o as c,b as n,a as w,t as l,h as s,e as I,l as ne,F as re,r as se,j as ie}from"./DbWDakc_.js";import{u as G,_ as oe}from"./VRhtI0VV.js";import{_ as le}from"./De1xOYBn.js";import"./BzZnr7Wd.js";const ue=()=>{const{locale:K}=U(),{getPackages:R}=G(),h=H(""),a=H({periods:[],priceRange:{min:0,max:1/0},duration:{min:0,max:1/0},dates:{start:null,end:null},travelers:1,type:[]}),M=g(()=>R()),_=g(()=>{const i=M.value||[];if(i.length===0)return{periods:[],priceRanges:[],durationRanges:[]};const u=new Set;i.forEach(m=>{m.travel_period&&u.add(m.travel_period)});const f=["january","february","march","april","may","june","july","august","september","october","november","december"],j=Array.from(u).sort((m,P)=>{const k=f.findIndex(e=>m.toLowerCase().includes(e)),b=f.findIndex(e=>P.toLowerCase().includes(e));return k-b}),z={january:{en:"January",ar:"يناير"},february:{en:"February",ar:"فبراير"},march:{en:"March",ar:"مارس"},april:{en:"April",ar:"أبريل"},may:{en:"May",ar:"مايو"},june:{en:"June",ar:"يونيو"},july:{en:"July",ar:"يوليو"},august:{en:"August",ar:"أغسطس"},september:{en:"September",ar:"سبتمبر"},october:{en:"October",ar:"أكتوبر"},november:{en:"November",ar:"نوفمبر"},december:{en:"December",ar:"ديسمبر"}};return{periods:j.map(m=>({id:m,name:z[m]||{en:m,ar:m}})),priceRanges:[{min:0,max:1e3,label:"Under $1,000"},{min:1e3,max:3e3,label:"$1,000 - $3,000"},{min:3e3,max:5e3,label:"$3,000 - $5,000"},{min:5e3,max:1/0,label:"Over $5,000"}],durationRanges:[{min:0,max:3,label:"1-3 days"},{min:4,max:7,label:"4-7 days"},{min:8,max:14,label:"8-14 days"},{min:15,max:1/0,label:"15+ days"}]}}),$=g(()=>{let i=M.value||[];if(h.value){const u=h.value.toLowerCase();i=i.filter(f=>f.title_en.toLowerCase().includes(u)||f.description_en.toLowerCase().includes(u))}return a.value.periods.length>0&&(i=i.filter(u=>a.value.periods.some(f=>u.travel_period.toLowerCase()===f.toLowerCase()))),(a.value.priceRange.min>0||a.value.priceRange.max<1/0)&&(i=i.filter(u=>u.price>=a.value.priceRange.min&&u.price<=a.value.priceRange.max)),(a.value.duration.min>0||a.value.duration.max<1/0)&&(i=i.filter(u=>u.duration_days>=a.value.duration.min&&u.duration_days<=a.value.duration.max)),i}),L=g(()=>{let i=0;return i+=a.value.periods.length,(a.value.priceRange.min!==0||a.value.priceRange.max!==1/0)&&i++,(a.value.duration.min!==0||a.value.duration.max!==1/0)&&i++,a.value.dates.start&&a.value.dates.end&&i++,a.value.travelers>1&&i++,i});return{searchQuery:h,filters:a,filterOptions:_,filteredPackages:$,activeFiltersCount:L,resetFilters:()=>{h.value="",a.value={periods:[],priceRange:{min:0,max:1/0},duration:{min:0,max:1/0},dates:{start:null,end:null},travelers:1,type:[]}}}},ce={class:"min-h-screen bg-gray-50"},de={class:"relative bg-cover bg-center py-20"},me={class:"absolute inset-0"},pe={class:"container relative z-10 mx-auto px-4 text-center text-white"},ve={class:"text-2xl md:text-3xl font-bold mb-4"},fe={class:"flex items-center justify-center text-1xl gap-2 text-sm md:text-base mb-6 w-full"},xe={key:0},he={key:1},ye={class:"flex flex-wrap justify-center gap-3 mb-8"},ge={key:0,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},be={key:1,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},_e={key:2,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},we={key:3,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},Ie={class:"py-16"},Re={class:"container mx-auto px-4"},Me={key:0,class:"flex justify-center items-center min-h-[400px]"},Le={key:1,class:"text-center text-red-500 py-16"},Ce={class:"max-w-md mx-auto"},$e={class:"text-lg font-medium mb-2"},je={class:"text-gray-500"},ze={key:2,class:"text-center text-gray-500 py-16"},Pe={class:"max-w-md mx-auto"},ke={class:"text-lg font-medium mb-2"},Se={class:"text-gray-500"},qe={key:3,class:"text-center py-16"},Be={class:"max-w-md mx-auto"},Ae={class:"text-lg font-medium mb-2"},Ne={class:"text-gray-500 mb-6"},Oe={key:4,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},He=Z({__name:"search",setup(K){const R=F(),h=ee(),{t:a,locale:M}=U(),{packages:_,pending:$,error:L}=G(),{filters:t,searchQuery:i,filterOptions:u,resetFilters:f}=ue();te(()=>{const e=R.query;if(f(),e.q&&(i.value=String(e.q)),e.periods){const r=Array.isArray(e.periods)?e.periods:e.periods.split(",");t.value.destinations=r.map(o=>String(o))}if(e.budget)switch(String(e.budget)){case"low":t.value.priceRange={min:0,max:1e3};break;case"medium":t.value.priceRange={min:1e3,max:3e3};break;case"high":t.value.priceRange={min:3e3,max:5e3};break;case"luxury":t.value.priceRange={min:5e3,max:1/0};break}else(e.priceMin||e.priceMax)&&(t.value.priceRange={min:parseInt(e.priceMin)||0,max:e.priceMax?parseInt(e.priceMax):1/0});(e.durationMin||e.durationMax)&&(t.value.duration={min:parseInt(e.durationMin)||0,max:e.durationMax?parseInt(e.durationMax):1/0}),e.travelers&&(t.value.travelers=parseInt(e.travelers)||1)});const j=g(()=>{var e;return(e=t.value)!=null&&e.destinations?t.value.destinations.map(r=>{var p,v,x;const o=(v=(p=u.value)==null?void 0:p.destinations)==null?void 0:v.find(C=>C.id===r);return((x=o==null?void 0:o.name)==null?void 0:x[M.value])||r}):[]}),z=g(()=>{var e,r,o,p,v;return t.value?(((e=t.value.destinations)==null?void 0:e.length)||0)>0||(((r=t.value.priceRange)==null?void 0:r.min)||0)!==0||(((o=t.value.priceRange)==null?void 0:o.max)||1/0)!==1/0||(((p=t.value.duration)==null?void 0:p.min)||0)!==0||(((v=t.value.duration)==null?void 0:v.max)||1/0)!==1/0||(t.value.travelers||1)>1:!1}),m=()=>{f(),h.push({path:R.path})},P=e=>e.max===1/0?`${a("common.from")} ${e.min.toLocaleString()}`:`${e.min.toLocaleString()} - ${e.max.toLocaleString()}`,k=e=>e.max===1/0?`${a("common.from")} ${e.min} ${a("common.days")}`:`${e.min} - ${e.max} ${a("common.days")}`,b=g(()=>_.value?_.value.filter(e=>{var r,o,p,v,x,C,q,B,A,N,O,V,D,J,E,Q;if(i.value){const y=i.value.toLowerCase(),T=((r=e.title_en)==null?void 0:r.toLowerCase().includes(y))||((o=e.title_ar)==null?void 0:o.toLowerCase().includes(y)),S=((p=e.description_en)==null?void 0:p.toLowerCase().includes(y))||((v=e.description_ar)==null?void 0:v.toLowerCase().includes(y));if(!T&&!S)return!1}if(((C=(x=t.value)==null?void 0:x.destinations)==null?void 0:C.length)>0){const y=(q=e==null?void 0:e.travel_period)==null?void 0:q.toLowerCase();if(!y||!t.value.destinations.some(S=>{const W=S.toLowerCase();return y.includes(W)}))return!1}return!((e==null?void 0:e.price_per_person)<(((A=(B=t.value)==null?void 0:B.priceRange)==null?void 0:A.min)||0)||((O=(N=t.value)==null?void 0:N.priceRange)==null?void 0:O.max)!==1/0&&(e==null?void 0:e.price_per_person)>t.value.priceRange.max||(e==null?void 0:e.duration_days)<(((D=(V=t.value)==null?void 0:V.duration)==null?void 0:D.min)||0)||((E=(J=t.value)==null?void 0:J.duration)==null?void 0:E.max)!==1/0&&(e==null?void 0:e.duration_days)>t.value.duration.max||(((Q=t.value)==null?void 0:Q.travelers)||1)>1&&(e==null?void 0:e.max_persons)<t.value.travelers)}):[]);return ae([t,i],([e,r])=>{var o;h.replace({query:{...r&&{q:r},...((o=e.destinations)==null?void 0:o.length)&&{periods:e.destinations.join(",")},...e.priceRange.min>0&&{priceMin:e.priceRange.min},...e.priceRange.max<1/0&&{priceMax:e.priceRange.max},...e.duration.min>0&&{durationMin:e.duration.min},...e.duration.max<1/0&&{durationMax:e.duration.max},...e.travelers>1&&{travelers:e.travelers}}})},{deep:!0}),(e,r)=>{var v;const o=X,p=Y;return c(),d("div",ce,[n("section",de,[n("div",me,[w(o,{src:"/images/packages/home/packages-hero-bg.jpeg",alt:"Stunning beachfront villa with private pool and ocean views",width:"1920",height:"1080",loading:"eager",format:"webp",quality:"90",class:"w-full h-full object-cover",placeholder:""}),r[0]||(r[0]=n("div",{class:"absolute inset-0 bg-gradient-to-b from-black/50 via-black/30 to-black/50"},null,-1))]),n("div",pe,[n("h1",ve,l(s(a)("search.results.title")),1),n("div",fe,[b.value.length>0?(c(),d("span",xe,l(s(a)("search.results.count",{count:b.value.length})),1)):(c(),d("span",he,l(s(a)("search.results.empty")),1))]),n("div",ye,[(v=s(t))!=null&&v.destinations&&s(t).destinations.length?(c(),d("div",ge,[r[1]||(r[1]=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z","clip-rule":"evenodd"})],-1)),n("span",null,l(j.value.join(", ")),1)])):I("",!0),s(t).priceRange.min!==0||s(t).priceRange.max!==1/0?(c(),d("div",be,[w(oe,{size:20,class:"text-white"}),n("span",null,l(P(s(t).priceRange)),1)])):I("",!0),s(t).duration.min!==0||s(t).duration.max!==1/0?(c(),d("div",_e,[r[2]||(r[2]=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1)),n("span",null,l(k(s(t).duration)),1)])):I("",!0),s(t).travelers>1?(c(),d("div",we,[r[3]||(r[3]=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"})],-1)),n("span",null,l(s(t).travelers)+" "+l(s(a)("search.travelers_count",{count:s(t).travelers})),1)])):I("",!0),z.value?(c(),d("button",{key:4,onClick:m,class:"flex items-center gap-2 bg-primary/20 hover:bg-primary/30 backdrop-blur-sm px-4 py-2 rounded-full transition-colors"},[r[4]||(r[4]=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),ne(" "+l(s(a)("search.active_filters.clear_filters")),1)])):I("",!0)])])]),n("section",Ie,[n("div",Re,[s($)?(c(),d("div",Me,r[5]||(r[5]=[n("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"},null,-1)]))):s(L)?(c(),d("div",Le,[n("div",Ce,[w(p,{name:"material-symbols:error-outline",class:"h-16 w-16 mx-auto mb-4 text-red-400"}),n("h3",$e,l(s(a)("common.error")),1),n("p",je,l(s(L).message||"An error occurred while loading packages"),1)])])):s(_).length===0?(c(),d("div",ze,[n("div",Pe,[w(p,{name:"material-symbols:package-2-outline",class:"h-16 w-16 mx-auto mb-4 text-gray-400"}),n("h3",ke,l(s(a)("packages.no_packages")),1),n("p",Se,l(s(a)("packages.no_packages_description")),1)])])):b.value.length===0?(c(),d("div",qe,[n("div",Be,[w(p,{name:"material-symbols:search-off",class:"h-16 w-16 mx-auto mb-4 text-gray-400"}),n("h3",Ae,l(s(a)("search.results.empty")),1),n("p",Ne,l(s(a)("search.results.empty_description")),1),n("button",{onClick:m,class:"px-6 py-2 bg-primary text-white rounded-xl hover:bg-primary/90 transition-colors"},l(s(a)("search.actions.clear_filters")),1)])])):(c(),d("div",Oe,[(c(!0),d(re,null,se(b.value,x=>(c(),ie(le,{key:x.id,package_:x},null,8,["package_"]))),128))]))])])])}}});export{He as default};
