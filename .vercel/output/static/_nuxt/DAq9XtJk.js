import S from"./CjUD-tqt.js";import{_ as $}from"./TxntYzv-.js";import{m as G,A as q,h as v,B as H,l as I,c as w,o as k,a as s,t as m,u as t,b as p,d as R,e as c,H as _,j as n,v as u,R as b,T as x}from"./DHjegAIK.js";import{u as F}from"./DOtPdQ7M.js";const O={class:"space-y-6"},P={class:"flex items-center justify-between"},W={class:"text-gray-600 mt-1"},J={class:"flex items-center space-x-3 space-x-reverse"},K=["disabled"],Q={key:0,class:"flex justify-center items-center py-12"},X={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Y={class:"lg:col-span-2 space-y-6"},Z={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={class:"mt-4"},te={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"md:col-span-2"},re={class:"space-y-6"},ne={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ae={class:"space-y-4"},ie={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},de={class:"space-y-4"},ue={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},pe={class:"space-y-3"},me={class:"flex items-center"},be={class:"flex items-center"},fe={class:"flex items-center"},ge={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ye={class:"space-y-4"},ce={class:"space-y-2"},xe={class:"flex items-center"},ve={class:"flex items-center"},we={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ke={class:"space-y-3 text-sm text-gray-600"},Ue={class:"flex justify-between"},Ve={class:"flex justify-between"},_e={class:"flex justify-between"},he={class:"flex justify-between"},je={class:"flex justify-between"},Te={class:"flex items-center"},Ae={class:"flex justify-between"},Ce={class:"flex items-center"},Me={key:2,class:"text-center py-12"},Ne=G({__name:"edit",setup(ze){const h=q().params.id,a=v(null),U=v(!0),f=v(!1),l=v({email:"",full_name:"",phone:"",role:"user",status:"active",bio:"",date_of_birth:"",gender:"male",nationality:"",address:"",city:"",country:"",postal_code:"",preferences:{language:"ar",timezone:"Asia/Riyadh",notifications:{email:!0,sms:!0,push:!0},privacy:{profile_visibility:"public",show_email:!1,show_phone:!1}}}),B=H(()=>l.value.email&&l.value.full_name),L=async()=>{var i,e,d,g,y,o,j,T,A,C,M,z,D,E;try{U.value=!0;const r=await $fetch(`/api/admin/users/${h}`);if(r.success&&r.data)a.value=r.data,l.value={email:r.data.email,full_name:r.data.full_name||"",phone:r.data.phone||"",role:r.data.role,status:r.data.status,bio:r.data.bio||"",date_of_birth:r.data.date_of_birth||"",gender:r.data.gender||"male",nationality:r.data.nationality||"",address:r.data.address||"",city:r.data.city||"",country:r.data.country||"",postal_code:r.data.postal_code||"",preferences:{language:((i=r.data.preferences)==null?void 0:i.language)||"ar",timezone:((e=r.data.preferences)==null?void 0:e.timezone)||"Asia/Riyadh",notifications:{email:((g=(d=r.data.preferences)==null?void 0:d.notifications)==null?void 0:g.email)??!0,sms:((o=(y=r.data.preferences)==null?void 0:y.notifications)==null?void 0:o.sms)??!0,push:((T=(j=r.data.preferences)==null?void 0:j.notifications)==null?void 0:T.push)??!0},privacy:{profile_visibility:((C=(A=r.data.preferences)==null?void 0:A.privacy)==null?void 0:C.profile_visibility)||"public",show_email:((z=(M=r.data.preferences)==null?void 0:M.privacy)==null?void 0:z.show_email)??!1,show_phone:((E=(D=r.data.preferences)==null?void 0:D.privacy)==null?void 0:E.show_phone)??!1}}};else throw new Error(r.error||"فشل في تحميل بيانات المستخدم")}catch(r){console.error("Error loading user:",r)}finally{U.value=!1}},N=async()=>{try{f.value=!0;const i=await $fetch(`/api/admin/users/${h}`,{method:"PUT",body:l.value});if(i.success)a.value&&Object.assign(a.value,i.data),console.log("تم تحديث بيانات المستخدم بنجاح");else throw new Error(i.error||"فشل في تحديث بيانات المستخدم")}catch(i){console.error("Error updating user:",i)}finally{f.value=!1}},V=i=>new Date(i).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return I(()=>{L()}),F({title:"تعديل المستخدم - Wonder Land Admin",meta:[{name:"description",content:"تعديل بيانات المستخدم"},{name:"robots",content:"noindex, nofollow"}]}),(i,e)=>{var y;const d=S,g=$;return k(),w("div",O,[s("div",P,[s("div",null,[e[21]||(e[21]=s("h1",{class:"text-2xl font-bold text-gray-900"},"تعديل المستخدم",-1)),s("p",W,"تعديل بيانات المستخدم: "+m(((y=t(a))==null?void 0:y.full_name)||"غير محدد"),1)]),s("div",J,[p(g,{to:"/admin/users",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},{default:R(()=>[p(d,{name:"material-symbols:arrow-back",class:"h-4 w-4 ml-2"}),e[22]||(e[22]=c(" العودة "))]),_:1}),s("button",{onClick:N,disabled:t(f)||!t(B),class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[p(d,{name:"material-symbols:save",class:_(["h-4 w-4 ml-2",{"animate-spin":t(f)}])},null,8,["class"]),c(" "+m(t(f)?"جاري الحفظ...":"حفظ التغييرات"),1)],8,K)])]),t(U)?(k(),w("div",Q,[p(d,{name:"material-symbols:progress-activity",class:"animate-spin h-8 w-8 text-blue-600"}),e[23]||(e[23]=s("span",{class:"mr-3 text-gray-600"},"جارٍ تحميل بيانات المستخدم...",-1))])):t(a)?(k(),w("div",X,[s("div",Y,[s("div",Z,[e[32]||(e[32]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"المعلومات الشخصية",-1)),s("div",ee,[s("div",null,[e[24]||(e[24]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الاسم الكامل *",-1)),n(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t(l).full_name=o),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل الاسم الكامل"},null,512),[[u,t(l).full_name]])]),s("div",null,[e[25]||(e[25]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"البريد الإلكتروني *",-1)),n(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t(l).email=o),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل البريد الإلكتروني"},null,512),[[u,t(l).email]])]),s("div",null,[e[26]||(e[26]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"رقم الهاتف",-1)),n(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>t(l).phone=o),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+966501234567"},null,512),[[u,t(l).phone]])]),s("div",null,[e[27]||(e[27]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"تاريخ الميلاد",-1)),n(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>t(l).date_of_birth=o),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[u,t(l).date_of_birth]])]),s("div",null,[e[29]||(e[29]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الجنس",-1)),n(s("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>t(l).gender=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[28]||(e[28]=[s("option",{value:""},"اختر الجنس",-1),s("option",{value:"male"},"ذكر",-1),s("option",{value:"female"},"أنثى",-1),s("option",{value:"other"},"آخر",-1)]),512),[[b,t(l).gender]])]),s("div",null,[e[30]||(e[30]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الجنسية",-1)),n(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>t(l).nationality=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"الجنسية"},null,512),[[u,t(l).nationality]])])]),s("div",se,[e[31]||(e[31]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"نبذة شخصية",-1)),n(s("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>t(l).bio=o),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل نبذة شخصية"},null,512),[[u,t(l).bio]])])]),s("div",te,[e[37]||(e[37]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"العنوان",-1)),s("div",le,[s("div",oe,[e[33]||(e[33]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"العنوان الكامل",-1)),n(s("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>t(l).address=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل العنوان الكامل"},null,512),[[u,t(l).address]])]),s("div",null,[e[34]||(e[34]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"المدينة",-1)),n(s("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>t(l).city=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"المدينة"},null,512),[[u,t(l).city]])]),s("div",null,[e[35]||(e[35]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"البلد",-1)),n(s("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>t(l).country=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"البلد"},null,512),[[u,t(l).country]])]),s("div",null,[e[36]||(e[36]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الرمز البريدي",-1)),n(s("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>t(l).postal_code=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"الرمز البريدي"},null,512),[[u,t(l).postal_code]])])])])]),s("div",re,[s("div",ne,[e[42]||(e[42]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"الحالة والدور",-1)),s("div",ae,[s("div",null,[e[39]||(e[39]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الدور",-1)),n(s("select",{"onUpdate:modelValue":e[11]||(e[11]=o=>t(l).role=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[38]||(e[38]=[s("option",{value:"user"},"مستخدم",-1),s("option",{value:"moderator"},"مشرف",-1),s("option",{value:"admin"},"مدير",-1)]),512),[[b,t(l).role]])]),s("div",null,[e[41]||(e[41]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الحالة",-1)),n(s("select",{"onUpdate:modelValue":e[12]||(e[12]=o=>t(l).status=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[40]||(e[40]=[s("option",{value:"active"},"نشط",-1),s("option",{value:"inactive"},"غير نشط",-1),s("option",{value:"suspended"},"معلق",-1)]),512),[[b,t(l).status]])])])]),s("div",ie,[e[47]||(e[47]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"الإعدادات",-1)),s("div",de,[s("div",null,[e[44]||(e[44]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"اللغة",-1)),n(s("select",{"onUpdate:modelValue":e[13]||(e[13]=o=>t(l).preferences.language=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[43]||(e[43]=[s("option",{value:"ar"},"العربية",-1),s("option",{value:"en"},"English",-1)]),512),[[b,t(l).preferences.language]])]),s("div",null,[e[46]||(e[46]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"المنطقة الزمنية",-1)),n(s("select",{"onUpdate:modelValue":e[14]||(e[14]=o=>t(l).preferences.timezone=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[45]||(e[45]=[s("option",{value:"Asia/Riyadh"},"الرياض (GMT+3)",-1),s("option",{value:"Asia/Dubai"},"دبي (GMT+4)",-1),s("option",{value:"UTC"},"UTC (GMT+0)",-1)]),512),[[b,t(l).preferences.timezone]])])])]),s("div",ue,[e[51]||(e[51]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"الإشعارات",-1)),s("div",pe,[s("label",me,[n(s("input",{"onUpdate:modelValue":e[15]||(e[15]=o=>t(l).preferences.notifications.email=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[x,t(l).preferences.notifications.email]]),e[48]||(e[48]=s("span",{class:"mr-2 text-sm text-gray-700"},"إشعارات البريد الإلكتروني",-1))]),s("label",be,[n(s("input",{"onUpdate:modelValue":e[16]||(e[16]=o=>t(l).preferences.notifications.sms=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[x,t(l).preferences.notifications.sms]]),e[49]||(e[49]=s("span",{class:"mr-2 text-sm text-gray-700"},"إشعارات الرسائل النصية",-1))]),s("label",fe,[n(s("input",{"onUpdate:modelValue":e[17]||(e[17]=o=>t(l).preferences.notifications.push=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[x,t(l).preferences.notifications.push]]),e[50]||(e[50]=s("span",{class:"mr-2 text-sm text-gray-700"},"الإشعارات الفورية",-1))])])]),s("div",ge,[e[56]||(e[56]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"الخصوصية",-1)),s("div",ye,[s("div",null,[e[53]||(e[53]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"رؤية الملف الشخصي",-1)),n(s("select",{"onUpdate:modelValue":e[18]||(e[18]=o=>t(l).preferences.privacy.profile_visibility=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[52]||(e[52]=[s("option",{value:"public"},"عام",-1),s("option",{value:"private"},"خاص",-1),s("option",{value:"friends"},"الأصدقاء فقط",-1)]),512),[[b,t(l).preferences.privacy.profile_visibility]])]),s("div",ce,[s("label",xe,[n(s("input",{"onUpdate:modelValue":e[19]||(e[19]=o=>t(l).preferences.privacy.show_email=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[x,t(l).preferences.privacy.show_email]]),e[54]||(e[54]=s("span",{class:"mr-2 text-sm text-gray-700"},"إظهار البريد الإلكتروني",-1))]),s("label",ve,[n(s("input",{"onUpdate:modelValue":e[20]||(e[20]=o=>t(l).preferences.privacy.show_phone=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[x,t(l).preferences.privacy.show_phone]]),e[55]||(e[55]=s("span",{class:"mr-2 text-sm text-gray-700"},"إظهار رقم الهاتف",-1))])])])]),s("div",we,[e[63]||(e[63]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"معلومات إضافية",-1)),s("div",ke,[s("div",Ue,[e[57]||(e[57]=s("span",null,"تاريخ التسجيل:",-1)),s("span",null,m(V(t(a).created_at)),1)]),s("div",Ve,[e[58]||(e[58]=s("span",null,"آخر تحديث:",-1)),s("span",null,m(V(t(a).updated_at)),1)]),s("div",_e,[e[59]||(e[59]=s("span",null,"آخر دخول:",-1)),s("span",null,m(t(a).last_login?V(t(a).last_login):"لم يسجل دخول"),1)]),s("div",he,[e[60]||(e[60]=s("span",null,"عدد مرات الدخول:",-1)),s("span",null,m(t(a).login_count||0),1)]),s("div",je,[e[61]||(e[61]=s("span",null,"البريد مؤكد:",-1)),s("span",Te,[p(d,{name:t(a).email_verified?"material-symbols:check-circle":"material-symbols:cancel",class:_([t(a).email_verified?"text-green-500":"text-red-500","h-4 w-4 ml-1"])},null,8,["name","class"]),c(" "+m(t(a).email_verified?"نعم":"لا"),1)])]),s("div",Ae,[e[62]||(e[62]=s("span",null,"الهاتف مؤكد:",-1)),s("span",Ce,[p(d,{name:t(a).phone_verified?"material-symbols:check-circle":"material-symbols:cancel",class:_([t(a).phone_verified?"text-green-500":"text-red-500","h-4 w-4 ml-1"])},null,8,["name","class"]),c(" "+m(t(a).phone_verified?"نعم":"لا"),1)])])])])])])):(k(),w("div",Me,[p(d,{name:"material-symbols:person-off",class:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e[65]||(e[65]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"المستخدم غير موجود",-1)),e[66]||(e[66]=s("p",{class:"text-gray-500 mb-6"},"لم يتم العثور على المستخدم المطلوب",-1)),p(g,{to:"/admin/users",class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},{default:R(()=>[p(d,{name:"material-symbols:arrow-back",class:"h-5 w-5 ml-2"}),e[64]||(e[64]=c(" العودة إلى قائمة المستخدمين "))]),_:1})]))])}}});export{Ne as default};
