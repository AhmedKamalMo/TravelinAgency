import J from"./DpQTdEsJ.js";import{_ as R}from"./Bu0W61Is.js";import{A as H,B as W,h as b,m as z,c as u,o as i,a as t,f as P,b as c,w as K,d as y,i as s,H as O,t as _,j as Q,k as n,v as m,F as w,r as h,T as D,U as X,l as Y,J as Z}from"./BPMBOJUR.js";import{_ as ee}from"./Bj-8BsSo.js";import{u as C}from"./Dykduai_.js";import{u as te}from"./Df6Qpn-N.js";import"./x_rD_Ya3.js";const le={class:"space-y-6"},se={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},oe={class:"mt-4 sm:mt-0"},re={key:1,class:"flex justify-center items-center py-12"},ae={key:2,class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center"},ne={class:"text-red-600 mb-4"},de={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ie={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ue={class:"lg:col-span-2 space-y-6"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"space-y-2"},ge=["onUpdate:modelValue","placeholder"],be=["onClick"],ye={class:"space-y-2"},fe={class:"text-sm font-medium text-gray-600 w-16"},xe=["onUpdate:modelValue","placeholder"],ve=["onClick"],ke={class:"space-y-6"},_e={class:"bg-gray-50 rounded-lg p-4"},we={class:"space-y-4"},he={class:"bg-gray-50 rounded-lg p-4"},Ue={class:"space-y-4"},Ve={class:"flex items-center"},Ce={class:"bg-gray-50 rounded-lg p-4"},Ie={class:"space-y-4"},$e={class:"space-y-2"},Ee=["onUpdate:modelValue","placeholder"],Pe=["onClick"],De={class:"space-y-2"},Ne=["onUpdate:modelValue","placeholder"],Me=["onClick"],Te={class:"flex justify-end pt-6 border-t border-gray-200"},qe=["disabled"],Re={__name:"edit",setup(Be){const k=H(),g=W(()=>k.params.id),U=b(!0),f=b(!1),V=b(""),I=b(""),x=b(""),l=b({title_ar:"",title_en:"",description_ar:"",description_en:"",price:0,duration_days:1,travel_period:"",max_persons:10,category:"domestic",status:"active",featured:!1,image_url:"",features:[""],itinerary:[""],included:[""],excluded:[""]}),$=async()=>{try{U.value=!0,x.value="",console.log("🔄 Loading package with ID:",g.value),console.log("🔄 API URL:",`/api/packages/${g.value}`);const a=await $fetch(`/api/packages/${g.value}`);console.log("✅ API result:",a);const e=(a==null?void 0:a.package)||a;console.log("📦 Package data:",e),e?(l.value={title_ar:e.title_ar||"",title_en:e.title_en||"",description_ar:e.description_ar||"",description_en:e.description_en||"",price:e.price||0,duration_days:e.duration_days||e.duration||1,travel_period:e.travel_period||e.location||"",max_persons:e.max_persons||10,category:e.category||"domestic",status:e.status||"active",featured:e.featured||!1,image_url:e.image_url||e.image||"",features:e.features&&e.features.length>0?e.features:[""],itinerary:e.itinerary&&e.itinerary.length>0?e.itinerary:[""],included:e.included&&e.included.length>0?e.included:[""],excluded:e.excluded&&e.excluded.length>0?e.excluded:[""]},console.log("✅ Form data loaded:",l.value)):(x.value="لم يتم العثور على بيانات الباقة",console.log("❌ No package data found"))}catch(a){console.error("❌ خطأ في تحميل الباقة:",a),x.value=a.message||"خطأ في تحميل بيانات الباقة. يرجى المحاولة مرة أخرى."}finally{U.value=!1,console.log("🏁 Loading completed")}},N=a=>{const{showSuccess:e}=C();e("تم رفع الصورة","تم رفع الصورة بنجاح!")},M=a=>{const{showError:e}=C();e("خطأ في رفع الصورة",a.message||"حدث خطأ في رفع الصورة")},T=async()=>{const{showSuccess:a,showError:e,showWarning:d}=C();try{if(f.value=!0,!l.value.title_ar||!l.value.title_en||!l.value.description_ar||!l.value.description_en){d("حقول مطلوبة","يرجى ملء جميع الحقول المطلوبة");return}const v={...l.value,features:l.value.features.filter(o=>o.trim()),itinerary:l.value.itinerary.filter(o=>o.trim()),included:l.value.included.filter(o=>o.trim()),excluded:l.value.excluded.filter(o=>o.trim())};(await $fetch(`/api/packages/${g.value}`,{method:"PUT",body:v})).success?(a("تم التحديث بنجاح","تم تحديث الباقة بنجاح!"),setTimeout(async()=>{await Z(`/admin/packages/${g.value}`)},1500)):e("فشل في التحديث","فشل في تحديث الباقة. يرجى المحاولة مرة أخرى.")}catch(v){console.error("خطأ في تحديث الباقة:",v),e("خطأ في التحديث","حدث خطأ في تحديث الباقة. يرجى المحاولة مرة أخرى.")}finally{f.value=!1}},E=()=>{V.value="",I.value=""},q=()=>{l.value.features.push("")},B=a=>{l.value.features.length>1&&l.value.features.splice(a,1)},F=()=>{l.value.itinerary.push("")},L=a=>{l.value.itinerary.length>1&&l.value.itinerary.splice(a,1)},j=()=>{l.value.included.push("")},S=a=>{l.value.included.length>1&&l.value.included.splice(a,1)},A=()=>{l.value.excluded.push("")},G=a=>{l.value.excluded.length>1&&l.value.excluded.splice(a,1)};return z(()=>{console.log("🚀 Edit page mounted, package ID:",g.value),console.log("📍 Route params:",k.params),console.log("📍 Current route:",k.path),console.log("📍 Full route object:",k),$()}),te({title:"تحرير الباقة - Wonder Land Admin",meta:[{name:"description",content:"تحرير تفاصيل الباقة السياحية"},{name:"robots",content:"noindex, nofollow"}]}),(a,e)=>{const d=J,v=R;return i(),u("div",le,[e[42]||(e[42]=t("div",{class:"h-16"},null,-1)),t("div",se,[e[13]||(e[13]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"تحرير الباقة السياحية"),t("p",{class:"mt-1 text-sm text-gray-600"},"تعديل تفاصيل الباقة السياحية")],-1)),t("div",oe,[c(v,{to:"/admin/packages",class:"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},{default:K(()=>[c(d,{name:"material-symbols:arrow-back",class:"h-5 w-5 ml-2"}),e[12]||(e[12]=y(" العودة "))]),_:1})])]),s(V)?(i(),u("div",{key:0,class:O(["p-4 rounded-lg mb-6",s(I)==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"])},_(s(V)),3)):P("",!0),s(U)?(i(),u("div",re,[c(d,{name:"material-symbols:progress-activity",class:"animate-spin h-8 w-8 text-blue-600"}),e[14]||(e[14]=t("span",{class:"mr-3 text-gray-600"},"جارٍ تحميل الباقة...",-1))])):s(x)?(i(),u("div",ae,[c(d,{name:"material-symbols:error",class:"h-12 w-12 text-red-500 mx-auto mb-4"}),e[15]||(e[15]=t("h3",{class:"text-lg font-medium text-red-800 mb-2"},"خطأ في تحميل الباقة",-1)),t("p",ne,_(s(x)),1),t("button",{onClick:$,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," إعادة المحاولة ")])):(i(),u("form",{key:3,onSubmit:Q(T,["prevent"]),class:"space-y-6"},[t("div",de,[t("div",ie,[t("div",ue,[t("div",ce,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"العنوان (عربي)",-1)),n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s(l).title_ar=r),onInput:E,type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل العنوان بالعربية"},null,544),[[m,s(l).title_ar]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"العنوان (إنجليزي)",-1)),n(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s(l).title_en=r),onInput:E,type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter title in English"},null,544),[[m,s(l).title_en]])])]),t("div",me,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الوصف (عربي)",-1)),n(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=r=>s(l).description_ar=r),rows:"4",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل الوصف بالعربية"},null,512),[[m,s(l).description_ar]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الوصف (إنجليزي)",-1)),n(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=r=>s(l).description_en=r),rows:"4",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter description in English"},null,512),[[m,s(l).description_en]])])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"صورة الباقة",-1)),c(ee,{modelValue:s(l).image_url,"onUpdate:modelValue":e[4]||(e[4]=r=>s(l).image_url=r),alt:"صورة الباقة","upload-type":"package",onUploadComplete:N,onUploadError:M},null,8,["modelValue"]),e[21]||(e[21]=t("p",{class:"mt-2 text-xs text-gray-500"}," يمكنك رفع صورة JPG, PNG, JPEG بحجم أقصى 5MB ",-1))]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"المميزات",-1)),t("div",pe,[(i(!0),u(w,null,h(s(l).features,(r,o)=>(i(),u("div",{key:o,class:"flex items-center space-x-2 space-x-reverse"},[n(t("input",{"onUpdate:modelValue":p=>s(l).features[o]=p,type:"text",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`الميزة ${o+1}`},null,8,ge),[[m,s(l).features[o]]]),t("button",{type:"button",onClick:p=>B(o),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg"},[c(d,{name:"material-symbols:delete",class:"h-5 w-5"})],8,be)]))),128)),t("button",{type:"button",onClick:q,class:"inline-flex items-center px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg"},[c(d,{name:"material-symbols:add",class:"h-4 w-4 ml-1"}),e[22]||(e[22]=y(" إضافة ميزة "))])])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"البرنامج اليومي",-1)),t("div",ye,[(i(!0),u(w,null,h(s(l).itinerary,(r,o)=>(i(),u("div",{key:o,class:"flex items-center space-x-2 space-x-reverse"},[t("span",fe,"اليوم "+_(o+1)+":",1),n(t("input",{"onUpdate:modelValue":p=>s(l).itinerary[o]=p,type:"text",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`نشاط اليوم ${o+1}`},null,8,xe),[[m,s(l).itinerary[o]]]),t("button",{type:"button",onClick:p=>L(o),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg"},[c(d,{name:"material-symbols:delete",class:"h-5 w-5"})],8,ve)]))),128)),t("button",{type:"button",onClick:F,class:"inline-flex items-center px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg"},[c(d,{name:"material-symbols:add",class:"h-4 w-4 ml-1"}),e[24]||(e[24]=y(" إضافة يوم "))])])])]),t("div",ke,[t("div",_e,[e[30]||(e[30]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"التفاصيل الأساسية",-1)),t("div",we,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"السعر (ريال سعودي)",-1)),n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>s(l).price=r),type:"number",min:"0",step:"0.01",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[m,s(l).price,void 0,{number:!0}]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"المدة (أيام)",-1)),n(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>s(l).duration_days=r),type:"number",min:"1",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[m,s(l).duration_days,void 0,{number:!0}]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الوجهة",-1)),n(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>s(l).travel_period=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: دبي، تركيا، ماليزيا"},null,512),[[m,s(l).travel_period]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الحد الأقصى للأشخاص",-1)),n(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>s(l).max_persons=r),type:"number",min:"1",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[m,s(l).max_persons,void 0,{number:!0}]])])])]),t("div",he,[e[36]||(e[36]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"التصنيف",-1)),t("div",Ue,[t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الفئة",-1)),n(t("select",{"onUpdate:modelValue":e[9]||(e[9]=r=>s(l).category=r),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[31]||(e[31]=[t("option",{value:"domestic"},"محلي",-1),t("option",{value:"international"},"دولي",-1),t("option",{value:"religious"},"ديني",-1),t("option",{value:"adventure"},"مغامرة",-1)]),512),[[D,s(l).category]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"الحالة",-1)),n(t("select",{"onUpdate:modelValue":e[10]||(e[10]=r=>s(l).status=r),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[33]||(e[33]=[t("option",{value:"active"},"نشط",-1),t("option",{value:"inactive"},"غير نشط",-1),t("option",{value:"draft"},"مسودة",-1)]),512),[[D,s(l).status]])]),t("div",Ve,[n(t("input",{"onUpdate:modelValue":e[11]||(e[11]=r=>s(l).featured=r),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[X,s(l).featured]]),e[35]||(e[35]=t("label",{class:"mr-2 text-sm text-gray-700"},"حزمة مميزة",-1))])])]),t("div",Ce,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"التفاصيل الإضافية",-1)),t("div",Ie,[t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ما يشمل",-1)),t("div",$e,[(i(!0),u(w,null,h(s(l).included,(r,o)=>(i(),u("div",{key:o,class:"flex items-center space-x-2 space-x-reverse"},[n(t("input",{"onUpdate:modelValue":p=>s(l).included[o]=p,type:"text",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:`البند ${o+1}`},null,8,Ee),[[m,s(l).included[o]]]),t("button",{type:"button",onClick:p=>S(o),class:"p-1 text-red-600 hover:bg-red-50 rounded"},[c(d,{name:"material-symbols:delete",class:"h-4 w-4"})],8,Pe)]))),128)),t("button",{type:"button",onClick:j,class:"inline-flex items-center px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 rounded"},[c(d,{name:"material-symbols:add",class:"h-3 w-3 ml-1"}),e[37]||(e[37]=y(" إضافة "))])])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ما لا يشمل",-1)),t("div",De,[(i(!0),u(w,null,h(s(l).excluded,(r,o)=>(i(),u("div",{key:o,class:"flex items-center space-x-2 space-x-reverse"},[n(t("input",{"onUpdate:modelValue":p=>s(l).excluded[o]=p,type:"text",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:`البند ${o+1}`},null,8,Ne),[[m,s(l).excluded[o]]]),t("button",{type:"button",onClick:p=>G(o),class:"p-1 text-red-600 hover:bg-red-50 rounded"},[c(d,{name:"material-symbols:delete",class:"h-4 w-4"})],8,Me)]))),128)),t("button",{type:"button",onClick:A,class:"inline-flex items-center px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 rounded"},[c(d,{name:"material-symbols:add",class:"h-3 w-3 ml-1"}),e[39]||(e[39]=y(" إضافة "))])])])])])])]),t("div",Te,[t("button",{type:"submit",disabled:s(f),class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"},[s(f)?(i(),Y(d,{key:0,name:"material-symbols:progress-activity",class:"animate-spin h-4 w-4 ml-2 inline"})):P("",!0),y(" "+_(s(f)?"جاري الحفظ...":"حفظ التغييرات"),1)],8,qe)])])],32))])}}};export{Re as default};
