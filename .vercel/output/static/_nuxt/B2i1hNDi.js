import R from"./BOaYbNxV.js";import{g as b,m as q,c as d,o as a,b as t,e as w,a as m,l as C,h as l,j as E,t as p,H as j,i as c,v as g,T as M,F as J,r as K,G as Q}from"./DbWDakc_.js";const W={class:"space-y-6"},X={class:"flex justify-between items-center"},Y={class:"flex space-x-3 space-x-reverse"},Z=["disabled"],ee={key:0,class:"text-center py-12"},te={key:1,class:"text-center py-12"},se={key:2,class:"space-y-6"},oe={class:"bg-white rounded-xl p-6 shadow-sm border border-gray-200"},le={class:"flex items-center justify-between mb-4"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={class:"bg-white rounded-xl shadow-sm border border-gray-200"},ae={class:"p-6 border-b border-gray-200"},ie={class:"flex justify-between items-center"},de={class:"p-6"},ue={key:0,class:"text-center py-8"},ce={key:1,class:"space-y-4"},be={class:"flex items-center justify-between mb-4"},me={class:"flex items-center"},ge={class:"p-2 bg-blue-100 rounded-lg ml-3"},pe={class:"font-medium text-gray-900"},xe={class:"text-sm text-gray-600"},ye={class:"flex items-center space-x-2 space-x-reverse"},fe=["onClick"],ve=["onClick"],we=["onClick"],he={class:"bg-gray-50 rounded-lg p-4"},ke={class:"text-sm"},_e={key:0,class:"font-medium text-gray-900 mb-1"},Ce={key:1,class:"text-gray-600 mb-2"},$e=["innerHTML"],Se={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ve={class:"bg-white rounded-xl p-6 w-full max-w-md mx-4"},Te={class:"flex justify-between items-center mb-4"},Ue={class:"space-y-4"},Ee={class:"flex justify-end space-x-3 space-x-reverse mt-6"},je={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Me={class:"bg-white rounded-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},He={class:"flex justify-between items-center mb-4"},Ne={class:"space-y-4"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Be={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ie={class:"flex justify-end space-x-3 space-x-reverse mt-6"},Fe={__name:"homepage",setup(Le){const k=b(!0),_=b(!1),f=b(!1),i=b(null),u=b([]),x=b(!1),v=b(!1),n=b(null),y=b({section_type:"hero",title:"",subtitle:"",content:"",background_color:"#1e40af",text_color:"#ffffff",order_index:0}),H=s=>({published:"منشور",draft:"مسودة",archived:"مؤرشف"})[s]||s,N=s=>({hero:"material-symbols:home",about:"material-symbols:info",services:"material-symbols:work",testimonials:"material-symbols:star",contact:"material-symbols:contact-mail",generic:"material-symbols:article"})[s]||"material-symbols:article",$=s=>({hero:"قسم البطل",about:"من نحن",services:"الخدمات",testimonials:"الشهادات",contact:"التواصل",generic:"قسم عام"})[s]||s,P=(s,e)=>{if(!s)return"";const r=s.replace(/<[^>]*>/g,"");return r.length>e?r.substring(0,e)+"...":r},S=async()=>{try{k.value=!0,_.value=!1;const s=await $fetch("/api/cms/pages/home");s.success?(i.value=s.data.page,u.value=s.data.sections||[]):await B()}catch(s){console.error("Error loading homepage content:",s),_.value=!0}finally{k.value=!1}},B=async()=>{try{const s=await $fetch("/api/cms/pages",{method:"POST",body:{slug:"home",title:"الصفحة الرئيسية",status:"published"}});s.success&&(i.value=s.data.page,u.value=[])}catch(s){console.error("Error creating homepage page:",s)}},I=async()=>{try{const s=await $fetch("/api/cms/sections",{method:"POST",body:{page_id:i.value.id,...y.value}});s.success&&(u.value.push(s.data.section),x.value=!1,G())}catch(s){console.error("Error adding section:",s)}},L=s=>{n.value={...s},v.value=!0},z=async()=>{try{const s=await $fetch(`/api/cms/sections/${n.value.id}`,{method:"PUT",body:n.value});if(s.success){const e=u.value.findIndex(r=>r.id===n.value.id);e!==-1&&(u.value[e]=s.data.section),v.value=!1,n.value=null}}catch(s){console.error("Error saving section:",s)}},A=async s=>{if(confirm("هل أنت متأكد من حذف هذا القسم؟"))try{await $fetch(`/api/cms/sections/${s.id}`,{method:"DELETE"}),u.value=u.value.filter(e=>e.id!==s.id)}catch(e){console.error("Error deleting section:",e)}},D=async s=>{try{if((await $fetch(`/api/cms/sections/${s.id}`,{method:"PUT",body:{is_active:!s.is_active}})).success){const r=u.value.findIndex(h=>h.id===s.id);r!==-1&&(u.value[r].is_active=!u.value[r].is_active)}}catch(e){console.error("Error toggling section:",e)}},F=async()=>{try{f.value=!0,i.value&&await $fetch(`/api/cms/pages/${i.value.id}`,{method:"PUT",body:{title:i.value.title,status:i.value.status}}),alert("تم حفظ جميع التغييرات بنجاح!")}catch(s){console.error("Error saving changes:",s),alert("حدث خطأ في حفظ التغييرات")}finally{f.value=!1}},O=()=>{window.open("/","_blank")},G=()=>{y.value={section_type:"hero",title:"",subtitle:"",content:"",background_color:"#1e40af",text_color:"#ffffff",order_index:0}};return q(()=>{S()}),(s,e)=>{var h,V,T;const r=R;return a(),d("div",W,[e[39]||(e[39]=t("div",{class:"h-16"},null,-1)),t("div",X,[e[17]||(e[17]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"إدارة الصفحة الرئيسية"),t("p",{class:"text-gray-600"},"تعديل محتوى وعرض الصفحة الرئيسية")],-1)),t("div",Y,[t("button",{onClick:O,class:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center"},[m(r,{name:"material-symbols:visibility",class:"h-5 w-5 ml-2"}),e[16]||(e[16]=C(" معاينة "))]),t("button",{onClick:F,disabled:l(f),class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center disabled:opacity-50"},[l(f)?(a(),E(r,{key:0,name:"material-symbols:refresh",class:"h-5 w-5 ml-2 animate-spin"})):(a(),E(r,{key:1,name:"material-symbols:save",class:"h-5 w-5 ml-2"})),C(" "+p(l(f)?"جاري الحفظ...":"حفظ التغييرات"),1)],8,Z)])]),l(k)?(a(),d("div",ee,[m(r,{name:"material-symbols:refresh",class:"h-12 w-12 text-blue-600 animate-spin mx-auto mb-4"}),e[18]||(e[18]=t("p",{class:"text-gray-600"},"جاري تحميل محتوى الصفحة الرئيسية...",-1))])):l(_)?(a(),d("div",te,[m(r,{name:"material-symbols:error",class:"h-12 w-12 text-red-600 mx-auto mb-4"}),e[19]||(e[19]=t("p",{class:"text-gray-600 mb-4"},"حدث خطأ في تحميل المحتوى",-1)),t("button",{onClick:S,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"}," إعادة المحاولة ")])):(a(),d("div",se,[t("div",oe,[t("div",le,[e[20]||(e[20]=t("h2",{class:"text-lg font-semibold text-gray-900"},"معلومات الصفحة الرئيسية",-1)),t("span",{class:j(["px-3 py-1 text-sm font-medium rounded-full",((h=l(i))==null?void 0:h.status)==="published"?"bg-green-100 text-green-800":((V=l(i))==null?void 0:V.status)==="draft"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},p(H((T=l(i))==null?void 0:T.status)),3)]),t("div",re,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"عنوان الصفحة",-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l(i).title=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"عنوان الصفحة الرئيسية"},null,512),[[g,l(i).title]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"حالة النشر",-1)),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>l(i).status=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[22]||(e[22]=[t("option",{value:"draft"},"مسودة",-1),t("option",{value:"published"},"منشور",-1)]),512),[[M,l(i).status]])])])]),t("div",ne,[t("div",ae,[t("div",ie,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-gray-900"},"أقسام الصفحة الرئيسية",-1)),t("button",{onClick:e[2]||(e[2]=o=>x.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center"},[m(r,{name:"material-symbols:add",class:"h-5 w-5 ml-2"}),e[24]||(e[24]=C(" إضافة قسم "))])])]),t("div",de,[l(u).length===0?(a(),d("div",ue,[m(r,{name:"material-symbols:add-box",class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e[26]||(e[26]=t("p",{class:"text-gray-600 mb-4"},"لا توجد أقسام بعد",-1)),t("button",{onClick:e[3]||(e[3]=o=>x.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"}," إضافة أول قسم ")])):(a(),d("div",ce,[(a(!0),d(J,null,K(l(u),(o,ze)=>(a(),d("div",{key:o.id,class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},[t("div",be,[t("div",me,[t("div",ge,[m(r,{name:N(o.section_type),class:"h-5 w-5 text-blue-600"},null,8,["name"])]),t("div",null,[t("h3",pe,p(o.title||$(o.section_type)),1),t("p",xe,p($(o.section_type)),1)])]),t("div",ye,[t("button",{onClick:U=>D(o),class:j(["px-3 py-1 text-xs font-medium rounded-full",o.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},p(o.is_active?"نشط":"غير نشط"),11,fe),t("button",{onClick:U=>L(o),class:"text-blue-600 hover:text-blue-700 text-sm font-medium"}," تعديل ",8,ve),t("button",{onClick:U=>A(o),class:"text-red-600 hover:text-red-700 text-sm font-medium"}," حذف ",8,we)])]),t("div",he,[e[27]||(e[27]=t("div",{class:"text-sm text-gray-600 mb-2"},"معاينة القسم:",-1)),t("div",ke,[o.title?(a(),d("div",_e,p(o.title),1)):w("",!0),o.subtitle?(a(),d("div",Ce,p(o.subtitle),1)):w("",!0),o.content?(a(),d("div",{key:2,class:"text-gray-500 text-xs",innerHTML:P(o.content,100)},null,8,$e)):w("",!0)])])]))),128))]))])])])),l(x)?(a(),d("div",Se,[t("div",Ve,[t("div",Te,[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold text-gray-900"},"إضافة قسم جديد",-1)),t("button",{onClick:e[4]||(e[4]=o=>x.value=!1),class:"text-gray-400 hover:text-gray-600"},[m(r,{name:"material-symbols:close",class:"h-6 w-6"})])]),t("div",Ue,[t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"نوع القسم",-1)),c(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>l(y).section_type=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},e[29]||(e[29]=[Q('<option value="hero">قسم البطل (Hero)</option><option value="about">من نحن</option><option value="services">الخدمات</option><option value="testimonials">الشهادات</option><option value="contact">التواصل</option><option value="generic">قسم عام</option>',6)]),512),[[M,l(y).section_type]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"عنوان القسم",-1)),c(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>l(y).title=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"عنوان القسم"},null,512),[[g,l(y).title]])])]),t("div",Ee,[t("button",{onClick:e[7]||(e[7]=o=>x.value=!1),class:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors"}," إلغاء "),t("button",{onClick:I,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"}," إضافة ")])])])):w("",!0),l(v)&&l(n)?(a(),d("div",je,[t("div",Me,[t("div",He,[e[32]||(e[32]=t("h3",{class:"text-lg font-semibold text-gray-900"},"تعديل القسم",-1)),t("button",{onClick:e[8]||(e[8]=o=>v.value=!1),class:"text-gray-400 hover:text-gray-600"},[m(r,{name:"material-symbols:close",class:"h-6 w-6"})])]),t("div",Ne,[t("div",Pe,[t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"عنوان القسم",-1)),c(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>l(n).title=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[g,l(n).title]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"العنوان الفرعي",-1)),c(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>l(n).subtitle=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[g,l(n).subtitle]])])]),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"محتوى القسم",-1)),c(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=o=>l(n).content=o),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"محتوى القسم..."},null,512),[[g,l(n).content]])]),t("div",Be,[t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"لون الخلفية",-1)),c(t("input",{"onUpdate:modelValue":e[12]||(e[12]=o=>l(n).background_color=o),type:"color",class:"w-full h-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[g,l(n).background_color]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"لون النص",-1)),c(t("input",{"onUpdate:modelValue":e[13]||(e[13]=o=>l(n).text_color=o),type:"color",class:"w-full h-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[g,l(n).text_color]])]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ترتيب القسم",-1)),c(t("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>l(n).order_index=o),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[g,l(n).order_index,void 0,{number:!0}]])])])]),t("div",Ie,[t("button",{onClick:e[15]||(e[15]=o=>v.value=!1),class:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors"}," إلغاء "),t("button",{onClick:z,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"}," حفظ التغييرات ")])])])):w("",!0)])}}};export{Fe as default};
