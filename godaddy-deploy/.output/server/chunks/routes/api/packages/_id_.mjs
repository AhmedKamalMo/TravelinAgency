import{c as e,g as t,e as a}from"../../../_/nitro.mjs";import{e as i}from"../../../_/database.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";import"mysql2/promise";import"bcryptjs";import"jsonwebtoken";const r=e((async e=>{try{const r=t(e,"id");if(!r)throw a({statusCode:400,statusMessage:"Package ID is required"});const n=await i("\n      SELECT \n        id, \n        title_ar,\n        title_en,\n        description_ar,\n        description_en,\n        price,\n        duration_days as duration,\n        image_url as image,\n        travel_period as location,\n        max_persons,\n        category,\n        featured,\n        active as status,\n        features,\n        itinerary,\n        included,\n        excluded,\n        created_at,\n        updated_at\n      FROM packages \n      WHERE id = ?\n    ",[r]);if(!n||0===n.length)throw a({statusCode:404,statusMessage:"Package not found"});const s=n[0],getImagePath=e=>{if(!e)return"/images/placeholder.svg";if(e.includes("/imported/"))return e;if(e.includes("/images/packages/")&&!e.includes("/imported/")){return`/images/packages/imported/${e.split("/").pop()}`}return e};return{success:!0,package:{id:s.id,image_url:getImagePath(s.image),image:getImagePath(s.image),title_ar:s.title_ar,title_en:s.title_en,title:s.title_ar||s.title_en,description_ar:s.description_ar,description_en:s.description_en,description:s.description_ar||s.description_en,travel_period:s.location||`${s.duration} أيام`,duration_days:s.duration,price:s.price,max_persons:s.max_persons||10,featured:s.featured,location:s.location,category:s.category||"international",status:1===s.status?"active":"inactive",features:JSON.parse(s.features||"[]"),itinerary:JSON.parse(s.itinerary||"[]"),included:JSON.parse(s.included||"[]"),excluded:JSON.parse(s.excluded||"[]"),created_at:s.created_at,updated_at:s.updated_at}}}catch(e){if(console.error("Error fetching package:",e),e.statusCode)throw e;throw a({statusCode:500,statusMessage:"Failed to fetch package"})}}));export{r as default};
//# sourceMappingURL=_id_.mjs.map
