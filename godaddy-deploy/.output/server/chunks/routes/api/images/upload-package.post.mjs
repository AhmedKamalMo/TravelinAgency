import{c as s,k as t,e as o}from"../../../_/nitro.mjs";import{mkdir as e,writeFile as a}from"fs/promises";import{join as i,extname as r}from"path";import{v as m}from"../../../_/v4.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"@iconify/utils";import"node:crypto";import"consola";import"ipx";import"node:path";import"crypto";const p=s((async s=>{try{const p=await t(s);if(!p||0===p.length)throw o({statusCode:400,statusMessage:"No files uploaded"});const n=p.find((s=>"image"===s.name));if(!n||!n.data||!n.filename)throw o({statusCode:400,statusMessage:"Image file is missing or invalid"});const c=i(process.cwd(),"public","images","packages");await e(c,{recursive:!0});const d=r(n.filename),u=`${m()}${d}`,l=i(c,u);await a(l,n.data);return{success:!0,message:"Image uploaded successfully",data:{url:`/images/packages/${u}`}}}catch(s){throw console.error("Error uploading package image:",s),o({statusCode:500,statusMessage:s.message||"Failed to upload package image"})}}));export{p as default};
//# sourceMappingURL=upload-package.post.mjs.map
