#!/usr/bin/env node

console.log('🔧 SETTING UP DATABASE WITH PROVIDED DATA');
console.log('==========================================\n');

console.log('📋 DATABASE SETUP COMMANDS:');
console.log('============================');
console.log('');
console.log('# 1. Create database setup script');
console.log('cat > setup-database.sql << "EOF"');
console.log('-- Database setup for World Trip Agency');
console.log('USE travel;');
console.log('');
console.log('-- Drop existing tables if they exist');
console.log('DROP TABLE IF EXISTS activity_logs;');
console.log('DROP TABLE IF EXISTS admin_profiles;');
console.log('DROP TABLE IF EXISTS admin_settings;');
console.log('DROP TABLE IF EXISTS bookings;');
console.log('DROP TABLE IF EXISTS cms_content_blocks;');
console.log('DROP TABLE IF EXISTS cms_media;');
console.log('DROP TABLE IF EXISTS cms_navigation;');
console.log('DROP TABLE IF EXISTS cms_pages;');
console.log('DROP TABLE IF EXISTS cms_sections;');
console.log('DROP TABLE IF EXISTS cms_site_settings;');
console.log('DROP TABLE IF EXISTS contact_messages;');
console.log('DROP TABLE IF EXISTS destinations;');
console.log('DROP TABLE IF EXISTS packages;');
console.log('DROP TABLE IF EXISTS profiles;');
console.log('DROP TABLE IF EXISTS users;');
console.log('');
console.log('-- Create users table');
console.log('CREATE TABLE `users` (');
console.log('  `id` varchar(36) NOT NULL DEFAULT (UUID()),');
console.log('  `email` varchar(255) NOT NULL,');
console.log('  `password` varchar(255) NOT NULL,');
console.log('  `full_name` varchar(255) DEFAULT NULL,');
console.log('  `phone` varchar(50) DEFAULT NULL,');
console.log('  `email_verified` tinyint(1) DEFAULT 0,');
console.log('  `email_verified_at` timestamp NULL DEFAULT NULL,');
console.log('  `password_reset_token` varchar(255) DEFAULT NULL,');
console.log('  `password_reset_expires` timestamp NULL DEFAULT NULL,');
console.log('  `last_login` timestamp NULL DEFAULT NULL,');
console.log('  `status` enum(\'active\',\'inactive\',\'suspended\') DEFAULT \'active\',');
console.log('  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),');
console.log('  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),');
console.log('  PRIMARY KEY (`id`),');
console.log('  UNIQUE KEY `email` (`email`)');
console.log(') ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;');
console.log('');
console.log('-- Create admin_profiles table');
console.log('CREATE TABLE `admin_profiles` (');
console.log('  `id` int(11) NOT NULL AUTO_INCREMENT,');
console.log('  `user_id` bigint(20) UNSIGNED NOT NULL,');
console.log('  `role` enum(\'admin\',\'super_admin\',\'moderator\') DEFAULT \'admin\',');
console.log('  `permissions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'{}\' CHECK (json_valid(`permissions`)),');
console.log('  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),');
console.log('  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),');
console.log('  PRIMARY KEY (`id`),');
console.log('  KEY `idx_admin_profiles_user_id` (`user_id`),');
console.log('  KEY `idx_admin_profiles_role` (`role`)');
console.log(') ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;');
console.log('');
console.log('-- Create packages table');
console.log('CREATE TABLE `packages` (');
console.log('  `id` varchar(36) NOT NULL DEFAULT (UUID()),');
console.log('  `title_ar` varchar(255) NOT NULL,');
console.log('  `title_en` varchar(255) NOT NULL,');
console.log('  `description_ar` text DEFAULT NULL,');
console.log('  `description_en` text DEFAULT NULL,');
console.log('  `price` decimal(10,2) NOT NULL CHECK (`price` >= 0),');
console.log('  `duration_days` int(11) DEFAULT 1,');
console.log('  `travel_period` varchar(255) DEFAULT NULL,');
console.log('  `max_persons` int(11) DEFAULT 10,');
console.log('  `category` enum(\'domestic\',\'international\',\'religious\',\'adventure\',\'cultural\') DEFAULT \'domestic\',');
console.log('  `active` tinyint(1) DEFAULT 1,');
console.log('  `featured` tinyint(1) DEFAULT 0,');
console.log('  `image_url` text DEFAULT NULL,');
console.log('  `features` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`features`)),');
console.log('  `itinerary` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`itinerary`)),');
console.log('  `included` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`included`)),');
console.log('  `excluded` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`excluded`)),');
console.log('  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),');
console.log('  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),');
console.log('  PRIMARY KEY (`id`),');
console.log('  KEY `idx_packages_active` (`active`),');
console.log('  KEY `idx_packages_category` (`category`),');
console.log('  KEY `idx_packages_created_at` (`created_at`),');
console.log('  KEY `idx_packages_featured` (`featured`)');
console.log(') ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;');
console.log('');
console.log('-- Create destinations table');
console.log('CREATE TABLE `destinations` (');
console.log('  `id` varchar(36) NOT NULL DEFAULT (UUID()),');
console.log('  `name` varchar(255) NOT NULL,');
console.log('  `description` text DEFAULT NULL,');
console.log('  `country` varchar(100) DEFAULT NULL,');
console.log('  `city` varchar(100) DEFAULT NULL,');
console.log('  `region` varchar(100) DEFAULT NULL,');
console.log('  `type` enum(\'city\',\'landmark\',\'nature\',\'beach\',\'mountain\') DEFAULT \'city\',');
console.log('  `status` enum(\'active\',\'inactive\',\'draft\') DEFAULT \'active\',');
console.log('  `image` text DEFAULT NULL,');
console.log('  `images` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`images`)),');
console.log('  `coordinates` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`coordinates`)),');
console.log('  `climate_info` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'{}\' CHECK (json_valid(`climate_info`)),');
console.log('  `best_time_to_visit` varchar(100) DEFAULT NULL,');
console.log('  `attractions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`attractions`)),');
console.log('  `activities` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`activities`)),');
console.log('  `local_cuisine` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`local_cuisine`)),');
console.log('  `transportation_info` text DEFAULT NULL,');
console.log('  `accommodation_info` text DEFAULT NULL,');
console.log('  `cultural_notes` text DEFAULT NULL,');
console.log('  `safety_info` text DEFAULT NULL,');
console.log('  `budget_info` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'{}\' CHECK (json_valid(`budget_info`)),');
console.log('  `language` varchar(100) DEFAULT NULL,');
console.log('  `currency` varchar(10) DEFAULT NULL,');
console.log('  `timezone` varchar(50) DEFAULT NULL,');
console.log('  `visa_requirements` text DEFAULT NULL,');
console.log('  `health_requirements` text DEFAULT NULL,');
console.log('  `packing_suggestions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT \'[]\' CHECK (json_valid(`packing_suggestions`)),');
console.log('  `views` int(11) DEFAULT 0,');
console.log('  `rating` decimal(2,1) DEFAULT 0.0 CHECK (`rating` >= 0 and `rating` <= 5),');
console.log('  `reviews_count` int(11) DEFAULT 0,');
console.log('  `is_featured` tinyint(1) DEFAULT 0,');
console.log('  `seo_title` varchar(255) DEFAULT NULL,');
console.log('  `seo_description` text DEFAULT NULL,');
console.log('  `seo_keywords` text DEFAULT NULL,');
console.log('  `created_by` varchar(36) DEFAULT NULL,');
console.log('  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),');
console.log('  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),');
console.log('  `region_ar` varchar(255) DEFAULT NULL,');
console.log('  `region_en` varchar(255) DEFAULT NULL,');
console.log('  `location_type_ar` varchar(100) DEFAULT NULL,');
console.log('  `location_type_en` varchar(100) DEFAULT NULL,');
console.log('  `destination_type_ar` varchar(100) DEFAULT NULL,');
console.log('  `destination_type_en` varchar(100) DEFAULT NULL,');
console.log('  `category` enum(\'saudi\',\'international\') DEFAULT \'international\',');
console.log('  `featured` tinyint(1) DEFAULT 0,');
console.log('  `active` tinyint(1) DEFAULT 1,');
console.log('  `name_ar` varchar(255) DEFAULT NULL,');
console.log('  `name_en` varchar(255) DEFAULT NULL,');
console.log('  `description_ar` text DEFAULT NULL,');
console.log('  `description_en` text DEFAULT NULL,');
console.log('  `image_url` text DEFAULT NULL,');
console.log('  PRIMARY KEY (`id`),');
console.log('  KEY `idx_destinations_status` (`status`),');
console.log('  KEY `idx_destinations_type` (`type`),');
console.log('  KEY `idx_destinations_country` (`country`),');
console.log('  KEY `idx_destinations_is_featured` (`is_featured`)');
console.log(') ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;');
console.log('');
console.log('-- Create contact_messages table');
console.log('CREATE TABLE `contact_messages` (');
console.log('  `id` varchar(36) NOT NULL DEFAULT (UUID()),');
console.log('  `name` varchar(255) NOT NULL,');
console.log('  `email` varchar(255) NOT NULL,');
console.log('  `phone` varchar(50) DEFAULT NULL,');
console.log('  `subject` varchar(255) NOT NULL,');
console.log('  `message` text NOT NULL,');
console.log('  `type` enum(\'general\',\'booking\',\'complaint\',\'suggestion\',\'support\') DEFAULT \'general\',');
console.log('  `status` enum(\'new\',\'read\',\'replied\',\'archived\') DEFAULT \'new\',');
console.log('  `priority` enum(\'low\',\'normal\',\'high\',\'urgent\') DEFAULT \'normal\',');
console.log('  `source` varchar(50) DEFAULT \'website\',');
console.log('  `related_package_id` varchar(36) DEFAULT NULL,');
console.log('  `related_destination_id` varchar(36) DEFAULT NULL,');
console.log('  `ip_address` varchar(45) DEFAULT NULL,');
console.log('  `user_agent` text DEFAULT NULL,');
console.log('  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),');
console.log('  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),');
console.log('  PRIMARY KEY (`id`),');
console.log('  KEY `idx_contact_messages_status` (`status`),');
console.log('  KEY `idx_contact_messages_type` (`type`),');
console.log('  KEY `idx_contact_messages_created_at` (`created_at`)');
console.log(') ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;');
console.log('');
console.log('-- Insert sample data');
console.log('INSERT INTO `users` (`id`, `email`, `password`, `full_name`, `phone`, `email_verified`, `email_verified_at`, `password_reset_token`, `password_reset_expires`, `last_login`, `status`, `created_at`, `updated_at`) VALUES');
console.log('(\'39529ff4-9888-11f0-bbdc-106530eb27a7\', \'admin@wonderland.com\', \'$2b$12$MBczo9oAOYkNyxvn4Th.BubTtKJ..xOBkpAK5HBpRJWbRmL53McAm\', \'System Administrator\', NULL, 0, \'2025-09-23 14:18:49\', NULL, NULL, NULL, \'active\', \'2025-09-23 14:18:49\', \'2025-09-23 14:18:49\');');
console.log('');
console.log('INSERT INTO `admin_profiles` (`id`, `user_id`, `role`, `permissions`, `created_at`, `updated_at`) VALUES');
console.log('(1, 39529, \'super_admin\', \'{"manage_users": true, "manage_packages": true, "manage_destinations": true, "manage_bookings": true, "manage_messages": true, "view_analytics": true, "manage_settings": true, "manage_admins": true}\', \'2025-09-23 14:18:49\', \'2025-09-23 14:18:49\');');
console.log('');
console.log('INSERT INTO `packages` (`id`, `title_ar`, `title_en`, `description_ar`, `description_en`, `price`, `duration_days`, `travel_period`, `max_persons`, `category`, `active`, `featured`, `image_url`, `features`, `itinerary`, `included`, `excluded`, `created_at`, `updated_at`) VALUES');
console.log('(\'ca41d9ea-9888-11f0-bbdc-106530eb27a7\', \'رومانسية وثقافة باريس\', \'Paris Romance & Culture\', \'اختبر سحر باريس مع زيارات لبرج إيفل، متحف اللوفر، كاتدرائية نوتردام، وحي مونمارتر الساحر.\', \'Experience the charm of Paris with visits to the Eiffel Tower, Louvre Museum, Notre Dame Cathedral, and the charming Montmartre district.\', 9999.00, 8, \'مارس\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-338515.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:01:42\'),');
console.log('(\'ca4327a8-9888-11f0-bbdc-106530eb27a7\', \'مغامرة طوكيو العصرية\', \'Tokyo Modern Adventure\', \'استكشف مدينة طوكيو النابضة بالحياة، من المعابد القديمة إلى الأحياء الحديثة مثل شيبويا وأكيهابارا. اختبر الثقافة اليابانية والمطبخ والتكنولوجيا.\', \'Explore the vibrant city of Tokyo, from ancient temples to modern districts like Shibuya and Akihabara. Experience Japanese culture, cuisine, and technology.\', 11499.00, 12, \'أبريل\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-2506923.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:05:33\'),');
console.log('(\'ca43be9d-9888-11f0-bbdc-106530eb27a7\', \'مستكشف مدينة نيويورك\', \'New York City Explorer\', \'اكتشف معالم مدينة نيويورك الشهيرة بما في ذلك تايمز سكوير، سنترال بارك، مبنى إمباير ستيت، وعروض برودواي.\', \'Discover famous New York City landmarks including Times Square, Central Park, Empire State Building, and Broadway shows.\', 8999.00, 7, \'مايو\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-802024.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:05:54\'),');
console.log('(\'ca44e141-9888-11f0-bbdc-106530eb27a7\', \'دبي الفاخرة والصحراء\', \'Dubai Luxury & Desert\', \'اختبر التسوق الفاخر، رحلات الصحراء، والهندسة المعمارية الحديثة بما في ذلك برج خليفة وجزيرة النخلة.\', \'Experience luxury shopping, desert safaris, and modern architecture including Burj Khalifa and Palm Jumeirah.\', 12999.00, 9, \'يونيو\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-3787839.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:03:08\'),');
console.log('(\'ca4cfa16-9888-11f0-bbdc-106530eb27a7\', \'رحلة تاريخية إلى روما\', \'Rome Historical Journey\', \'امش في التاريخ بزيارة الكولوسيوم، مدينة الفاتيكان، المنتدى الروماني، واستمتع بالمطبخ الإيطالي الأصيل.\', \'Walk through history visiting the Colosseum, Vatican City, Roman Forum, and enjoy authentic Italian cuisine.\', 9499.00, 10, \'يوليو\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-532263.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:06:32\'),');
console.log('(\'ca58b0b6-9888-11f0-bbdc-106530eb27a7\', \'هروب إلى جنة بالي\', \'Bali Paradise Escape\', \'استرخ في الشواطئ النقية، قم بزيارة المعابد القديمة، استكشف الأراضي الزراعية، واختبر ثقافة بالي.\', \'Relax on pristine beaches, visit ancient temples, explore rice terraces, and experience Balinese culture.\', 7499.00, 13, \'أغسطس\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-1694621.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:06:46\'),');
console.log('(\'ca59457f-9888-11f0-bbdc-106530eb27a7\', \'تجربة لندن الملكية\', \'London Royal Experience\', \'قم بزيارة قصر باكنغهام، برج لندن، بيغ بن، واستمتع بشاي بعد الظهر التقليدية.\', \'Visit Buckingham Palace, Tower of London, Big Ben, and enjoy traditional afternoon tea.\', 10499.00, 8, \'سبتمبر\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-460672.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:10:39\'),');
console.log('(\'ca59ec09-9888-11f0-bbdc-106530eb27a7\', \'جنة سانتوريني اليونانية\', \'Santorini Greek Paradise\', \'اختبر غروب الشمس الرائع، المباني البيضاء، المطبخ المتوسطي، والشواطئ الجميلة.\', \'Experience stunning sunsets, white buildings, Mediterranean cuisine, and beautiful beaches.\', 13999.00, 11, \'أكتوبر\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-1010657.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:11:21\'),');
console.log('(\'ca5a9eef-9888-11f0-bbdc-106530eb27a7\', \'مغامرة ماتشو بيتشو\', \'Machu Picchu Adventure\', \'سافر عبر جبال الأنديز لاكتشاف الحصن القديم للإنكا واستكشف الهندسة المعمارية الاستعمارية في كوسكو.\', \'Travel through the Andes to discover the ancient Inca fortress and explore colonial architecture in Cusco.\', 14999.00, 15, \'نوفمبر\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-2356045.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:09:09\'),');
console.log('(\'ca5b3620-9888-11f0-bbdc-106530eb27a7\', \'ملاذ مالي الفاخر\', \'Maldives Luxury Retreat\', \'اقم في فيلات فوق الماء، استكشف الشواطئ النقية، واستمتع بعلاجات السبا العالمية.\', \'Stay in overwater villas, explore pristine beaches, and enjoy world-class spa treatments.\', 13499.00, 14, \'ديسمبر\', 10, \'international\', 1, 1, \'/images/packages/pexels-photo-1287460.jpg\', \'[]\', \'[]\', \'[]\', \'[]\', \'2025-09-23 14:22:52\', \'2025-09-25 09:08:37\');');
console.log('');
console.log('INSERT INTO `contact_messages` (`id`, `name`, `email`, `phone`, `subject`, `message`, `type`, `status`, `priority`, `source`, `related_package_id`, `related_destination_id`, `ip_address`, `user_agent`, `created_at`, `updated_at`) VALUES');
console.log('(\'38f13445-9a10-11f0-be19-106530eb27a7\', \'khaled ahmed\', \'khaledahmedhaggagy@gmail.com\', \'+966508260274\', \'استفسار عام\', \'السلام عليكم اريد التواصل معي\', \'general\', \'read\', \'normal\', \'website\', NULL, NULL, \'127.0.0.1\', \'Test User Agent\', \'2025-09-25 13:04:51\', \'2025-09-25 13:06:44\'),');
console.log('(\'bfbafee4-9a0f-11f0-be19-106530eb27a7\', \'Test User\', \'test@example.com\', \'+966501234567\', \'استفسار عن Test Package\', \'Test message after Twilio fix\', \'booking\', \'read\', \'normal\', \'website\', \'test-package-id\', NULL, \'127.0.0.1\', \'Test User Agent\', \'2025-09-25 13:01:27\', \'2025-09-25 13:06:44\');');
console.log('');
console.log('EOF');
console.log('');
console.log('# 2. Execute the database setup');
console.log('mysql -u travel -p travel < setup-database.sql');
console.log('');
console.log('# 3. Test the database connection');
console.log('curl -k https://travelin-agency-nlcs.vercel.app/api/packages');
console.log('');
console.log('🎯 This will:');
console.log('✅ Create all necessary database tables');
console.log('✅ Insert sample data from your SQL dump');
console.log('✅ Set up proper database structure');
console.log('✅ Enable real data from database');
