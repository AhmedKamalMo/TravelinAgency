#!/usr/bin/env node

console.log('🔍 DEBUGGING 500 INTERNAL SERVER ERROR');
console.log('======================================\n');

console.log('📋 DEBUGGING COMMANDS:');
console.log('======================');
console.log('');
console.log('# 1. Check if index.html exists');
console.log('ls -la index.html');
console.log('');
console.log('# 2. Check if output/public directory exists');
console.log('ls -la output/public/');
console.log('');
console.log('# 3. Create ultra-minimal test index.php');
console.log('cat > test-minimal.php << "EOF"');
console.log('<?php');
console.log('echo "PHP is working!";');
console.log('?>');
console.log('EOF');
console.log('');
console.log('# 4. Test minimal PHP file');
console.log('curl -k https://worldtripagency.com/test-minimal.php');
console.log('');
console.log('# 5. Create working index.php with debug info');
console.log('cat > index.php << "EOF"');
console.log('<?php');
console.log('// Debug version of index.php');
console.log('error_reporting(E_ALL);');
console.log('ini_set("display_errors", 1);');
console.log('');
console.log('header("Content-Type: text/html; charset=utf-8");');
console.log('');
console.log('$uri = $_SERVER["REQUEST_URI"];');
console.log('$path = parse_url($uri, PHP_URL_PATH);');
console.log('');
console.log('// Debug: Show what we are processing');
console.log('echo "<!-- Debug: URI = " . $uri . " -->";');
console.log('echo "<!-- Debug: Path = " . $path . " -->";');
console.log('');
console.log('// API routes');
console.log('if (strpos($path, "/api/") === 0) {');
console.log('    if (file_exists("api-handler.php")) {');
console.log('        include "api-handler.php";');
console.log('        exit;');
console.log('    } else {');
console.log('        echo "<!-- Debug: api-handler.php not found -->";');
console.log('    }');
console.log('}');
console.log('');
console.log('// _nuxt assets');
console.log('if (strpos($path, "/_nuxt/") === 0) {');
console.log('    $file = __DIR__ . "/output/public" . $path;');
console.log('    echo "<!-- Debug: Looking for _nuxt file: " . $file . " -->";');
console.log('    if (file_exists($file)) {');
console.log('        $ext = pathinfo($file, PATHINFO_EXTENSION);');
console.log('        if ($ext === "css") header("Content-Type: text/css");');
console.log('        if ($ext === "js") header("Content-Type: application/javascript");');
console.log('        readfile($file);');
console.log('        exit;');
console.log('    } else {');
console.log('        echo "<!-- Debug: _nuxt file not found -->";');
console.log('        http_response_code(404);');
console.log('        echo "Asset not found: " . $path;');
console.log('        exit;');
console.log('    }');
console.log('}');
console.log('');
console.log('// Static files');
console.log('$ext = pathinfo($path, PATHINFO_EXTENSION);');
console.log('if (in_array($ext, ["css", "js", "jpg", "png", "gif", "svg", "ico"])) {');
console.log('    $file = __DIR__ . "/output/public" . $path;');
console.log('    echo "<!-- Debug: Looking for static file: " . $file . " -->";');
console.log('    if (file_exists($file)) {');
console.log('        if ($ext === "css") header("Content-Type: text/css");');
console.log('        if ($ext === "js") header("Content-Type: application/javascript");');
console.log('        readfile($file);');
console.log('        exit;');
console.log('    } else {');
console.log('        echo "<!-- Debug: Static file not found -->";');
console.log('        http_response_code(404);');
console.log('        echo "File not found: " . $path;');
console.log('        exit;');
console.log('    }');
console.log('}');
console.log('');
console.log('// Main page - try multiple locations');
console.log('$htmlFiles = [');
console.log('    __DIR__ . "/index.html",');
console.log('    __DIR__ . "/200.html",');
console.log('    __DIR__ . "/output/public/200.html",');
console.log('    __DIR__ . "/output/public/index.html"');
console.log('];');
console.log('');
console.log('foreach ($htmlFiles as $html) {');
console.log('    echo "<!-- Debug: Checking for HTML file: " . $html . " -->";');
console.log('    if (file_exists($html)) {');
console.log('        echo "<!-- Debug: Found HTML file: " . $html . " -->";');
console.log('        $content = file_get_contents($html);');
console.log('        $content = str_replace("src=\\"/", "src=\\"", $content);');
console.log('        $content = str_replace("href=\\"/", "href=\\"", $content);');
console.log('        echo $content;');
console.log('        exit;');
console.log('    }');
console.log('}');
console.log('');
console.log('// Fallback with debug info');
console.log('echo "<!DOCTYPE html>";');
console.log('echo "<html><head><title>World Trip Agency - Debug</title></head>";');
console.log('echo "<body>";');
console.log('echo "<h1>World Trip Agency</h1>";');
console.log('echo "<p>Debug Mode - No HTML files found</p>";');
console.log('echo "<p>URI: " . $uri . "</p>";');
console.log('echo "<p>Path: " . $path . "</p>";');
console.log('echo "<p>Current Directory: " . __DIR__ . "</p>";');
console.log('echo "<p>Files in directory:</p>";');
console.log('echo "<ul>";');
console.log('$files = scandir(__DIR__);');
console.log('foreach ($files as $file) {');
console.log('    if ($file !== "." && $file !== "..") {');
console.log('        echo "<li>" . $file . "</li>";');
console.log('    }');
console.log('}');
console.log('echo "</ul>";');
console.log('echo "</body></html>";');
console.log('?>');
console.log('EOF');
console.log('');
console.log('# 6. Test the debug version');
console.log('curl -k https://worldtripagency.com/');
console.log('');
console.log('🎯 This debug version will show:');
console.log('✅ What URI and path are being processed');
console.log('✅ Which files are being looked for');
console.log('✅ What files actually exist in the directory');
console.log('✅ Where the 500 error is coming from');
