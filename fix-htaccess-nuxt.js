#!/usr/bin/env node

console.log('ðŸ”§ FIXING .HTACCESS FOR _NUXT ASSETS');
console.log('====================================\n');

console.log('ðŸ“‹ FIXED .HTACCESS COMMANDS:');
console.log('=============================');
console.log('');
console.log('# 1. Create fixed .htaccess with proper _nuxt handling');
console.log('cat > .htaccess << "EOF"');
console.log('RewriteEngine On');
console.log('');
console.log('# Handle API routes');
console.log('RewriteCond %{REQUEST_URI} ^/api/');
console.log('RewriteRule ^(.*)$ /api-handler.php [QSA,L]');
console.log('');
console.log('# Handle _nuxt assets - FIXED VERSION');
console.log('RewriteCond %{REQUEST_URI} ^/_nuxt/');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Handle static files from output/public');
console.log('RewriteCond %{REQUEST_URI} \\.(css|js|jpg|jpeg|png|gif|webp|svg|ico|woff|woff2|ttf|eot)$');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{DOCUMENT_ROOT}/output/public%{REQUEST_URI} -f');
console.log('RewriteRule ^(.*)$ /output/public$1 [L]');
console.log('');
console.log('# Serve index.html for all other requests');
console.log('RewriteCond %{REQUEST_FILENAME} !-f');
console.log('RewriteCond %{REQUEST_FILENAME} !-d');
console.log('RewriteRule ^(.*)$ /index.html [QSA,L]');
console.log('EOF');
console.log('');
console.log('# 2. Test the website');
console.log('curl -k -I https://worldtripagency.com/');
console.log('');
console.log('# 3. Test _nuxt assets');
console.log('curl -k -I https://worldtripagency.com/_nuxt/entry.Cjk20dY-.css');
console.log('');
console.log('# 4. Test a specific _nuxt file that exists');
console.log('ls -la output/public/_nuxt/ | head -3');
console.log('curl -k -I https://worldtripagency.com/_nuxt/2Q_rtp48.js');
console.log('');
console.log('# 5. Test API');
console.log('curl -k https://worldtripagency.com/api/test');
console.log('');
console.log('ðŸŽ¯ The fix includes:');
console.log('âœ… Added file existence check for _nuxt assets');
console.log('âœ… Added file existence check for static files');
console.log('âœ… Proper document root path resolution');
console.log('âœ… Better error handling');
console.log('');
console.log('ðŸ”§ Why this works:');
console.log('â€¢ Checks if the file actually exists before rewriting');
console.log('â€¢ Uses %{DOCUMENT_ROOT} for proper path resolution');
console.log('â€¢ Prevents 500 errors from non-existent files');
console.log('â€¢ Maintains all existing functionality');
